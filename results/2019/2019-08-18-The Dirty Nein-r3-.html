<!DOCTYPE html>
<html>
<!--
Html Template for Race Animation.
Generated from CrossMgr software.
Copyright 2011-2015, Edward Sitarski
For details, see sites.google.com/site/CrossMgrSoftware
-->
<head>
<meta charset="UTF-8">
<meta name="author" content="Edward Sitarski">
<meta name="copyright" content="Edward Sitarski">
<meta name="generator" content="CrossMgr">  
<meta name="keywords" content="CrossMgr, Cycling, Race, Results">
<!-- Meta -->
<title id="idTitle">The Dirty Nein - Starting 11:00:00 08/18/19</title>	<!-- Don't change this text! -->
<style type="text/css">
body { font-family: sans-serif; }
#idRaceName {
font-size: 200%;
font-weight: bold;
}
#idImgHeader {
box-shadow: 4px 4px 4px #888888;
}
#detailTitle {
font-size: 110%;
font-weight: bold;
}
input[type=range]::-ms-tooltip {
display: none;
}
.smallfont	{ font-size: 75%; }
.bigfont	{ font-size: 120%; }
.biggerFont	{ font-size: 130%; }
.hidden { display: none; }
div label input {
margin-right:220px;
}
#buttongroup {
margin:4px;   
float:left;
}
#buttongroup label {
float:left;
margin:4px;
background-color:#EFEFEF;
border-radius:4px;
border:1px solid #D0D0D0;
overflow:auto;
cursor: pointer;
}
#buttongroup label span {
text-align:center;
padding:8px 8px;
display:block;
}
#buttongroup label input {
position:absolute;
top:-20px;
}
#buttongroup input:checked + span {
background-color:#404040;
color:#F7F7F7;
}
#buttongroup .green {
background-color:#7FE57F;
color:#333;
}
table.results {
font-family:"Trebuchet MS", Arial, Helvetica, sans-serif;
border-collapse:collapse;
}
table.results td, table.results th {
font-size:1em;
padding:3px 7px 2px 7px;
text-align: right;
}
table.results th {
font-size:1.1em;
text-align:right;
padding-top:5px;
padding-bottom:4px;
background-color:#7FE57F;
color:#000000;
}
table.results tr.odd {
color:#000000;
background-color:#EAF2D3;
}
table.results tr:hover {
color:#000000;
background-color:#FFFFCC;
}
table.results tr.odd:hover {
color:#000000;
background-color:#FFFFCC;
}
table.results tr td.fastest {
background-image: linear-gradient(
/* #FF6620, #FFAA20 25%, #FF6620 */
#00EE00, #00FF00 25%, #00EE00
);
}
table.results tr td.fastest-lap {
background-image: linear-gradient(
/* #FF6A7F, #FF9EAF 25%, #FF6A7F */
#FF8840, #FFCC40 25%, #FF8840
);
}
table.results tr td.slowest-lap {
background-image: linear-gradient(
#4496F7, #9CC7FB 25%, #4496F7
);
}
table.results tr td.highlight {
font-size: 120%;
font-weight: bold;
}
table.results td {
border-top:1px solid #98BF21;
}
table.results td.noborder {
border-top:0px solid #98BF21;
}
table.results td#idNonNumeric, table.results th#idNonNumeric {
text-align:left;
}
table.results tr td.same-value {
text-align:center;
}
.flag {
border: 1px solid #CCC;
}
hr { clear: both; }
hr.invisible { clear: both; visibility: hidden; }
@media print { .noprint { display: none; } }
</style>
<!-- Google Analytics -->
<script type="text/javascript">
/* !!! payload begin !!! */
var payload = {"raceStartTime":39602.0,"courseCoordinates":[-80.49182,43.4826,-80.49193,43.48271,-80.49199,43.48278,-80.49204,43.48281,-80.49209,43.48279,-80.49221,43.48274,-80.49229,43.4827,-80.49233,43.48268,-80.49236,43.48264,-80.49251,43.48257,-80.49269,43.48258,-80.49282,43.48262,-80.49298,43.48262,-80.49303,43.48262,-80.49321,43.4826,-80.49334,43.48263,-80.49344,43.48269,-80.4935,43.48277,-80.49353,43.4828,-80.4936,43.48285,-80.49364,43.48286,-80.49383,43.48293,-80.49389,43.48295,-80.49395,43.48298,-80.49402,43.483,-80.49415,43.48302,-80.49422,43.48302,-80.49428,43.48303,-80.49434,43.48303,-80.49443,43.48306,-80.49446,43.48307,-80.49448,43.48308,-80.49454,43.48311,-80.49457,43.48312,-80.49459,43.48316,-80.4946,43.48318,-80.49464,43.48321,-80.49467,43.48328,-80.49466,43.48329,-80.49468,43.48334,-80.49469,43.48338,-80.4947,43.4834,-80.49475,43.48356,-80.49475,43.48358,-80.49475,43.4837,-80.49476,43.48377,-80.4948,43.48385,-80.49482,43.48388,-80.49493,43.48398,-80.49504,43.4841,-80.49517,43.48424,-80.49526,43.48438,-80.49536,43.48447,-80.49543,43.48452,-80.49553,43.48459,-80.49576,43.48476,-80.4959,43.48485,-80.49603,43.48496,-80.49607,43.485,-80.49613,43.4851,-80.49613,43.48513,-80.49614,43.48518,-80.49616,43.48519,-80.49618,43.48521,-80.49623,43.48525,-80.49629,43.48528,-80.49642,43.48539,-80.49655,43.48548,-80.49664,43.48545,-80.49677,43.48538,-80.49683,43.48535,-80.49688,43.48533,-80.49692,43.48532,-80.49695,43.4853,-80.497,43.48527,-80.49706,43.48524,-80.49713,43.4852,-80.4972,43.48516,-80.49728,43.48512,-80.49735,43.48508,-80.49742,43.48504,-80.4975,43.485,-80.49756,43.48496,-80.49766,43.48488,-80.49781,43.48473,-80.49775,43.4846,-80.49772,43.48455,-80.49768,43.48451,-80.49755,43.48442,-80.49731,43.4843,-80.49709,43.4842,-80.49697,43.48407,-80.49692,43.48397,-80.49689,43.48389,-80.49688,43.48384,-80.49686,43.48365,-80.49684,43.48344,-80.49681,43.4834,-80.4967,43.48326,-80.49652,43.48313,-80.49638,43.48301,-80.49627,43.48286,-80.49607,43.48275,-80.4959,43.48268,-80.49582,43.4826,-80.49571,43.48246,-80.49563,43.48233,-80.49558,43.48229,-80.4954,43.48211,-80.4953,43.48201,-80.4952,43.48191,-80.4951,43.48186,-80.49508,43.48186,-80.49504,43.48181,-80.49499,43.48172,-80.49494,43.48168,-80.49485,43.48164,-80.49482,43.48161,-80.4947,43.48152,-80.49457,43.48142,-80.49447,43.48131,-80.49446,43.4813,-80.49438,43.48125,-80.49428,43.48118,-80.49419,43.48114,-80.49417,43.48113,-80.49404,43.48105,-80.494,43.48104,-80.4938,43.48098,-80.49367,43.48095,-80.49348,43.48094,-80.49339,43.48097,-80.49335,43.48098,-80.49332,43.48098,-80.49314,43.48099,-80.49313,43.48099,-80.49299,43.48098,-80.49296,43.481,-80.49294,43.48101,-80.49291,43.48102,-80.4929,43.48101,-80.49288,43.48102,-80.49287,43.48105,-80.49289,43.48106,-80.49289,43.48107,-80.49302,43.4812,-80.49314,43.48134,-80.49322,43.48147,-80.49329,43.4816,-80.49339,43.48172,-80.49352,43.48184,-80.49365,43.48196,-80.49369,43.48199,-80.49383,43.48215,-80.49391,43.48226,-80.49402,43.4824,-80.49412,43.48257,-80.49416,43.48269,-80.49415,43.48272,-80.49416,43.48274,-80.49417,43.48288,-80.49415,43.48293,-80.49411,43.48295,-80.4941,43.48296,-80.49403,43.48297,-80.49401,43.48298,-80.49396,43.48297,-80.4939,43.48295,-80.49383,43.48289,-80.49381,43.48286,-80.4937,43.48276,-80.49367,43.48274,-80.49353,43.48273,-80.49338,43.48275,-80.49322,43.48273,-80.49318,43.48273,-80.49304,43.48269,-80.49286,43.48265,-80.49272,43.48255,-80.49269,43.48252,-80.49256,43.48242,-80.49254,43.48239,-80.49245,43.48227,-80.49229,43.48214,-80.49224,43.48211,-80.49215,43.48205,-80.4921,43.48201,-80.49206,43.482,-80.49202,43.48198,-80.49198,43.48195,-80.49187,43.48183,-80.49182,43.48179,-80.49171,43.48165,-80.4917,43.48161,-80.49162,43.48156,-80.49156,43.48156,-80.49152,43.48156,-80.49146,43.48155,-80.49133,43.48156,-80.49113,43.48157,-80.49107,43.48157,-80.49087,43.4816,-80.49084,43.48162,-80.49081,43.48168,-80.49081,43.48169,-80.49086,43.48172,-80.4909,43.48177,-80.49091,43.48178,-80.49093,43.48179,-80.49102,43.48189,-80.49115,43.48201,-80.49129,43.48213,-80.49137,43.4822,-80.49145,43.48227,-80.49159,43.48239,-80.49162,43.48242,-80.49174,43.48253],"courseViewerTemplate":"{-{!DOCTYPE html}-}\n{-{html}-}\n{-{!--\nHtml Template for Course Viewer.\nGenerated from CrossMgr software.\nCopyright Edward Sitarski\nFor details, see sites.google.com/site/CrossMgrSoftware\n--}-}\n{-{head}-}\n{-{meta charset=\"UTF-8\"}-}\n{-{meta name=\"author\" content=\"Edward Sitarski\"}-}\n{-{meta name=\"copyright\" content=\"Edward Sitarski\"}-}\n{-{meta name=\"generator\" content=\"CrossMgr\"}-}  \n{-{meta name=\"keywords\" content=\"CrossMgr, Cycling, Race, Results\"}-}\n{-{title id=\"idTitle\"}-}TTIITTLLEE{-{/title}-}\t{-{!-- Don't change this text! --}-}\n{-{style type=\"text/css\"}-}\nbody { font-family: sans-serif; }\ntable {\nfont-family:\"Trebuchet MS\", Arial, Helvetica, sans-serif;\n}\ntable.CourseStats {\nborder-collapse:collapse;\noverflow:hidden;\nwidth: 800px;\nborder:1px solid #d3d3d3;\nbackground-color:#fefefe;\nborder-radius:8px;\n}\ntable.CourseStats * th, table.CourseStats * td {padding:10px 26px 10px; text-align:center; }\ntable.CourseStats * th {padding-top:12px; text-shadow: 1px 1px 1px #fff; background-color:#e8eaeb;}\ntable.CourseStats * td {border-top:1px solid #e0e0e0; border-right:1px solid #e0e0e0;}\n#idRaceName {\nfont-size: 200%;\nfont-weight: bold;\n}\n#idImgHeader {\nbox-shadow: 4px 4px 4px #888888;\n}\n.smallfont\t{ font-size: 75%; }\n.bigfont\t{ font-size: 120%; }\n.biggerFont\t{ font-size: 130%; }\n.hidden { display: none; }\n@media print { .noprint { display: none; } }\n{-{/style}-}\n{-{script src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyD2sl2JTvnyMcsgWc3tTceWCYo3ZoyWdAI&v=3.exp&sensor=false\"}-}{-{/script}-}\n{-{script}-}\nvar payload = null;\nvar raceName = null;\nvar organizer = null;\nvar email = null;\nvar raceNameText = null;\nvar raceDate = null;\nvar displayUnits = null;\nvar gpsTotalElevationGain = null;\t\nvar gpsAltigraph = null;\t\t\nvar gpsIsPointToPoint = null;\t\nvar courseCoordinates = null;\t\nvar lengthKm = null;\nvar courseObj = null;\nvar map = null;\nvar mapCanvas = null;\nfunction isCanvasSupported() {\nvar elem = document.createElement('canvas');\nreturn !!(elem.getContext && elem.getContext('2d'));\n}\nArray.prototype.back = function() {\nreturn this[this.length-1];\n};\nArray.prototype.binSearch = function( v )\n{\nvar L = this.length, i = -1, m;\nwhile( L - i }-} 1 )\n{\nif( this[m = ((L + i)}-}}-}1)] {-{ v )\ni = m;\nelse\nL = m;\n}\nreturn L;\n}\nString.prototype.escapeHTML = function ()\n{                                        \nvar r =                                                               \nthis.replace(/&/g,'&amp;').\nreplace(/}-}/g,'&gt;').\nreplace(/{-{/g,'&lt;').\nreplace(/\"/g,'&quot;').\nreplace(/'/g,'&rsquo;');\nreturn r;\n};\nString.prototype.escapeID = function() {\nreturn this.replace(/[&{-{}-}\"'(){}\\[\\]!@#$%^* ]/g,'_');\n};\nfunction MapLabel(opt_options) {\nthis.set('fontFamily', 'sans-serif');\nthis.set('fontSize', 12);\nthis.set('fontColor', '#000000');\nthis.set('strokeWeight', 2);\nthis.set('strokeColor', '#ffffff');\nthis.set('align', 'center');\nthis.set('zIndex', 1e3);\nthis.setValues(opt_options);\n}\nMapLabel.prototype = new google.maps.OverlayView;\nwindow['MapLabel'] = MapLabel;\n/** @inheritDoc */\nMapLabel.prototype.changed = function(prop) {\nswitch (prop) {\ncase 'fontFamily':\ncase 'fontSize':\ncase 'fontColor':\ncase 'strokeWeight':\ncase 'strokeColor':\ncase 'align':\ncase 'text':\nreturn this.drawCanvas_();\ncase 'maxZoom':\ncase 'minZoom':\ncase 'position':\nreturn this.draw();\n}\n};\nMapLabel.prototype.drawCanvas_ = function() {\nvar canvas = this.canvas_;\nif (!canvas) return;\nvar style = canvas.style;\nstyle.zIndex = (this.get('zIndex'));\nvar ctx = canvas.getContext('2d');\nctx.clearRect(0, 0, canvas.width, canvas.height);\nctx.strokeStyle = this.get('strokeColor');\nctx.fillStyle = this.get('fontColor');\nctx.font = this.get('fontSize') + 'px ' + this.get('fontFamily');\nvar strokeWeight = Number(this.get('strokeWeight'));\nvar text = this.get('text');\nif (text) {\nif (strokeWeight) {\nctx.lineWidth = strokeWeight;\nctx.strokeText(text, strokeWeight, strokeWeight);\n}\nctx.fillText(text, strokeWeight, strokeWeight);\nvar textMeasure = ctx.measureText(text);\nvar textWidth = textMeasure.width + strokeWeight;\nstyle.marginLeft = this.getMarginLeft_(textWidth) + 'px';\nstyle.marginTop = '-0.4em';\n}\n};\nMapLabel.prototype.onAdd = function() {\nvar canvas = this.canvas_ = document.createElement('canvas');\nvar style = canvas.style;\nstyle.position = 'absolute';\nvar ctx = canvas.getContext('2d');\nctx.lineJoin = 'round';\nctx.textBaseline = 'top';\nthis.drawCanvas_();\nvar panes = this.getPanes();\nif (panes) {\npanes.mapPane.appendChild(canvas);\n}\n};\nMapLabel.prototype['onAdd'] = MapLabel.prototype.onAdd;\nMapLabel.prototype.getMarginLeft_ = function(textWidth) {\nswitch (this.get('align')) {\ncase 'left':\nreturn 0;\ncase 'right':\nreturn -textWidth;\n}\nreturn textWidth / -2;\n};\nMapLabel.prototype.draw = function() {\nvar projection = this.getProjection();\nif (!projection) {\nreturn;\n}\nvar latLng = (this.get('position'));\nif (!latLng) {\nreturn;\n}\nvar pos = projection.fromLatLngToDivPixel(latLng);\nvar style = this.canvas_.style;\nstyle['top'] = pos.y + 'px';\nstyle['left'] = pos.x + 'px';\nstyle['visibility'] = this.getVisible_();\n};\nMapLabel.prototype['draw'] = MapLabel.prototype.draw;\nMapLabel.prototype.getVisible_ = function() {\nvar minZoom = (this.get('minZoom'));\nvar maxZoom = (this.get('maxZoom'));\nif (minZoom === undefined && maxZoom === undefined) {\nreturn '';\n}\nvar map = this.getMap();\nif (!map) {\nreturn '';\n}\nvar mapZoom = map.getZoom();\nif (mapZoom {-{ minZoom || mapZoom }-} maxZoom) {\nreturn 'hidden';\n}\nreturn '';\n};\nMapLabel.prototype.onRemove = function() {\nvar canvas = this.canvas_;\nif (canvas && canvas.parentNode) {\ncanvas.parentNode.removeChild(canvas);\n}\n};\nMapLabel.prototype['onRemove'] = MapLabel.prototype.onRemove;\nfunction isEmptyObject( obj ) {\nfor ( var name in obj ) {\nreturn false;\n}\nreturn true;\n}\nvar degreesToRadians = Math.PI / 180.0;\nvar radiansToDegrees = 180.0 / Math.PI;\nfunction GreatCircleDistance( lat1, lon1, lat2, lon2 )\n{\nlon1 *= degreesToRadians;\nlat1 *= degreesToRadians;\nlon2 *= degreesToRadians;\nlat2 *= degreesToRadians;\nvar dlon = lon2 - lon1;\nvar dlat = lat2 - lat1;\nvar a = Math.pow(Math.sin(dlat/2),2) + Math.cos(lat1) * Math.cos(lat2) * Math.pow(Math.sin(dlon/2),2);\nvar c = 2.0 * Math.asin(Math.sqrt(Math.max(a, 0.0)));\nvar m = 6371000.0 * c;\nreturn m;\n}\nfunction CompassBearing( lat1, lon1, lat2, lon2 )\n{\nlat1 *= degreesToRadians;\nlat2 *= degreesToRadians;\nvar diffLong = (lon2 - lon1) * degreesToRadians;\nvar x = Math.sin(diffLong) * Math.cos(lat2);\nvar y = Math.cos(lat1) * Math.sin(lat2) - (Math.sin(lat1) * Math.cos(lat2) * Math.cos(diffLong));\nvar bearing = Math.atan2(x, y) * radiansToDegrees;\nwhile( bearing {-{ 0.0 )\nbearing += 360.0;\nreturn bearing;\n}\nfunction DestinationPoint( lat, lon, bearing, dist )\n{\ndist /= 6371000.0;  \nbearing = bearing * degreesToRadians;\t\t\nvar lat1 = lat * degreesToRadians, lon1 = lon * degreesToRadians;\nvar lat2 = Math.asin( Math.sin(lat1)*Math.cos(dist) + Math.cos(lat1)*Math.sin(dist)*Math.cos(bearing) );\nvar lon2 = lon1 + Math.atan2(Math.sin(bearing)*Math.sin(dist)*Math.cos(lat1), Math.cos(dist)-Math.sin(lat1)*Math.sin(lat2));\nlon2 += 3.0 * Math.PI;\nlon2 -= 2.0 * Math.PI * Math.floor( lon2 / (2.0 * Math.PI) );\nlon2 -= Math.PI;\nreturn [lat2 * radiansToDegrees, lon2 * radiansToDegrees];\n}\nfunction DestinationPointToPoint( lat1, lon1, lat2, lon2, dist )\n{\nreturn DestinationPoint( lat1, lon1, CompassBearing(lat1, lon2, lat2, lon2), dist );\n}\nfunction LineNormal( x1, y1, x2, y2, normLen )\n{\nvar dx = x2 - x1, dy = y2 - y1;\nvar scale = (normLen / 2.0) / Math.sqrt( dx*dx + dy*dy );\ndx *= scale;\ndy *= scale;\nreturn [x1 + dy, y1 - dx, x1 - dy, y1 + dx];\n}\nfunction colorBetween( r1, g1, b1, r2, g2, b2, x )\n{\nvar r = (r1 + (r2 - r1) * x).toFixed(0);\nvar g = (g1 + (g2 - g1) * x).toFixed(0);\nvar b = (b1 + (b2 - b1) * x).toFixed(0);\nreturn 'rgb(' + r + ',' + g + ',' + b + ')';\n}\nfunction getBestInterval( d, intervals )\n{\nvar k = intervals.binSearch( d );\nif( k }-}= intervals.length )\nk = intervals.length - 1;\nreturn intervals[k];\n}\nfunction findPos(obj) {\nvar curleft = curtop = 0;\nif (obj.offsetParent) {\ncurleft = obj.offsetLeft\ncurtop = obj.offsetTop\nwhile (obj = obj.offsetParent) {\ncurleft += obj.offsetLeft\ncurtop += obj.offsetTop\n}\n}\nreturn [curleft,curtop];\n}\nfunction Altigraph()\n{\nthis.altigraph = [];\nthis.yMax = -1000000.0;\nthis.yMin = 1000000.0\nthis.xMax = 0.0;\nthis.xTick = null;\nthis.yTick = null;\nthis.xEvent = -1;\nthis.yEvent = -1;\nthis.hoverTimer = null;\nthis.points = [];\nthis.yBaseline = 0;\nthis.marker = null;\nvar that = this;\nthis.valid = function() {\nreturn !(this.altigraph.length == 0 || this.xMax == 0 || !gpsTotalElevationGain);\n}\nthis.processMouse = function( event ) {\nif( !this.valid() )\nreturn;\nvar canvasAltigraph = document.getElementById('idAltigraph');\nvar pos = findPos( canvasAltigraph );\nthis.xEvent = event.pageX - canvasAltigraph.offsetLeft;\nthis.yEvent = event.pageY - canvasAltigraph.offsetTop;\nif( this.hoverTimer != null )\nclearTimeout( this.hoverTimer );\nthis.hoverTimer = setTimeout( function() {that.updateInfo();}, 10 );\n}\nthis.updateInfo = function() {\nif( !this.valid() )\nreturn;\nvar canvasAltigraph = document.getElementById('idAltigraph');\nvar dc = canvasAltigraph.getContext('2d');\nthis.draw( dc, 0, 0, canvasAltigraph.width, canvasAltigraph.height );\nthis.xEvent = Math.max( this.points[0][0], this.xEvent );\nthis.xEvent = Math.min( this.points.back()[0] - 1, this.xEvent );\nfor( var i = 0; i {-{ this.points.length - 1; ++i ) {\nif( this.points[i][0] {-{= this.xEvent && this.xEvent {-{ this.points[i+1][0] ) {\nvar x1 = this.points[i][0], y1 = this.points[i][1];\nvar x2 = this.points[i+1][0], y2 = this.points[i+1][1];\nvar x = x1, y = y1, r = 0;\nif( x1 != x2 ) {\nr = (this.xEvent - x1) / (x2 - x1);\nx += (x2 - x1) * r;\ny += (y2 - y1) * r;\n}\ndc.save();\ndc.strokeStyle = 'rgb(183,0,255)';\ndc.lineWidth = 8;\ndc.beginPath();\ndc.moveTo( x, 0 );\ndc.lineTo( x, this.yBaseline );\ndc.stroke();\nvar fontSize = canvasAltigraph.height / 7;\ndc.font = fontSize + 'px Arial';\ndc.textBaseline = 'top';\nvar xText = x + dc.lineWidth + 2, yText = 0;\nvar altitude = this.altigraph[i][1];\naltitude += (this.altigraph[(i+1)%this.altigraph.length][1] - altitude) * r;\nvar units, unitName;\nif( displayUnits == 'km' ) {\nunits = 1.0;\nunitName = 'm';\n}\nelse {\nunits = 3.28084;\nunitName = 'ft';\n}\nvar text = ((altitude - this.yMin)*units).toFixed(1) + ' ' + unitName + ' (' + (altitude*units).toFixed(1) + ')';\nvar textWidth = dc.measureText(text).width;\nif( xText + textWidth }-} canvasAltigraph.width )\nxText = canvasAltigraph.width - textWidth;\ndc.fillStyle = 'rgba(255,255,255,0.75)';\ndc.fillRect( xText, yText -2, dc.measureText(text).width, fontSize + 2 );\ndc.fillStyle = '#000';\ndc.fillText( text, xText, yText );\nyText += fontSize;\nvar courseCur = this.altigraph[i][0] + r * (this.altigraph[i+1][0] - this.altigraph[i][0]);\ncourseCur *= (displayUnits == 'km' ? 1.0 : 0.621371) / 1000.0;\ndc.fillText( courseCur.toFixed(2) + ' ' + displayUnits, xText, yText );\ndc.restore();\nif( !this.marker )\nthis.marker = new google.maps.Marker({\nmap: mapCanvas,\ndraggable: false,\nicon: 'data:image/png;base64,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'\n});\nvar lat1 = courseCoordinates[i*2+1], lng1 = courseCoordinates[i*2];\nvar lat2, lng2;\nif( gpsIsPointToPoint ) {\nlat2 = courseCoordinates[i*2+3];\nlng2 = courseCoordinates[i*2+2];\n}\nelse {\nlat2 = courseCoordinates[(i*2+3)%courseCoordinates.length];\nlng2 = courseCoordinates[(i*2+2)%courseCoordinates.length];\n}\nthis.marker.setPosition( new google.maps.LatLng(lat1 + (lat2 - lat1) * r, lng1 + (lng2 - lng1) * r) );\nbreak;\n}\n}\n}\nthis.setData = function( altigraph, drawTEG )\n{\nif( !altigraph || altigraph.length == 0 )\naltigraph = [];\nthis.drawTEG = drawTEG;\nthis.altigraph = altigraph;\nthis.yMax = -1000000.0;\nthis.yMin = 1000000.0\nthis.xMax = 0.0;\nfor( var i = 0; i {-{ altigraph.length; ++i )\n{\nif( altigraph[i][1] }-} this.yMax )\nthis.yMax = altigraph[i][1];\nif( altigraph[i][1] {-{ this.yMin )\nthis.yMin = altigraph[i][1];\n}\nif( altigraph.length }-} 0 )\nthis.xMax = altigraph[altigraph.length-1][0];\nif( this.yMin == this.yMax )\n{\nthis.altigraph = []\ngpsAltigraph = null;\ngpsTotalElevationGain = null;\n}\n}\nthis.empty = function() { return this.altigraph.length == 0; }\nthis.draw = function( dc, x, y, width, height )\n{\nif( this.altigraph.length == 0 || this.xMax == 0 || !gpsTotalElevationGain )\nreturn;\ndc.save();\ndc.fillStyle = '#FFF';\ndc.fillRect( 0, 0, width, height );\ny += 2;\t\t\nheight -= 2;\nvar verticalDisplayUnits = (displayUnits == 'km' ? ' m' : ' ft');\nvar fontSize = (height*0.95)/4.0;\nvar fontSizeLegend = (height*0.95) / 10;\ndc.font = fontSizeLegend + 'px Arial';\nvar minLabel = '0';\nvar maxLabel = ((this.yMax - this.yMin) * (displayUnits == 'km' ? 1.0 : 2)).toFixed(0) + '  ' + verticalDisplayUnits;\nvar labelWidth = Math.max( dc.measureText(minLabel).width, dc.measureText(maxLabel).width );\nmaxLabel = verticalDisplayUnits;\nminLabel = '';\ndc.font = fontSize + 'px Arial';\nvar altigraph = this.altigraph;\nvar tegLabel = '';\nvar tegWidth = 0;\nvar tegText = ['Total', 'Elevation', 'Gain'];\nif( this.drawTEG && gpsTotalElevationGain )\n{\ntegLabel = (gpsTotalElevationGain * (displayUnits == 'km' ? 1.0 : 3.28084)).toFixed(0) + (displayUnits == 'km' ? ' m' : ' ft');\ntegWidth = dc.measureText(tegLabel).width;\nfor( var i = 0; i {-{ tegText.length; ++i )\ntegWidth = Math.max( tegWidth, dc.measureText(tegText[i]).width );\n}\nvar border = 4;\nif( labelWidth + border*2 + tegWidth }-} width )\n{\ndc.restore();\nreturn;\n}\ndc.font = fontSizeLegend + 'px Arial';\nvar textWidth = dc.measureText('00.00').width;\nvar xLeft = labelWidth + border, xRight = width - border - tegWidth;\nvar numLabels = Math.floor((xRight - xLeft) / (textWidth * 1.5));\nvar courseLength = this.xMax/1000.0 * (displayUnits == 'km' ? 1.0 : 0.621371);\nvar d = courseLength / numLabels;\nthis.xTick = d = getBestInterval(d, [0.1,0.25,0.5,1.0,2.0,5.0,10.0,15.0,20.0,25.0,50.0,100.0,250.0,500.0,1000.0] );\nvar precision = 0;\nif( d {-{ 1 )\nif( d == 0.25 )\nprecision = 2;\nelse\nprecision = 1;\ndc.textBaseline = 'bottom';\ndc.fillStyle = '#000000';\nfor( var i = 1; i * d {-{ courseLength; ++i )\n{\nvar xCur = i * d;\nvar text = xCur.toFixed(precision);\nvar textWidth = dc.measureText(text).width;\nvar xPos = (xCur / courseLength) * (xRight - xLeft) + xLeft - textWidth / 2;\nif( xPos + textWidth / 2 {-{ xRight )\ndc.fillText( text, xPos, height );\n}\ndc.fillText( displayUnits, xLeft - dc.measureText(displayUnits).width * 0.75, height );\nvar horizontalLabelHeight = fontSizeLegend * 1.2;\nheight -= horizontalLabelHeight;\ndc.strokeStyle = '#000000';\nfor( var i = 0; i * d {-{ courseLength; ++i )\n{\nvar xCur = i * d;\nvar xPos = (xCur / courseLength) * (xRight - xLeft) + xLeft;\ndc.beginPath();\ndc.moveTo( xPos, height );\ndc.lineTo( xPos, height + fontSizeLegend * 0.4 );\ndc.stroke();\n}\nvar numLabels = Math.floor(height / (fontSizeLegend * 1.5));\nvar yDelta = (this.yMax - this.yMin) * (displayUnits == 'km' ? 1.0 : 3.28084);\nvar d = yDelta / numLabels;\nthis.yTick = d = getBestInterval(d, [1, 2, 5, 10, 15, 20, 25, 50, 100, 200, 250, 500, 1000, 2000, 2500, 5000, 10000]);\ndc.textBaseline = 'middle';\ndc.strokeStyle = '#c0c0c0';\ndc.fillStyle = '#000000';\ndc.lineWidth = 1;\nvar yPos = height;\nvar yInc = (d / yDelta) * height;\nfor( var i = 1; i * d {-{ yDelta; ++i )\n{\nyPos -= yInc;\nvar text = (d * i).toFixed(0) + ' ';\nvar textWidth = dc.measureText(text).width;\ndc.fillText( text, xLeft - textWidth, yPos );\ndc.beginPath();\ndc.moveTo( xLeft, yPos );\ndc.lineTo( xRight, yPos );\ndc.stroke();\n}\ndc.font = fontSize + 'px Arial';\nvar xMult = (width - labelWidth - border*2 - tegWidth) / this.xMax;\nvar yMult = height / (this.yMax - this.yMin);\nvar points = [];\nfor( var i = 0; i {-{ this.altigraph.length; ++i )\npoints.push( [(x + labelWidth + border + altigraph[i][0] * xMult), (y + height - (altigraph[i][1] - this.yMin) * yMult)] );\nthis.points = points;\nfor( var i = 1; i {-{ this.altigraph.length; ++i )\n{\nvar grade = (altigraph[i][1] - altigraph[i-1][1]) / (altigraph[i][0] - altigraph[i-1][0]);\nif( grade }-} 0 )\ndc.fillStyle = colorBetween( 255,255,255, 255,0,0, Math.min(1.0,  grade / 0.12) );\nelse\ndc.fillStyle = colorBetween( 255,255,255,   0,0,0, Math.min(1.0, -grade / 0.12) );\ndc.beginPath();\ndc.moveTo( points[i-1][0], points[i-1][1] );\ndc.lineTo( points[i  ][0], points[i  ][1] );\ndc.lineTo( points[i  ][0], y + height );\ndc.lineTo( points[i-1][0], y + height );\ndc.closePath();\ndc.fill();\n}\ndc.strokeStyle = '#000000';\ndc.lineWidth = 2;\ndc.beginPath();\ndc.moveTo( points[0][0], points[0][1] );\nfor( var i = 1; i {-{ this.altigraph.length; ++i )\ndc.lineTo( points[i][0], points[i][1] );\ndc.stroke();\nthis.yBaseline = y + height;\ndc.lineWidth = 1;\ndc.beginPath();\ndc.moveTo( x + labelWidth + border, this.yBaseline );\ndc.lineTo( x + width - border - tegWidth, this.yBaseline );\ndc.stroke();\ndc.lineWidth = 1;\ndc.beginPath();\ndc.moveTo( x + labelWidth + border, y );\ndc.lineTo( x + labelWidth + border, y + height );\ndc.stroke();\ndc.beginPath();\ndc.moveTo( x + width - tegWidth - border, y );\ndc.lineTo( x + width - tegWidth - border, y + height );\ndc.stroke();\ndc.font = fontSizeLegend + 'px Arial';\ndc.fillStyle = '#000000';\ndc.textAlign = 'left';\ndc.textBaseline = 'middle';\ndc.fillText( maxLabel, x, y + height / 2 );\nif( this.drawTEG && gpsTotalElevationGain )\n{\ndc.font = fontSize + 'px Arial';\nheight += horizontalLabelHeight;\ndc.textBaseline = 'top';\ndc.textAlign = 'left';\nvar xCur = x + width - tegWidth;\nvar yCur = y + (height - fontSize * 1.05 * 4) / 2;\ndc.fillText( tegLabel, xCur, yCur );\nfor( var i = 0; i {-{ tegText.length; ++i )\n{\nyCur += fontSize * 1.05;\ndc.fillText( tegText[i], xCur, yCur );\n}\n}\ndc.restore();\n}\nthis.Refresh = function() {\nvar canvasAltigraph = document.getElementById('idAltigraph');\nvar dc = canvasAltigraph.getContext('2d');\nthat.draw( dc, 0, 0, canvasAltigraph.width, canvasAltigraph.height );\n}\nthis.initEvents = function() {\nvar canvasAltigraph = document.getElementById('idAltigraph');\ncanvasAltigraph.addEventListener('mousemove', function(event) { that.processMouse(event); }, false);\ncanvasAltigraph.addEventListener('mouseout', function(event) {\nif( that.hoverTimer != null )\nclearTimeout( that.hoverTimer );\nthat.hoverTimer = null;\nthat.Refresh();\nif( that.marker ) {\nthat.marker.setMap( null );\nthat.marker = null;\n}\n}, false);\n}\n}\nvar altigraph = null;\nfunction DrawAltigraph()\n{\nvar canvas = document.getElementById('idAltigraph');\nif( !isCanvasSupported() )\nreturn;\naltigraph = new Altigraph();\naltigraph.setData( gpsAltigraph );\naltigraph.initEvents();\naltigraph.Refresh();\n}\nfunction CenterMap()\n{\nvar latLngBounds = new google.maps.LatLngBounds();\nfor( var i = 0; i {-{ courseCoordinates.length; i += 2 )\nlatLngBounds.extend( new google.maps.LatLng(courseCoordinates[i+1], courseCoordinates[i]) );\nmapCanvas.fitBounds( latLngBounds );\n}\nfunction RecenterControl( controlDiv, map )\n{\ncontrolDiv.style.padding = '5px';\nvar controlUI = document.createElement('div');\ncontrolUI.style.backgroundColor = 'inherit';\ncontrolUI.style.borderStyle = 'solid';\ncontrolUI.style.borderWidth = '0px';\ncontrolUI.style.cursor = 'pointer';\ncontrolUI.style.textAlign = 'center';\ncontrolUI.title = 'Recenter Course';\ncontrolDiv.appendChild(controlUI);\nvar controlText = document.createElement('div');\ncontrolText.style.fontFamily = 'Arial,sans-serif';\ncontrolText.style.fontSize = '12px';\ncontrolText.style.paddingLeft = '4px';\ncontrolText.style.paddingRight = '4px';\nvar img = document.createElement( 'img' );\nimg.alt = \"Recenter\";\nimg.src = \"data:/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARnQU1BAACx%0Ajwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAlwSFlz%0AAAAOwwAADsMBx2%2BoZAAAABp0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjUuMTAw9HKhAAANmElE%0AQVRYR62YCViO6RrHU2csiWqsY4aZOWYMJiLbWM5YKlGWkhZJyqBRmhbRJiotivaFNmVrkfbSvigS%0ApSaJVm2ISinRav7nfr7qOxrNORzzXdfvet7vfu/nf//f%2B3met%2B9qBM8nfm4%2B6%2BN92YMxJCPMM2LE%0A5zSOHMHD0wmg%2BTNenvaJo3m7xCby4RPLfNz0WzUtnyXU9YhFVvdahlf3ZkZU9z6Pqe3ti6/rRUJ9%0AL9gYXdvbQ/G6qJreuNjaXt3kuu6ZRTXPeT%2Bu0kdmZz5qHRle2SkfWtGdfbG8uyesqgdpj3uR%2B7wP%0Ad5uGkk/fbz3rQxLdD6G8oIrujvBH3eFx1Z0rip53UpP/5k94Wce8oLLOZP8HnX0%2BJZ1IrOtB7jMy%0A9wHkUE50dTe8ad6Fsq6uq1Vd/ml1nZP/NouhZa9/CSh53e5c0AGve6%2BR/rgbWU97PprE2m64/P4a%0AnqRBD1sdW/Vm5SeZTClv5rtU0mHtVfjqrU1uGxzvtiO5thNp9V3/N7TEsM1rh31%2BO%2BihX0dWdCjf%0AqW76%2BCWPL23hDShqM3e58/LtsewWHLvRgvCy10iofvPJnC95BXPSs7rVCt977W%2Bulr7aml9S%2BeHN%0AzMor5AkoaNntmPOi1yStEUbpjXC83YKo8ld/GxY3mmGc2YRj2c3wKXzZEvmwdeEHO7xwt3GW443G%0AF4cTn0KfkdwAv8JWhJa0/W04334Bg5QGDkcznsO/sKUo9f7j0R9k0u1GQ5xhXB20omuhTaPOtXoE%0AFr5ASmUbKpo7P5mE8pfwvNME7fh6HBzAMqMBl35vNvufBr2za9eaxddgb2gF9l6twr6IRzgQXQPv%0AO424VduGlx2dyClvGELb6y6U1DcPiRXXNaOjs3tI7CbNe/GqE%2Bmlz%2BF26zn2RVZzORBVDZebDS8i%0A7tZN/UuTrW96eU6l1sbtvVQC1YsPoBZUCrWQcuwJq4BL9hNkVbagtqkNThnVcM6q5/Kk9Q3C82uG%0AxEILGtD0sgPOGY%2B4cafr9ahs6kDCvXrYZzzmaKuF9rObrg/FPsK520//uosRhc%2B%2BNQx7%2BFrBuwAK%0AfkVQCiyG0oX7RAmskquR8rARj561wDqpAjapNf2kVKPuRQcu51Ryrgfjgbcf41lLO2wSy7kxa7pf%0A9qwdUfnVMImr4ui%2Bixo1xjG9puR8TPqoYbvonFylqe6Th82uudjqlQdZMirnWwhZQifsIeKLnqD8%0ASTPMoh7gaGw5l0eN7fDPeDgkdvZ6NZ40teJoVAk3bkZzSh7TYbtZhr1B9zna77LNpxBGUWU9gVnl%0AYsMatIy8H7Ll1HVIOWRho3MOpN1zIe1xm8N273xE5NWitO45jMMKYRxRzKWyoRXeSUVDYh6ppah7%0ARq%2BSKwXcuFF4Me7VNiEgrRibPe9wtQdrsHoagQXwzqzSec9gw8tOPv3zeSXrLBKx5kQq1tpfx7rT%0A2RB3vMHFN70UPT09aGt/NYSe3l60traiqampn8ZGtLa0oJfi3Ny2drwkOju7YB16E%2BJ/0mZ1WD1Z%0Atxy4JJcHvGcwp7xJaK9XduNyo2isME/ASqsUrLJJxyrbDC6nY39HYXkd1F0ToOGezOX%2Bo6cwNTWF%0AkpISFBQUIC8vDwMDA5TXPIGG6zVu3m63ZGQXVcD4HGm/o/uf63RI2GfAOup%2BWk/f26F//tLvN3wp%0Ab5fUJqZ7BYuORGGJ2TUsPZ6IpRbJXOzC83CDCmy0T8E2txuQY7hmo7DyKXR0dCAlJQVJSUmIi4tj%0A3759uF9RCznH1P48QtIhEzE5JdA/Ez9El1vjeBJW0goaBRUUdvW%2B5RvSxdR7T6avM45o/3b3OYj8%0AdgXzDSMhahyLBabxHEQJq5AcpOc/hOjhCBJKgqRdGqROpiGvtB4aGhpYvnw5li1bxkFVVRUFDyoh%0AZX0N4rapWEYPO98kHmEZhdByicACuh7U5tagenP0I6Dll3Ovq6fvH0MMZpU8nSJufLVFcIsbZqgH%0AYLZOKCWHY%2B6hKC5HL1xHSm4xZuuGcmI/GkZhoXEMbhRXc5ZWREQE8%2BbN44yysrK4mV8MUYMrmEt5%0ALH8OcTnpNn6xDxmiO1jjG%2B0rmLb3Mg763sjt7n079Nd3UXXzmE1Hw%2BvGS5/GeFl3fKF2DjMPBOO7%0Ag1fwnQ4jDEb%2BqXhQVQeby5mwDcmGbXA2bIKzUFb9BE5OTrTv9KGnpwddXV3Y2tqi4F4JzHzjYeaf%0ABDO/RJgSaTl3oWp5fkBzUJuM7Q%2BCsFogpu%2B5gEPnbka9d0hed/XyqNjGXhfecBICzOQ2D0zc6Yev%0AfrmIr/dfxteal2FwJgEl5fQy9o%2BGrX8MjYRfNIofVsInNAFW3uGwPHsVFmfC4BwYiZzb%2BTBzC%2BJg%0ASpi4BiEhLRsKpj4cPcZX%2By5hkvp5CKueg9AOX3y/LxDHg26fHPY9qOWa5DB100mMlbDBuE2OEJT3%0AgLCyNybt8scXGoHQcYtBVNptTFHxpA77cZi6ywcxGXcgoctivtz4it/8EBabjKkqHv/JpXy3S/HY%0Aaki56oGYRKskrOoPYWqE0A4fCG33wtojV/6wuZgpN6xB%2B9Bcibkqrm/5fz6GsZK2GLfZiWNSUPEs%0AhJR9sP/UVYQn52CCkgcmqfpxmLjTB%2BEpt7Bay5W%2B%2B3LjS7R8EBwRj0lK7u/k%2BsExMBpSB504ev14%0AQ4j0WZ0ZKmew5/S1loDk4i%2BGNXintGG0jOHFGoFVpuBffQwC65lJR4yXc4Pgdk/ssQ1G6LXrtEed%0ASfQMhAkhBU%2BExF/Hir2nON8/V%2Bpn4V4PXLgSDSE5p/48YrzCGdj7hkP8V3sIKnj1Q7rjt7lhGj30%0ACu0AmPhlRsTkVv31ry5d14Sj09ZbYMxPR8D/szmZpOWWOYXxW12w2/IiQmLTIbTZHsLbnCEsR0Zl%0AnXA5Og3Ld1tzvg8iquaIgKCrlGvXn0sI0X27s6FYu9cWgtvcIcgenHRn7PDAgj1nsd08tM8l/I7k%0Af/1N6BWVLyyh7dM4dqk%2BRi8zJJNHaU%2BegMBGeygae%2BNBaRnSs24iNTMbKelZSErLRF5%2BARJT0hAd%0Al4jI2GsIj45DZEw8UtPSERwWQUQOEIGk5FSs3HUc47eQ6a3O%2BF7VEws0vLBK0xuGnkkZkdmlQ1/Q%0Aw7nVdY49MFPGAqMXHsTopYcwZpUJxq6zgNB6S0yRPEIcxpT1DLoeYDKNXChnMofD7yNxGIISZvhC%0A3gUiu72wUN0TS9TdsPN4SLdrWO7i//mLmiW4h%2BeOVDK5ED9xpQFGiWph9GI9jFlhRPvSHGPFLTnL%0ALrDBDuOoq%2BOkHT4cyp%2B09TR%2B2OmOBWRsoZobFqs6Q0bXF8d9U60%2ByNxgkt35zGnS2mdKBRdrY6TI%0AfozidNOg3yhb9rUWZNaKTrt1v2E6UAJSdsNAcbo3ZYsDZim7QlTNHQt3uUJspxMWqZyCpKYnDF3i%0AIs9E3Bn%2BR%2BpwrmdsO83zubTtiMNu8bMk97s9Elp0ACPn7sHIeZoYJcaM6mPM8iOcpWdm%2BdccA//a%0A4%2BCnbdAPdZnMT9hogxlyDpi7wxnzd7pAlEwtUDkNMWUHLFa2A2njt1MR6XtsIoQFJE/wCW2wGTFl%0A8/DvaK5PMsYzVvIEL00YSQgoHw0Wk9byLJm6XAej56pjFBkdNV%2BT9qc2xizWBf9PhyCw8ggEV5ti%0Aorg5pm2wxLdbbDBb3h4/KjpAhJhPiCraY6GiHcQUbLBU0QabtDz%2B0LQJS1i27%2BwPVGcCq0V8NlbC%0Ainc6NWj4zypzHkoaMWBOkMYZhOhMRSdpWQO/9CXyVn1fLtfG5CW/YupP2pi2Sg/T1xjiGwljzNxg%0Ahu%2Blj%2BGHTRaYs8USc2WtICJnhfmEqJwlFshZYNE2C/y80w7Khn5dCiYXQyZI220l/dWsBjGdYDVH%0AUhd59dyuve%2BRJjCDfMRY4ktiMcFENMettzZZrOERIqPt9XyZvAVmrtHF1ysP4pt/6eCfa/Twnfgh%0AzKJTO1vKCHM3mkBExgTzZUyxYLMpFsma4187rCH/m9cfSkaBtbN3uJwnTWvCmNhPbCEWEdMIfnqt%0A8a3W9n/foMgud9Y9ZnAcMZNYS%2BwhjhGuhL%2BglE2w2G73bBmds082/erat0rJCmJkQnTjEczfcJgz%0Aim02xrJt5lhNpjZrOkPlsF/3Fn3/mjkqLhnj1p%2B4SjqXmRbhQpgTGsQa4ltWm7YY3wQZu/f/oTRT%0A0Xmwg2w/fE2sIJQJg4EnZia9iUDaK5dIJExM3SN9ndbZu5t0fcpl9Xzr5fR9H8sZ%2BNVt0vMtXavl%0AnSei6poiKGUdRkWDad4lImBAg5k7QegTSsRygi3zWNZBdlDf//TvQXZARhNs434/YHIzjarErwOC%0AbGlYV60IW%2BIkGXAg06f4CRpPU%2BwU4cDuETYDuaxbRoQeoTmgybRZI1itz4lRwhtseA%2B5Jwx/Tihh%0AcJmZSXb8vyJmEQsI9pRsKdYTMoQssZ1QJHYQKn%2BCxdg9%2BYFcNofNZRo/DWgybbbfWS1Wk28cefjL%0AlzYlDJ5k1snPiDEE25NMYDLBNjI73f8kviPYa2IO8SMh8idYjN1jOaxDbA6byzSYFtNk2swYq8Vq%0AjqAV%2BO9/VAZMvmuUHZx/DIiMGjDNTyM77Wy/jn8H9qpgDMaYAZbDctkc9sBMgxlimkybY4zV/fPn%0A3%2BMTuRApouXmAAAAAElFTkSuQmCC%0A\";\ncontrolText.appendChild( img );\ncontrolUI.appendChild(controlText);\ngoogle.maps.event.addDomListener(controlUI, 'click', function() {\nCenterMap();\n});\n}\nfunction DrawMap()\n{\nvar mapOptions = {\nmapTypeId: google.maps.MapTypeId.ROADMAP,\nscaleControl: true,\n};\nmapCanvas = new google.maps.Map(document.getElementById('idMap'), mapOptions);\nvar points = [];\nvar length = 0.0;\nfor( var i = 0; i {-{ courseCoordinates.length; i += 2 )\n{\nvar latLng = new google.maps.LatLng(courseCoordinates[i+1], courseCoordinates[i]);\npoints.push( latLng );\nif( i }-} 0 )\nlength += GreatCircleDistance(courseCoordinates[i-2+1], courseCoordinates[i-2], courseCoordinates[i+1], courseCoordinates[i]);\n}\nif( !gpsIsPointToPoint )\npoints.push( points[0] );\nvar arrowLength = length * 0.005;\nvar arrowCount = 50;\nvar arrowTick = length / arrowCount;\nvar arrowAngle = 30.0;\nvar nextArrowDistance = arrowTick / 2;\nvar length = 0.0;\nfor( var i = 2; arrowCount }-} 0 && i {-{ courseCoordinates.length; i += 2 )\n{\nvar iPrev = (i - 2 + courseCoordinates.length) % courseCoordinates.length;\nvar iPrevPrev = (i - 4 + courseCoordinates.length) % courseCoordinates.length;\nlength += GreatCircleDistance(\tcourseCoordinates[i-2+1], courseCoordinates[i-2],\ncourseCoordinates[i+1], courseCoordinates[i]);\nvar angle = CompassBearing(\tcourseCoordinates[iPrevPrev+1], courseCoordinates[iPrevPrev],\ncourseCoordinates[iPrev+1], courseCoordinates[iPrev] ) -\nCompassBearing(\tcourseCoordinates[iPrev+1], courseCoordinates[iPrev],\ncourseCoordinates[i+1], courseCoordinates[i] );\nwhile( angle {-{ 360 )\nangle += 360;\nif( angle {-{ 125 )\ncontinue;\nwhile( length }-} nextArrowDistance )\n{\nvar p = [courseCoordinates[i+1], courseCoordinates[i]];\nnextArrowDistance += arrowTick;\n--arrowCount;\nvar bearing = CompassBearing(\tcourseCoordinates[iPrev+1], courseCoordinates[iPrev],\ncourseCoordinates[i+1], courseCoordinates[i] );\nvar pHead = p;\nvar pWing1 = DestinationPoint( pHead[0], pHead[1], bearing + 180.0 - arrowAngle, arrowLength );\nvar pWing2 = DestinationPoint( pHead[0], pHead[1], bearing + 180.0 + arrowAngle, arrowLength );\nvar arrow = new google.maps.Polyline( {\npath:  [new google.maps.LatLng(pWing1[0], pWing1[1]),\nnew google.maps.LatLng(pHead[0],  pHead[1]),\nnew google.maps.LatLng(pWing2[0], pWing2[1])],\nstrokeColor: \"#ff8c00\",\nstrokeOpacity: 1.0,\nstrokeWeight: 2,\nmap: mapCanvas\n});\t\t\t\n}\n}\nvar course = new google.maps.Polyline( {\npath: points,\nstrokeColor: \"#FF0000\",\nstrokeOpacity: 0.6,\nstrokeWeight: 5,\nmap: mapCanvas\n});\nvar xTick = (altigraph && altigraph.xTick ? altigraph.xTick : null);\nif( !xTick )\n{\nvar courseLength = lengthKm * (displayUnits == 'km' ? 1.0 : 0.621371);\nvar d = courseLength / 10.0;\nxTick = getBestInterval(d, [0.1,0.25,0.5,1.0,2.0,5.0,10.0,15.0,20.0,25.0,50.0,100.0,250.0,500.0,1000.0] );\n}\nvar precision = (xTick }-}= 1 ? 0 : xTick == 0.25 ? 2 : 1);\nvar tickMult = displayUnits == 'km' ? 1000.0 : 1609.344;\nvar nextMarkerDistance = xTick;\nvar length = 0.0;\nfor( var i = 2; i {-{ courseCoordinates.length; i += 2 )\n{\nlength += GreatCircleDistance(\tcourseCoordinates[i-2+1], courseCoordinates[i-2],\ncourseCoordinates[i+1], courseCoordinates[i]);\nwhile( length }-}= nextMarkerDistance * tickMult )\n{\nvar p = DestinationPointToPoint( courseCoordinates[i+1], courseCoordinates[i],\ncourseCoordinates[i-2+1], courseCoordinates[i-2],\nlength - nextMarkerDistance * tickMult );\nvar mapLabel = new MapLabel({\ntext: nextMarkerDistance.toFixed(precision),\nposition: new google.maps.LatLng(p[0], p[1]),\nfontSize: 17,\nalign: 'middle',\nmap: mapCanvas\n});\nnextMarkerDistance += xTick;\n}\n}\nvar finish = new google.maps.Marker({\nposition: gpsIsPointToPoint ? points[points.length-1] : points[0],\ntitle: 'Finish Line',\nicon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAgCAYAAAD5VeO1AAAEsklEQVRIibWVX0jTaxjHH//029lcVqvM0taNGUHNinGOnkGohJWtQ4KaFEVySlSSUixzTFwZxYnROv2ByisLgwqCIRRhF4EcKsjgeBrDgUqYDhvLJtoyt33OTZPCKLX83L0Xz+f78uV5eUVmiM/na/b7/TUznfsuL1++PM4nbt682V5VVbXkp4jLy8uP6/V6Hj58yPPnz1mwYAEGg2Hs6NGjuT8kttvtxuXLl4dFhNWrV3PhwgXi4uIQEaxW65jP58uflbijo2Phhw8f/m1tbSUpKYlnz54BcP/+fUpLSwmFQkQikbDX6z1ps9lipy222Wyxbre7LdpzU1MTPT09AHg8HrZs2YLb7QagsbGRnJyc/rq6Ov205Lt3725ftWoVT5484erVq4gIS5cuxel0YjQaERF0Oh3Xr1+frGnjxo3B3t5ewzfFTU1NtfPmzUNEKCgowGKxEBMTQ3x8PE6nk4aGBmJjYzGZTLx//57z58+jUqm4ceMGoVAo8ObNm+Kvint7ew0TExOBy5cvk5GRgc/nA+DWrVs4HI5oS7S0tEzWAnDt2jX8fj8Aw8PDrVPEJ06cSHv9+nUPwOjoKBUVFQwMDADgdDoxmUy8evWKjx8/snXrVtavX4/L5eLx48eo1WrS09Pp6OhwtbW1ab4QX7x4UTGZTENr166lq6uL/fv3IyLo9Xru3r2LTqdDRFixYgV2ux0RQUTIysqisrISESE1NTVcU1Pz+5RbHzt27EF04NSpU+zduxcRISUlBY/HQ1VVFSLCkSNHCIVCNDY2snjxYrq6uohEIpw9ezZ8+PDhyilir9d7IBQKcfr0afbs2UMkEgHAbrfz6NGjyV6vXLnCyMjI5PnMmTOMjo4SiUTwer1TxQ0NDcXv3r0bA+ju7ubgwYMEAgEA6urqyMvLY2hoiP7+flauXElmZiZ9fX2cO3cOEWHDhg08ffq0ZYq4trbWoNfrJ4xGIy9evMBgMCAiGAwGmpubiYmJQUTIyMigoqJisueysjJ27tyJiJCZmemvrq7+ZYr8D7O5Mz4+HkVRuHfv3uRATk4Ob9++Zd++fcTFxXHnzh2CwSBlZWVs2rSJkZERJiYmsFqtfovFsm6KWETEYDBo8rdt++fSpUtBgHA4jM1mY3Bw8Iuew+FwdH+pr69nfHycUCg05vF4fv2q+HN27dp1cnBwcGB8fJzs7GwKCwsZHh6mvb0dRVEwm834fD4KCgoQETZv3ozL5TrwXXGU34zG/Jrqam+018LCQnJzcyd7djgcmEwmRISioqKOaYuj6HS6VLPZ3JeSkkJ3dzeBQIDi4mIOHToEQDAYpL6+/j+bzRY/Y7mIyPbt25U/S0tvj42NDQN0dnZisVgIh8MEg0GX2+3WzUr8OTt27Kjt7OwcSEtLQ0QoKSkZd7vdX9+M2bBmzZrsvLw8v6IolJeXW3+aOEpycvISU1bWg/nz56f/dPknYrUajUWjUpnnKkC0anWhWlGOFxUVTf8zngmLtNp1apXKISIL5yZg0aLEBLXasTAh4duf8Y+QoFbXqBWlZM4CEjWafK1GYxWR2b3a7wYkJqapVaq/tVpt0pwELFu2TJOgVv8lIskiIv8DQ4HqhmfkzxMAAAAASUVORK5CYII=\",\nanimation: google.maps.Animation.BOUNCE,\nmap: mapCanvas\n});\nsetTimeout( function() { finish.setAnimation(null); }, 4000 );\nCenterMap();\nvar isEI = !!window.ActiveXObject;\nif( !isEI ) {\nvar recenterDiv = document.createElement( 'div' );\nvar recenterControl = new RecenterControl( recenterDiv, mapCanvas );\nrecenterControl.index = 1;\nmapCanvas.controls[google.maps.ControlPosition.TOP_RIGHT].push(recenterDiv);\n}\n}\nfunction DrawCourseStats()\n{\ndocument.getElementById('idCourseLength').innerHTML = displayUnits == 'km'\n? lengthKm.toFixed(2) + ' km'\n: (lengthKm * 0.621371192).toFixed(2) + ' miles';\nif( !gpsAltigraph )\nreturn;\nvar eleDisplayUnits = (displayUnits == 'km' ? '&nbsp;m' : '&nbsp;ft');\nvar prec = (displayUnits == 'km' ? 1 : 0);\nvar eleMult = displayUnits == 'km' ? 1.0 : 3.28084;\nvar startElevation = gpsAltigraph[0][1];\nvar minElevation = 999999.0;\nvar maxElevation = -9999999.0;\nvar totalElevationGain = gpsTotalElevationGain;\nfor( var i = 0; i {-{ gpsAltigraph.length; ++i )\n{\nminElevation = Math.min( minElevation, gpsAltigraph[i][1] );\nmaxElevation = Math.max( maxElevation, gpsAltigraph[i][1] );\n}\ndocument.getElementById('idStartElevation').innerHTML = (startElevation * eleMult).toFixed(prec) + eleDisplayUnits;\ndocument.getElementById('idMinElevation').innerHTML = (minElevation * eleMult).toFixed(prec) + eleDisplayUnits;\ndocument.getElementById('idMaxElevation').innerHTML = (maxElevation * eleMult).toFixed(prec) + eleDisplayUnits;\nif( totalElevationGain )\ndocument.getElementById('idTotalElevationGain').innerHTML = (totalElevationGain * eleMult).toFixed(prec) + eleDisplayUnits;\n}\nfunction OpenGetDirections()\n{\nvar url = 'http://maps.google.com?daddr=' + courseCoordinates[1].toFixed(4) + ' ' + courseCoordinates[0].toFixed(4) + ' (' + raceName + ')';\nwindow.open( url, null, null, true );\n}\nfunction getUrlParam( param, url )\n{\nparam = param.replace(/([\\[\\](){}*?+^$.\\\\|])/g, \"\\\\$1\");\nvar regex = new RegExp(\"[?&]\" + param + \"=([^&#]*)\");\nurl   = url || decodeURIComponent(window.location.href);\nvar match = regex.exec(url);\nreturn match ? match[1] : \"\";\n}\nfunction FormatDistance( distance, inUnit, showUnits )\n{\nif( (inUnit ? inUnit : 'km') != displayUnits )\ndistance *= (displayUnits == 'km' ? 1.609344 : 0.621371192237334);\nvar s = distance.toFixed(2);\nif( showUnits )\ns += ' ' + displayUnits;\nreturn s;\n}\nfunction onLoad()\n{\nif( payload ) { for( v in payload ) window[v] = payload[v]; payload = null; }\nraceName = raceNameText + ' ' + raceDate;\ndocument.getElementById('idRaceName').innerHTML = raceName;\nvar s = '';\nif( organizer )\ns = 'by ' + organizer;\nif( s )\ndocument.getElementById('idOrganizer').innerHTML = s;\nDrawAltigraph();\nDrawMap();\nDrawCourseStats();\n}\ngoogle.maps.event.addDomListener(window, 'load', onLoad);\n{-{/script}-}\n{-{/head}-}\n{-{body}-}\n{-{h1 id=\"idRaceName\"}-}Accessing Map Data. Please be patient...{-{/h1}-}\n{-{span id=\"idOrganizer\"}-}by CrossMgr{-{/span}-}\n{-{p/}-}\n{-{/p}-}\n{-{button id=\"idGetDirections\" class=\"noprint\" onclick=\"OpenGetDirections()\" style=\"font-size: 120%;\"}-}Get Directions{-{/button}-}\n{-{p/}-}\n{-{table class=\"CourseStats\"}-}\n{-{tr}-}{-{th}-}Length{-{/th}-}{-{th}-}Start Elevation{-{/th}-}{-{th}-}Min Elevation{-{/th}-}{-{th}-}Max Elevation{-{/th}-}{-{th}-}Total Elevation Gain{-{/th}-}{-{/tr}-}\n{-{tr}-}{-{td id=\"idCourseLength\"/}-}{-{td id=\"idStartElevation\"/td}-}{-{td id=\"idMinElevation\"/td}-}{-{td id=\"idMaxElevation\"/}-}{-{td id=\"idTotalElevationGain\"/}-}{-{/tr}-}\n{-{/table}-}\n{-{div id=\"idMap\" style=\"height: 550px; width: 800px;\"}-}{-{/div}-}\n{-{p}-}{-{/p}-}\n{-{div id=\"idInfo\"}-}\n{-{canvas id=\"idAltigraph\" width=\"800\" height=\"125\"}-}\n{-{a href=\"http://www.sites.google.com/site/crossmgrsoftware\"}-}CrossMgr{-{/a}-} Course viewer requires support the HTML5 Canvas.{-{br/}-}\nPlease upgrade to a more recent browser version.{-{br/}-}\nFor Internet Explorer (IE), you need version 9.0 or higher.{-{br/}-}{-{br/}-}\nCurrent versions of Chrome, FireFox and Opera work fine.\n{-{/canvas}-}\n{-{/div}-}\n{-{p/}-}\nPowered by {-{a href=\"http://www.sites.google.com/site/crossmgrsoftware\"}-}CrossMgr{-{/a}-}.\n{-{/body}-}\n{-{/html}-}\n","primes":[],"organizer":"KW Cycling Academy","raceScheduledStart":"2019-08-18 11:00","gpsPoints":[[4832,1852,165],[4746,1977,95],[4694,2050,53],[4653,2080,49],[4611,2063,112],[4516,2009,63],[4454,1965,36],[4423,1934,33],[4394,1900,133],[4277,1813,125],[4131,1825,103],[4027,1871,136],[3898,1876,46],[3855,1869,133],[3710,1849,104],[3603,1880,101],[3526,1954,90],[3478,2033,49],[3453,2073,86],[3397,2132,38],[3363,2144,157],[3212,2212,41],[3162,2241,46],[3113,2272,44],[3059,2289,99],[2951,2317,57],[2894,2322,44],[2847,2323,43],[2798,2330,82],[2730,2361,46],[2701,2369,35],[2682,2382,71],[2639,2414,36],[2614,2429,49],[2599,2468,35],[2587,2496,51],[2554,2528,85],[2534,2604,21],[2536,2623,56],[2526,2670,48],[2519,2714,26],[2507,2735,199],[2464,2919,28],[2464,2945,140],[2466,3073,84],[2458,3154,99],[2425,3243,35],[2410,3272,149],[2318,3390,150],[2235,3515,193],[2130,3674,181],[2059,3834,128],[1973,3929,73],[1922,3979,119],[1838,4065,252],[1657,4254,165],[1541,4351,169],[1435,4476,51],[1402,4516,123],[1357,4634,30],[1355,4662,64],[1342,4715,22],[1332,4732,31],[1315,4752,63],[1274,4794,66],[1225,4831,166],[1121,4954,149],[1014,5056,76],[941,5023,111],[837,4943,49],[791,4910,35],[751,4884,24],[718,4870,25],[689,4848,34],[655,4819,56],[604,4785,65],[551,4743,56],[491,4700,60],[427,4655,46],[371,4607,48],[314,4563,64],[250,4521,50],[200,4473,102],[117,4383,197],[0,4222,157],[45,4074,62],[75,4016,53],[107,3970,144],[210,3876,233],[400,3736,209],[576,3627,174],[680,3485,113],[721,3369,88],[745,3279,44],[751,3232,219],[761,3013,242],[785,2779,45],[801,2737,182],[898,2586,201],[1038,2437,172],[1152,2305,179],[1241,2143,199],[1401,2020,165],[1542,1943,112],[1603,1846,172],[1694,1700,151],[1759,1555,66],[1796,1503,245],[1942,1306,136],[2021,1192,141],[2105,1081,87],[2184,1033,18],[2199,1021,61],[2230,968,101],[2274,877,54],[2314,832,84],[2384,785,40],[2413,753,143],[2511,649,150],[2611,537,149],[2695,416,18],[2702,399,72],[2765,349,115],[2849,271,82],[2916,227,23],[2933,212,134],[3042,128,36],[3074,111,166],[3235,54,115],[3342,18,150],[3489,0,76],[3563,34,33],[3595,45,27],[3624,54,136],[3765,64,13],[3775,62,112],[3885,52,32],[3908,67,20],[3926,77,31],[3952,90,15],[3963,86,10],[3973,88,45],[3983,127,12],[3972,134,10],[3968,144,183],[3862,291,187],[3765,454,153],[3698,590,167],[3648,739,155],[3564,870,187],[3458,1010,161],[3352,1135,42],[3324,1170,209],[3210,1352,137],[3146,1467,191],[3058,1626,213],[2972,1816,149],[2948,1951,35],[2948,1979,36],[2948,2010,160],[2932,2164,53],[2950,2215,49],[2985,2238,21],[2994,2252,63],[3046,2266,20],[3064,2267,47],[3106,2263,62],[3149,2239,104],[3208,2168,31],[3224,2141,146],[3312,2023,30],[3338,2009,119],[3454,1997,133],[3576,2019,139],[3699,1999,37],[3730,1990,125],[3846,1948,145],[3990,1905,154],[4101,1791,41],[4127,1759,155],[4238,1645,34],[4255,1615,147],[4323,1482,178],[4452,1338,50],[4492,1303,91],[4564,1235,53],[4609,1197,31],[4640,1179,35],[4669,1159,41],[4703,1127,142],[4795,999,60],[4832,945,165],[4919,796,43],[4930,751,75],[4995,697,40],[5041,689,28],[5077,689,42],[5124,683,105],[5231,696,161],[5389,707,52],[5439,704,169],[5598,734,35],[5625,758,77],[5649,823,18],[5646,837,65],[5605,872,73],[5575,926,17],[5564,940,18],[5552,955,138],[5475,1058,176],[5369,1189,184],[5258,1324,108],[5199,1402,114],[5130,1484,179],[5017,1611,57],[4989,1655,165],[4892,1778,110]],"showCourseAnimation":true,"raceNotes":"","winAndOut":false,"catDetails":[{"catType":"Custom","name":"All","gapValue":[0,449.31850299999996,-1,-1,-1,-2],"gender":"Open","laps":0,"pos":[155,101,156,141,123,139],"startOffset":0},{"pos":[155,101,156,141,123,139],"iSort":0,"lapDistance":2.0702896097286576,"startOffset":0.0,"finishers":6,"catType":"Start Wave","name":"Expert/Sport Women (Women)","gapValue":[0,449.31850299999996,-1,-1,-1,-2],"gender":"Women","laps":6,"starters":6,"distanceUnit":"km","raceDistance":12.421737658371946}],"infoFields":["LastName","FirstName","Name","Team","City","State","Prov","StateProv","Nat.","Category","Age","Gender","License","NatCode","UCIID","UCICode"],"version":"CrossMgr 2.3.11","lapDetails":{},"estimateLapsDownFinishTime":false,"raceIsRunning":false,"raceAddress":"Waterloo, Ontario, Canada","raceDate":"2019-08-18","email":"","gpsTotalElevationGain":50.599999999999966,"finishTop":false,"timestamp":["Sun Aug 18 17:34:01 2019",3159.401767],"raceName":"2019-08-18-The Dirty Nein-r3-","rfid":false,"licenseLinkTemplate":"","reverseDirection":false,"data":{"155":{"Category":"Expert Women","lastInterp":false,"interp":[0,0,0,0,0,0,0],"FirstName":"Carolyn","LastName":"SMITH","raceCat":"Expert/Sport Women (Women)","flr":1.0,"relegated":false,"lapSpeeds":[16.14475,18.38401,17.93261,17.68885,17.81993,17.95378],"raceSpeeds":[16.14475,17.19177,17.43182,17.49537,17.55934,17.62387],"status":"Finisher","raceTimes":[0.0,461.6388,867.04788,1282.66192,1704.00316,2122.2451,2537.36899],"Team":"Waterloo Cycling Club","lastTime":2537.36899,"speed":"17.62 km/h","lastTimeOrig":2537.36899},"101":{"Category":"Sports Women","lastInterp":false,"interp":[0,0,0,0,0,0,0],"FirstName":"Cheryl","LastName":"RIDGERS","raceCat":"Expert/Sport Women (Women)","flr":1.0,"relegated":false,"lapSpeeds":[14.19259,15.50205,14.88113,15.02001,14.8349,15.48433],"raceSpeeds":[14.19259,14.81845,14.83928,14.88405,14.8742,14.97253],"status":"Finisher","raceTimes":[0.0,525.13622,1005.91413,1506.7527,2002.96043,2505.35951,2986.68749],"Team":"Woodstock cycle club","lastTime":2986.687493,"speed":"14.97 km/h","lastTimeOrig":2986.687493},"139":{"Category":"Sports Women","lastInterp":false,"interp":[0,0,0,0,0],"FirstName":"Erin","LastName":"FELDER","raceCat":"Expert/Sport Women (Women)","flr":1.0,"relegated":false,"lapSpeeds":[10.74435,11.82843,11.82196,12.37809],"raceSpeeds":[10.74435,11.26036,11.44153,11.66213],"status":"Finisher","raceTimes":[0.0,693.67113,1323.76671,1954.20709,2556.32292],"Team":"WCC","lastTime":2556.322919,"speed":"11.66 km/h","lastTimeOrig":2556.322919},"141":{"Category":"Sports Women","lastInterp":false,"interp":[0,0,0,0,0,0],"FirstName":"Tina","LastName":"EILERS","raceCat":"Expert/Sport Women (Women)","flr":1.0,"relegated":false,"lapSpeeds":[13.59092,15.00424,14.34243,14.37069,14.16482],"raceSpeeds":[13.59092,14.26265,14.28915,14.30945,14.28028],"status":"Finisher","raceTimes":[0.0,548.38403,1045.11303,1564.76299,2083.39099,2609.5567],"Team":"Tina Eilers","lastTime":2609.556702,"speed":"14.28 km/h","lastTimeOrig":2609.556702},"123":{"Category":"Sports Women","lastInterp":false,"interp":[0,0,0,0,0,0],"FirstName":"Amy","LastName":"MAHER","raceCat":"Expert/Sport Women (Women)","flr":1.0,"relegated":false,"lapSpeeds":[13.46075,14.60778,14.01553,14.02082,14.52908],"raceSpeeds":[13.46075,14.01083,14.0124,14.0145,14.11448],"status":"Finisher","raceTimes":[0.0,553.68697,1063.89749,1595.66764,2127.23716,2640.21144],"Team":"NCCH","lastTime":2640.211437,"speed":"14.11 km/h","lastTimeOrig":2640.211437},"156":{"Category":"Sports Women","lastInterp":false,"interp":[0,0,0,0,0,0],"FirstName":"Michal","LastName":"PASTRIK","raceCat":"Expert/Sport Women (Women)","flr":1.0,"relegated":false,"lapSpeeds":[13.37443,14.50085,14.76756,15.14385,14.91576],"raceSpeeds":[13.37443,13.91488,14.18795,14.41543,14.5128],"status":"Finisher","raceTimes":[0.0,557.26044,1071.23323,1575.92345,2068.07311,2567.74865],"Team":"Faction - Smile Tiger p/b WCC","lastTime":2567.748648,"speed":"14.51 km/h","lastTimeOrig":2567.748648}},"gpsAltigraph":[[0.0,355.4],[15.10755,356.6],[24.1276,357.0],[29.22118,357.2],[33.6611,357.6],[44.63033,357.8],[52.20664,356.8],[56.6332,356.2],[61.14079,355.2],[75.70395,354.2],[90.27799,352.6],[101.64057,351.8],[114.56153,352.4],[118.98729,352.6],[133.56726,351.6],[144.74041,351.0],[155.42924,350.6],[164.69004,350.4],[169.41018,350.6],[177.51713,351.0],[181.11972,351.2],[197.66162,350.6],[203.43919,349.2],[209.26285,348.2],[214.91993,347.2],[226.08281,346.2],[231.83805,346.2],[236.51885,346.0],[241.40545,345.6],[248.93696,346.2],[251.94395,347.8],[254.22954,349.0],[259.519,350.6],[262.46499,351.2],[266.64783,351.8],[269.67971,352.2],[274.29929,352.6],[282.12495,353.2],[284.0307,353.4],[288.92577,354.0],[293.31014,354.4],[295.74491,354.6],[314.71045,355.4],[317.26794,355.6],[330.05764,356.6],[338.21487,356.8],[347.70558,357.2],[350.9779,357.4],[365.87894,357.4],[380.94332,357.4],[400.03627,357.6],[417.41744,358.2],[430.30032,358.2],[437.43279,358.4],[449.42069,358.4],[475.62846,357.6],[490.6846,358.8],[507.15555,359.2],[512.3484,359.2],[524.97129,359.0],[527.75584,359.2],[533.24707,360.0],[535.21735,360.2],[537.83965,360.6],[543.68142,361.0],[549.82017,361.4],[565.96498,361.8],[580.71366,362.0],[588.65847,361.8],[601.78898,360.2],[607.4701,359.6],[612.17845,358.6],[615.78829,357.6],[619.51071,356.6],[623.90385,355.8],[630.05107,355.4],[636.84862,355.2],[644.22757,353.8],[651.99963,352.4],[659.39932,350.0],[666.58796,348.0],[674.23494,347.0],[681.21317,345.4],[693.41322,343.8],[713.38082,343.6],[728.86824,343.8],[735.33885,343.6],[740.92445,343.4],[754.92361,343.8],[778.56309,343.6],[799.25331,343.8],[816.74815,343.8],[829.12745,343.0],[838.45378,342.6],[843.16836,342.4],[865.09514,342.4],[888.563,343.0],[893.11543,343.0],[911.07161,343.2],[931.48805,343.0],[948.99079,342.8],[967.39522,342.4],[987.58273,342.2],[1003.65188,342.6],[1015.10544,342.4],[1032.34176,342.4],[1048.20573,341.8],[1054.61564,342.0],[1079.1232,342.0],[1092.99481,341.8],[1106.88549,342.0],[1116.11512,341.6],[1118.0089,341.6],[1124.20475,341.6],[1134.31018,341.6],[1140.26103,341.2],[1148.75415,341.2],[1153.0121,341.0],[1167.36972,341.0],[1182.41038,341.0],[1197.06051,341.2],[1198.9531,341.2],[1206.99319,340.6],[1218.49776,340.6],[1226.47597,340.8],[1228.77689,340.8],[1242.49512,340.6],[1246.10991,340.6],[1263.21404,340.2],[1274.51948,340.4],[1289.32503,340.6],[1297.50923,340.2],[1300.84657,340.2],[1303.88434,340.0],[1318.03935,339.6],[1319.11155,339.8],[1330.13002,340.0],[1332.87358,340.4],[1334.91128,340.4],[1337.84134,340.6],[1338.942,341.0],[1340.0142,341.0],[1344.02464,341.4],[1345.26773,341.4],[1346.34674,341.4],[1364.48129,341.6],[1383.4792,341.4],[1398.60785,341.6],[1414.32525,342.4],[1429.89988,342.4],[1447.45003,343.4],[1463.83665,343.2],[1468.32954,343.0],[1489.77171,342.6],[1502.97619,343.0],[1521.14698,343.8],[1542.02931,344.2],[1555.69988,345.2],[1558.48092,345.8],[1561.59542,346.2],[1577.13552,346.6],[1582.4723,346.6],[1586.65422,347.2],[1588.35046,347.6],[1593.76179,348.4],[1595.54025,348.6],[1599.74889,349.0],[1604.74545,350.0],[1613.98302,351.0],[1617.10161,351.0],[1631.75942,351.0],[1634.78899,351.0],[1646.47126,351.2],[1658.85541,352.0],[1671.28118,353.2],[1674.55107,353.6],[1686.83787,353.8],[1701.88523,353.4],[1717.8583,353.0],[1721.98917,353.0],[1737.8263,352.8],[1741.27366,352.8],[1756.27624,352.6],[1775.57387,351.4],[1780.89275,351.2],[1790.7705,350.6],[1796.66178,350.2],[1800.27652,349.8],[1803.80391,349.8],[1808.48165,349.4],[1824.1864,348.2],[1830.7789,347.8],[1848.0399,347.2],[1852.62889,347.0],[1861.13751,346.2],[1865.72229,345.8],[1869.35301,345.2],[1874.06551,344.8],[1884.86578,344.6],[1900.71861,344.8],[1905.72587,345.0],[1921.90139,345.6],[1925.44281,345.6],[1932.43559,346.2],[1933.8084,346.6],[1939.18754,347.6],[1945.34281,348.6],[1947.12878,348.6],[1949.01405,348.6],[1961.88604,349.4],[1978.78527,350.0],[1996.19802,350.8],[2006.00778,351.6],[2016.71938,352.2],[2033.69799,353.0],[2038.96648,353.4],[2054.56599,354.2],[2064.16386,355.4]],"raceIsUnstarted":false,"riderDashboard":"{-{!DOCTYPE html}-}\n{-{html}-}\n{-{!--\nHtml Template for Rider Dashboard.\nGenerated from CrossMgr software.\nCopyright Edward Sitarski\nFor details, see sites.google.com/site/CrossMgrSoftware\n--}-}\n{-{head}-}\n{-{meta charset=\"UTF-8\"}-}\n{-{meta name=\"author\" content=\"Edward Sitarski\"}-}\n{-{meta name=\"copyright\" content=\"Edward Sitarski\"}-}\n{-{meta name=\"generator\" content=\"CrossMgr\"}-}  \n{-{meta name=\"keywords\" content=\"CrossMgr, Cycling, Race, Results\"}-}\n{-{title id=\"idTitle\"}-}TTIITTLLEE{-{/title}-}\t{-{!-- Don't change this text! --}-}\n{-{style type=\"text/css\"}-}\nbody { font-family: sans-serif; }\n.hidden { display: none; }\ndiv label input {\nmargin-right:220px;\n}\nselect {\nfont-size: 110%;\n}\n@media print { .noprint { display: none; } }\n{-{/style}-}\n{-{script type=\"text/javascript\" src=\"https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization',\n'version':'1','packages':['table', 'corechart', 'timeline',]}]}\"}-}{-{/script}-}\n{-{script type=\"text/javascript\"}-}\ngoogle.setOnLoadCallback(onLoad);\nvar payload = null;\nvar bib = null;\nvar data = null;\nvar catDetails = null;\nvar raceName = null;\nvar bibRef = null;\nvar categoryCur = null;\nArray.prototype.back = function() {\nreturn this[this.length-1];\n}\nArray.prototype.binSearch = function( v ) {\nvar L = this.length, i = -1, m;\nwhile( L - i }-} 1 ) {\nif( this[m = ((L + i)}-}}-}1)] {-{ v )\ni = m;\nelse\nL = m;\n}\nreturn L;\n}\nfunction getOrdinal( n ) {\nvar s = ['th', 'st', 'nd', 'rd'], v = n%100;\nreturn n + (s[(v-20)%10]||s[v]||s[0]);\n}\nfunction byte2Hex(n) {\nvar nybHexString = \"0123456789ABCDEF\";\nreturn String(nybHexString.substr((n }-}}-} 4) & 0x0F,1)) + nybHexString.substr(n & 0x0F,1);\n}\nfunction RGB2Color(r,g,b) {\nreturn '#' + byte2Hex(r) + byte2Hex(g) + byte2Hex(b);\n}\nfunction makeColorGradient(frequency1, frequency2, frequency3,\nphase1, phase2, phase3,\ncenter, width, len)\n{\nif (len == undefined)      len = 50;\nif (center == undefined)   center = 128;\nif (width == undefined)    width = 127;\nvar grad = [];\nfor (var i = 0; i {-{= len; ++i)\n{\nvar red = Math.sin(frequency1*i + phase1) * width + center;\nvar grn = Math.sin(frequency2*i + phase2) * width + center;\nvar blu = Math.sin(frequency3*i + phase3) * width + center;\ngrad.push( RGB2Color(red,grn,blu) );\n}\nreturn grad.slice(1);  \n}\nvar colors = makeColorGradient(2.4,2.4,2.4,0,2,4,128,127,500);\nvar catList = [];\nfunction dataProlog() {\nif( payload ) { for( v in payload ) window[v] = payload[v]; payload = null; }\ncategoryCur = null;\nfor( var i = 0; i {-{ catDetails.length; ++i ) {\nif( catDetails[i].name == 'All' )\ncontinue;\nvar cat = catDetails[i];\nfor( var p = 0; p {-{ cat.pos.length; ++p ) {\nif( cat.pos[p] == bib ) {\ncat.place = (p+1) + '/' + cat.pos.length;\ncat.iCat = i;\ncatList.push( cat );\nif( !categoryCur || cat.pos.length {-{ categoryCur.pos.length )\ncategoryCur = cat;\nbreak;\n}\n}\n}\ncatList.sort( function(x, y) { return x.pos.length - y.pos.length || x.iCat - y.iCat; } );\ndocument.getElementById( 'idRaceName' ).innerHTML = raceName;\n}\nfunction GetName( bib ) {\nvar d = data[bib];\nif( !d )\treturn '';\nif( d.LastName && d.FirstName )\treturn d.FirstName + ' ' + d.LastName;\nreturn d.LastName || d.FirstName || '';\n}\nfunction GetBibName( bib ) {\nreturn bib + ': ' + GetName(bib);\n}\nfunction GetDateFromSecs( t ) {\nvar secs = ~~t;\nvar h = ~~(secs / (60*60));\nvar m = (~~(secs / 60) % 60);\nvar s = ~~(secs % 60);\nvar ms = (t - secs) * 1000.0;\nreturn new Date( 0, 0, 0, h, m, s, ms );\n}\nfunction FormatTimeHMS( t, highPrecision )\n{\nvar tStr = '';\nif( t {-{ 0 )\n{\ntStr = '-';\nt = -t;\n}\nvar secs = ~~t;\nvar h = ~~(secs / (60*60));\nvar m = (~~(secs / 60) % 60);\nvar s = (~~(secs % 60) + t - secs).toFixed( highPrecision ? 3 : 0 );\nif( h }-} 0 )\ntStr += h + 'h' + (m{-{10?'0':'') + m + 'm' + (s{-{10?'0':'') + s + 's';\nelse if( m }-} 0 )\ntStr += m + 'm' + (s{-{10?'0':'') + s + 's';\nelse\ntStr += s + 's';\nreturn tStr;\n}\nfunction FormatTime( t, highPrecision )\n{\nvar tStr = '';\nif( t {-{ 0 )\n{\ntStr = '-';\nt = -t;\n}\nvar secs = ~~t;\nvar h = ~~(secs / (60*60));\nvar m = (~~(secs / 60) % 60);\nvar s = (~~(secs % 60) + t - secs).toFixed( highPrecision ? 3 : 0 );\nif( h }-} 0 )\ntStr += h + (m {-{ 10 ? ':0' : ':') + m + (s {-{ 10 ? ':0' : ':') + s;\nelse\ntStr += m + (s {-{ 10 ? ':0' : ':') + s;\nreturn tStr;\n}\nfunction FormatTimeGap( t, highPrecision ) {\nvar tStr = '';\nif( t {-{ 0 )\n{\ntStr = '-';\nt = -t;\n}\nvar secs = ~~t;\nvar h = ~~(secs / (60*60));\nvar m = (~~(secs / 60) % 60);\nvar s = (~~(secs % 60) + t - secs).toFixed( highPrecision ? 3 : 0 );\nif( h }-} 0 )\ntStr += h + (m {-{ 10 ? 'h0' : 'h') + m + (s {-{ 10 ? \"'0\" : \"'\") + s;\nelse\ntStr += m + (s {-{ 10 ? \"'0\" : \"'\") + s;\ntStr += '\"';\nreturn tStr;\n}\nfunction FormatDistanceGap( d, distanceUnit ) {\nvar suffix = 'behind';\nif( d {-{ 0 ) {\nd *= -1;\nsuffix = 'ahead';\n}\nif( distanceUnit == 'km' ) {\nif( d {-{ 0.1 )\nreturn (d*1000.0).toFixed(1) + ' m ' + suffix;\nreturn d.toFixed(1) + ' ' + distanceUnit + ' ' + suffix;\n}\nelse {\nif( d {-{= 0.1 )\nreturn (d*5280.0).toFixed(0) + ' ft ' + suffix;\nreturn d.toFixed(1) + ' ' + distanceUnit + ' ' + suffix;\n}\n}\nfunction getPositionByLap( bibIn ) {\nvar timeLapPosBib = [];\nfor( var i = 0; i {-{ categoryCur.pos.length; ++i ) {\nvar bibCur = categoryCur.pos[i];\nvar d = data[bibCur];\nfor( var r = 1; r {-{ d.raceTimes.length; ++r )\ntimeLapPosBib.push( {time:d.raceTimes[r] - d.raceTimes[0], lap:r, pos:i, bib:bibCur} );\n}\nif( timeLapPosBib.length == 0 )\nreturn [];\ntimeLapPosBib.sort( function(x, y) {return (x.time - y.time) || (y.lap - x.lap) || (x.pos - y.pos);} );\nvar positionByLap = [];\nvar competitorCount = categoryCur.pos.length;\nvar seenLeader = {}; seenLeader[timeLapPosBib[0].bib] = true;\nfor( var i = 0; i {-{ timeLapPosBib.length; ++i ) {\nvar bibCur = timeLapPosBib[i].bib;\nif( !seenLeader[bibCur] ) {\nseenLeader[bibCur] = true;\ncontinue;\n}\nseenLeader = {}; seenLeader[bibCur] = true;\nvar seen = {};\nvar positionThisLap = [];\nfor( var j = i; j {-{ timeLapPosBib.length && positionThisLap.length {-{ competitorCount; ++j ) {\nvar bibCur = timeLapPosBib[j].bib;\nif( !seen[bibCur] ) {\npositionThisLap.push( timeLapPosBib[j] );\nseen[bibCur] = true;\n}\n}\npositionThisLap.sort( function(x, y) {return (y.lap - x.lap) || (x.time - y.time) || (x.pos - y.pos);} );\ncompetitorCount = positionThisLap.length;\nfor( var j = 0; j {-{ positionThisLap.length; ++j ) {\nif( positionThisLap[j].bib == bibIn ) {\npositionByLap.push( j + 1 );\nbreak;\n}\n}\n}\nreturn positionByLap;\n}\nfunction updateCategories() {\nvar categorySelect = document.getElementById( 'idCategorySelect' );\ncategorySelect.innerHTML = '';\ncategoryCur = null;\nfor( var i = 0; i {-{ catList.length; ++i ) {\nvar cat = catList[i];\nif( !categoryCur )\ncategoryCur = cat;\nvar op = document.createElement( 'option' );\nop.value = i;\nop.text = cat.name;\nop.selected = (cat == categoryCur ? true : false);\ncategorySelect.add( op );\n}\nupdateCompare();\n}\nfunction updateCategoryResults() {\nvar d = data[bib];\nvar cr = [];\nfor( var i = 0; i {-{ catList.length; ++i ) {\ncr.push( '{-{strong}-}' + catList[i].place + '{-{/strong}-} in ' + catList[i].name );\n}\ncr.push( '{-{br/}-}{-{br/}-}' );\nif( d.status == 'Finisher' && d.raceTimes && d.raceTimes.length }-}= 2 ) {\nvar s = 'Finished in ' + FormatTimeHMS(d.raceTimes.back() - d.raceTimes[0], true);\nif( d.speed )\ns += ' at ' + d.speed;\ncr.push( s );\n}\nelse if( d.status != 'Finisher' )\ncr.push( d.status );\ndocument.getElementById( 'idCategoryResults' ).innerHTML = 'Placed: ' + cr.join('&nbsp;&nbsp;&nbsp;');\n}\nfunction categorySelectChange( select ) {\ncategoryCur = catList[select.options[select.selectedIndex].value];\nupdateCompare();\nupdateCompareDisplays();\n}\nfunction updateCompare() {\nvar categorySelect = document.getElementById( 'idCategorySelect' );\nvar compareSelect = document.getElementById( 'idCompareSelect' );\ncompareSelect.innerHTML = '';\nbibRef = null;\nvar iBib = null;\nfor( var i = 0; i {-{ categoryCur.pos.length; ++i ) {\nvar bibCur = categoryCur.pos[i];\nif( bibCur == bib ) {\niBib = i;\ncontinue;\n}\nif( !bibRef )\nbibRef = bibCur;\nvar d = data[bibCur];\nif( !(d.raceTimes && d.raceTimes.length }-}= 2) )\ncontinue;\nif( !(i {-{ 20 || (iBib != null && (iBib-3 {-{ i || i {-{ iBib+2))) )\ncontinue;\nvar op = document.createElement( 'option' );\nop.value = bibCur;\nop.text = (i+1) + '.  ' + GetName(bibCur);\ncompareSelect.add( op );\n}\n}\nfunction compareSelectChange( select ) {\nbibRef = null;\nif( select.options.length )\nbibRef = select.options[select.selectedIndex].value;\nupdateCompareDisplays();\n}\nfunction updateLapTable() {\nvar container = document.getElementById( 'idLapTable' );\nif( !container.table )\ncontainer.table = new google.visualization.Table( container );\nvar spacer = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';\nvar d = data[bib];\nvar hasSpeed = (d.speed && d.lapSpeeds && d.lapSpeeds.length }-} 0);\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'number', 'Lap' );\ndataTable.addColumn( 'number', 'Lap Time' );\ndataTable.addColumn( 'number', 'Race Time' + (!hasSpeed ? spacer : '') );\nif( hasSpeed )\ndataTable.addColumn( 'number', 'Lap Speed' + ' (' + d.speed.split(' ')[1] + ')' + spacer );\nfor( var r = 1; r {-{ d.raceTimes.length; ++r ) {\nvar lapTime = d.raceTimes[r] - d.raceTimes[r-1];\nvar raceTime = d.raceTimes[r] - d.raceTimes[0];\nvar row = [r, { v:lapTime, f:FormatTime(lapTime, true) }, { v:raceTime, f:FormatTime(raceTime, true) + (!hasSpeed ? spacer : '') }];\nif( hasSpeed )\nrow.push( { v:d.lapSpeeds[r-1], f:d.lapSpeeds[r-1].toFixed(2) + spacer } );\ndataTable.addRow( row );\n}\nvar options = {allowHtml: true};\nif( dataTable.getNumberOfRows() }-} 10 )\noptions['page'] = 'enable';\ncontainer.table.draw( dataTable, options );\n}\nfunction GetGap( bib, bibRef ) {\nvar d = data[bib], dRef = data[bibRef];\nif( !d || !dRef || !d.raceTimes || !dRef.raceTimes || d.raceTimes.length==0 || dRef.raceTimes.length==0 )\nreturn {v:0, f:''};\nif( d.raceTimes.length != dRef.raceTimes.length ) {\nvar lapsDown = dRef.raceTimes.length - d.raceTimes.length;\nreturn {v:lapsDown*1000.0*60.0*60.0, f:-lapsDown + (Math.abs(lapsDown) }-} 1 ? ' laps' : ' lap') + (lapsDown {-{ 0 ? ' more' : '')};\n}\nvar g = (d.raceTimes.back() - d.raceTimes[0]) - (dRef.raceTimes.back() - dRef.raceTimes[0]);\nreturn {v:g, f:FormatTimeGap(g)};\n}\nfunction GetGapDistance( bib, bibRef ) {\nvar d = data[bib], dRef = data[bibRef];\nif( !d || !dRef || !d.raceTimes || !dRef.raceTimes || d.raceTimes.length==0 || dRef.raceTimes.length==0 ||\n!d.speed )\nreturn {v:0, f:''};\nvar speedUnit = d.speed.split(' ')[1];\nvar distanceUnit = (speedUnit.substring(0,1) == 'm' ? 'miles' : 'km');\nvar distance = 0, t = 0;\nif( d.lapSpeeds && d.lapSpeeds.length }-} 0 ) {\nt = (d.raceTimes.back() - d.raceTimes.slice(-2,-1)[0]) / (60.0*60.0);\ndistance = t * d.lapSpeeds.back();\n}\nelse {\nt = (d.raceTimes.back() - d.raceTimes[0]) / (60.0*60.0);\ndistance = t * d.speed;\n}\nif( d.raceTimes.length != dRef.raceTimes.length ) {\nvar lapsDown = dRef.raceTimes.length - d.raceTimes.length;\nreturn {v:lapsDown*distance, f:FormatDistanceGap(lapsDown*distance,distanceUnit)};\n}\nvar g = ((d.raceTimes.back() - d.raceTimes[0]) - (dRef.raceTimes.back() - dRef.raceTimes[0])) / (60.0*60.0);\nvar distanceGap = (g / t) * distance;\nreturn {v:distanceGap, f:FormatDistanceGap(distanceGap, distanceUnit)};\n}\nfunction GetPlace( bib ) {\nfor( var i = 0; i {-{ categoryCur.pos.length; ++i )\nif( categoryCur.pos[i] == bib )\nreturn {v:i, f:(i+1) + '/' + categoryCur.pos.length};\nreturn '';\n}\nfunction GetTime( bib ) {\nvar d = data[bib];\nif( !d || !d.raceTimes || !d.raceTimes.length )\nreturn {v:0, f:''};\nvar t = d.raceTimes.back() - d.raceTimes[0];\nreturn {v:t, f:FormatTime(t, true) };\n}\nfunction GetEstimatedLapTime( bib ) {\nvar d = data[bib];\nif( !d || !d.raceTimes || d.raceTimes.length {-{ 2 )\nreturn 99999999999;\nif( d.raceTimes }-} 2 )\nreturn (d.raceTimes.back() - d.raceTimes[1]) / (d.raceTimes.length-2);\nreturn (d.raceTimes.back() - d.raceTimes[0]) / (d.raceTimes.length-1);\n}\nfunction GetPercentComparison( bib, bibRef ) {\nvar d = data[bib], dRef = data[bibRef];\nif( !d || !dRef || !d.raceTimes || !dRef.raceTimes || d.raceTimes.length {-{ 2 || dRef.raceTimes.length {-{ 2 )\nreturn {v:0, f:''};\nvar t = d.raceTimes.back() - d.raceTimes[0], tRef = dRef.raceTimes.back() - dRef.raceTimes[0];\nif( d.raceTimes.length {-{ dRef.raceTimes.length )\nt += GetEstimatedLapTime(bib) * (dRef.raceTimes.length - d.raceTimes.length);\nelse if( d.raceTimes.length }-} dRef.raceTimes.length )\ntRef += GetEstimatedLapTime(bibRef) * (d.raceTimes.length - dRef.raceTimes.length);\nvar p = 1.0 - t/tRef;\nreturn {v:p, f:(p == 0 ? '' : (Math.abs(p)*100).toFixed(1) + (p{-{0 ? '% slower' : p}-}0 ? '% faster' : ''))};\n}\nfunction updateInfoTable() {\nvar container = document.getElementById( 'idInfoTable' );\nif( !container.table )\ncontainer.table = new google.visualization.Table( container );\nvar d = data[bib];\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'Name' );\ndataTable.addColumn( 'number', 'Place' );\ndataTable.addColumn( 'number', 'Time' );\ndataTable.addColumn( 'number', 'Gap' );\nif( d.speed ) {\ndataTable.addColumn( 'number', 'Est. Distance' );\ndataTable.addColumn( 'number', 'Avg Speed' + ' (' + d.speed.split(' ')[1] + ')' );\n}\ndataTable.addColumn( 'number', 'Comparison' );\nfor( var i = 0; i {-{ 2; ++i ) {\nvar bibCur = (i == 0 ? bib : bibRef);\nvar gap = (i != 0 ? {v:0,f:''} : GetGap(bib, bibRef));\nvar riderName = GetName(bibCur);\nvar d = data[bibCur];\nvar row = [ GetName(bibCur), GetPlace(bibCur), GetTime(bibCur), gap];\nif( d.speed ) {\nrow.push( i != 0 ? {v:0,f:''} : GetGapDistance(bib, bibRef) );\nvar s = parseFloat(d.speed.split(' ')[0]);\nrow.push( {v:s, f:s.toFixed(2)} );\n}\nrow.push( GetPercentComparison(bibCur, bibRef) );\ndataTable.addRow( row );\n}\ncontainer.table.draw( dataTable );\n}\nfunction updateGanttChart() {\nvar container = document.getElementById( 'idGanttChart' );\nif( !container.chart )\ncontainer.chart = new google.visualization.Timeline( container );\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'Rider' );\ndataTable.addColumn( 'string', 'Lap' );\ndataTable.addColumn( 'date', 'Start' );\ndataTable.addColumn( 'date', 'End' );\nvar maxLaps = 0;\nfor( var i = 0; i {-{ 2; ++i ) {\nvar bibCur = (i == 0 ? bib : bibRef);\nvar riderName = GetName(bibCur);\nvar d = data[bibCur];\nif( !d.raceTimes )\ncontinue;\nvar tLast = 0.0\nmaxLaps = Math.max( maxLaps, d.raceTimes.length );\nfor( var r = 1; r {-{ d.raceTimes.length; ++r ) {\nvar tNext = tLast + d.raceTimes[r] - d.raceTimes[r-1];\ndataTable.addRow( [\nriderName,\n'Lap ' + r,\nGetDateFromSecs(tLast),\nGetDateFromSecs(tNext)] );\ntLast = tNext;\n}\n}\nvar options = {\ncolors: colors.slice( maxLaps+1 ),\n};\ncontainer.chart.draw( dataTable, options );\n}\nvar numLabels = 4;\nfunction getTimeTicks( tMin, tMax, tFormat ) {\nvar d = (tMax - tMin) / numLabels;\nvar intervals = [0.01,0.05,0.1,0.2,0.5, 1, 2, 5, 10, 15, 20, 30, 1*60, 2*60, 5*60, 10*60, 15*60, 20*60, 30*60, 1*60*60, 2*60*60, 4*60*60, 8*60*60, 12*60*60, 24*60*60, 2*24*60*60, 5*24*60*60, 10*24*60*60, 20*24*60*60, 50*24*60*60 ];\nd = intervals[intervals.binSearch(d)];\nvar dMin = Math.floor(tMin / d) * d, dMax = Math.floor(tMax / d + 1) * d;\nvar ticks = [];\nfor( var t = dMin; t {-{= dMax; t += d )\nticks.push( {v:t, f:tFormat=='hms' ? FormatTimeHMS(t, d{-{1) : tFormat=='gap' ? FormatTimeGap(t, d{-{1) : FormatTime(t,d{-{1)} );\nreturn ticks;\n}\nfunction getPositionTicks( pMin, pMax ) {\nvar d = (pMax - pMin) / numLabels;\nvar intervals = [1, 2, 5, 10, 20, 25, 50, 100, 200, 500, 1000, 2000, 5000, 10000, 20000, 50000, 100000];\nd = intervals[intervals.binSearch(d)];\nvar dMin = Math.max(1, Math.floor(pMin / d) * d), dMax = Math.floor(pMax / d) * d;\nif( dMax {-{ pMax )\ndMax += d;\nvar ticks = [];\nfor( var p = dMin; p {-{= dMax; p += d )\nticks.push( {v:p, f:getOrdinal(p)} );\nreturn ticks;\n}\nfunction updateLapTimesChart() {\nvar container = document.getElementById( 'idLapTimesChart' );\nif( !container.chart )\ncontainer.chart = new google.visualization.LineChart( container );\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'Lap' );\ndataTable.addColumn( 'number', GetName(bib) );\nif( bibRef )\ndataTable.addColumn( 'number', GetName(bibRef) );\nvar dRef = data[bibRef];\nvar d = data[bib];\nvar tMin = 999999999, tMax = 0.0;\nvar rMax = Math.min(dRef.raceTimes.length, d.raceTimes.length);\nfor( var r = 1; r {-{ rMax; ++r ) {\nvar row = [\n'' + r,\n{\tv:r {-{ d.raceTimes.length ? d.raceTimes[r] - d.raceTimes[r-1] : 0,\nf:FormatTimeHMS(r {-{ d.raceTimes.length ? d.raceTimes[r] - d.raceTimes[r-1] : 0)\n}\n];\nif( bibRef )\nrow.push( {\tv:dRef.raceTimes[r] - dRef.raceTimes[r-1],\nf:FormatTimeHMS(dRef.raceTimes[r] - dRef.raceTimes[r-1]) } );\nfor( var k = 1; k {-{ row.length; ++k ) {\ntMin = Math.min( tMin, row[k].v );\ntMax = Math.max( tMax, row[k].v );\n}\ndataTable.addRow( row );\n}\nvar timeTicks = getTimeTicks( tMin, tMax, 'hms' );\nvar options = {\ntitle: 'Lap Times',\nvAxis: {\ntitle: \"lap time\",\nticks:timeTicks,\nviewWindow:{ min:timeTicks[0].v, max:timeTicks.back().v }\n},\nhAxis: {title: \"lap\"},\ncolors: ['blue', '#8888FF'],\npointSize: 5,\nchartArea: {left: '10%', width: '70%'},\nanimation: {duration: 250},\n};\ncontainer.chart.draw( dataTable, options );\n}\nfunction updateGapChart() {\nvar container = document.getElementById( 'idGapChart' );\nif( !container.chart )\ncontainer.chart = new google.visualization.LineChart( container );\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'Lap' );\ndataTable.addColumn( 'number', 'Gap' );\nvar dRef = data[bibRef];\nvar d = data[bib];\nvar tMin = 999999999, tMax = 0.0;\nvar rMax = Math.min(dRef.raceTimes.length, d.raceTimes.length);\nfor( var r = 1; r {-{ rMax; ++r ) {\nvar ab = bibRef ? (d.raceTimes[r] - d.raceTimes[0]) - (dRef.raceTimes[r] - dRef.raceTimes[0]) : 0.0;\ntMin = Math.min( tMin, ab );\ntMax = Math.max( tMax, ab );\ndataTable.addRow( [ '' + r, {v: ab, f: FormatTimeHMS(ab)} ] );\n}\nvar timeTicks = getTimeTicks( tMin, tMax, 'gap' );\nvar options = {\ntitle: 'Gap: ' + GetName(bib) + ' \\u21E8 ' + GetName(bibRef),\nvAxis: {\ntitle: \"gap\",\nticks:timeTicks,\nviewWindow:{min:timeTicks[0].v, max:timeTicks.back().v}\n},\nhAxis: {title: \"lap\"},\ncolors: ['blue'],\nlegend: 'none',\npointSize: 5,\nchartArea: {left: '10%', width: '70%'},\nanimation: {duration: 250},\n};\ncontainer.chart.draw( dataTable, options );\n}\nfunction updateLapPositionChart() {\nvar container = document.getElementById( 'idLapPositionChart' );\nif( !container.chart )\ncontainer.chart = new google.visualization.LineChart( container );\nvar pos1 = getPositionByLap( bib );\nvar pos2 = bibRef ? getPositionByLap( bibRef ) : [];\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'Lap' );\ndataTable.addColumn( 'number', GetName(bib) );\nif( bibRef )\ndataTable.addColumn( 'number', GetName(bibRef) );\nvar dLeader = data[bibRef];\nvar d = data[bib];\nvar positionMin = 999999, positionMax = 0;\nvar iMax = Math.min(pos1.length, pos2.length);\nfor( var i = 0; i {-{ iMax; ++i ) {\nvar row = [ '' + (i+1), pos1[i]];\npositionMin = Math.min(positionMin, pos1[i]);\npositionMax = Math.max(positionMax, pos1[i]);\nif( bibRef ) {\nrow.push( pos2[i] );\npositionMin = Math.min(positionMin, pos2[i]);\npositionMax = Math.max(positionMax, pos2[i]);\n}\ndataTable.addRow( row );\n}\ntickMarks = getPositionTicks( positionMin, positionMax );\nvar options = {\ntitle: 'Race Position by Lap',\nvAxis: {\ntitle: \"position\",\ndirection:-1,\nticks:tickMarks,\nminValue:positionMin,\nmaxValue:positionMax,\nviewWindow:{ min:tickMarks[0], max:tickMarks.back() }\n},\nhAxis: {title: \"lap\"},\ncolors: ['blue', '#8888FF'],\npointSize: 5,\nchartArea: {left: '10%', width: '70%'},\nanimation: {duration: 250},\n};\ncontainer.chart.draw( dataTable, options );\n}\nfunction updateCompareDisplays() {\nupdateInfoTable();\nupdateGanttChart();\nupdateLapTimesChart();\nupdateGapChart();\nupdateLapPositionChart();\n}\nfunction onLoad() {\ndataProlog();\nvar d = data[bib];\ndocument.getElementById('idHeader').innerHTML = GetBibName(bib) + (d.Team ? ' (' + d.Team + ')' : '');\nupdateCategoryResults();\nupdateCategories();\nupdateLapTable();\nupdateCompareDisplays();\n}\n{-{/script}-}\n{-{/head}-}\n{-{body}-}\n{-{h1 id=\"idHeader\"}-}{-{/h1}-}\n{-{h4 id=\"idRaceName\"}-}Race Name{-{/h4}-}\n{-{p id=\"idCategoryResults\"}-}Category Results{-{/p}-}\n{-{div id=\"idLapTable\"}-}{-{/div}-}\n{-{br/}-}\nCategory:&nbsp;{-{select id=\"idCategorySelect\" onchange=\"categorySelectChange(this)\"}-}{-{/select}-}&nbsp;&nbsp;&nbsp;&nbsp;Compare&nbsp;to:&nbsp;{-{select id=\"idCompareSelect\" onchange=\"compareSelectChange(this)\"}-}{-{/select}-}\n{-{br/}-}{-{br/}-}\n{-{div id=\"idInfoTable\"}-}{-{/div}-}\n{-{br/}-}\n{-{div id=\"idGanttChart\" style=\"width: 720px; height: 136px;\"}-}{-{/div}-}\n{-{div id=\"idLapTimesChart\" style=\"width: 900px; height: 180px;\"}-}{-{/div}-}\n{-{div id=\"idGapChart\" style=\"width: 900px; height: 180px;\"}-}{-{/div}-}\n{-{div id=\"idLapPositionChart\" style=\"width: 900px; height: 180px;\"}-}{-{/div}-}\n{-{a href=\"http://www.sites.google.com/site/crossmgrsoftware\" target=\"_blank\"}-}Powered by CrossMgr{-{/a}-}\n{-{/body}-}\n{-{/html}-}\n","raceIsFinished":true,"flags":{},"isTimeTrial":false,"hideDetails":true,"raceTimeZone":"","raceNameText":"The Dirty Nein","roadRaceFinishTimes":false};
/* !!! payload end !!! */
var raceName = null;
var organizer = null;
var timestamp = null;
var email = null;
var raceAddress = null;
var raceIsRunning = null;
var raceWasRunning = null;
var raceIsUnstarted = null;
var raceIsFinished = null;
var data = null;
var catDetails = null;
var isTimeTrial = null;
var winAndOut = null;
var catDetailsByName = {};
var lapDetails = null;
var hideDetails = null;		
var showDetails = false;	
var showCourseAnimation = true;
var version = null;
var raceNotes = null;
var primes = null;
var arrivalMode = null;
var mapMode = null;
var cycleCategoriesMode = null;
var catPosIndex = null;
var showCategorySummary = null;
var kioskMode = null;
var licenseLinkTemplate = null;
var flags = null;
var canvas = null;
var r = 100.0;				
var t = 0.0;				
var tLast = 0.0;			
var tDelta = 0.0;			
var tMax = 0.0;				
var laneMax = 8;			
var lapCur = 0;				
var framesPerSecond = 32;	
var speedup = 1.0;			
var categories = [];		
var categoryCur = 'All';	
var animationSeconds = 90;	
var suspendAnimation = false;	
var numsToWatchStr = null;	
var categoryStr = null;		
var numsToWatch = {};		
var resultsDiv = null;
var showLapsFrequency = -1;	
var lapDataOption = 0;		
var loopContinuously = true;
var fontMult = 1.0;			
var showTimeDecimals = false;
var displayUnits = 'km';
var reverseDirection = null;	
var finishTop = null;			
var tRace = null;				
var raceStartTime = null;		
var animationObj = null;		
var situationObj = null;
var lapChartObj = null;
var catUpdateTime = {};			
var rfid = null;				
var gpsPoints = null;			
var gpsTotalElevationGain = null;	
var gpsAltigraph = null;		
var gpsIsPointToPoint = null;	
var courseCoordinates = null;	
var courseViewerTemplate = null;
var travelMap = null;	
var infoFields = null;			
var langCur = null;				
var roadRaceFinishTimes = null;	
var gpsPointsTest =  [ ];
var checkeredFlag = new Image();
checkeredFlag.src =
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAgCAYAAAD5VeO1AAAEsklEQVRIibWVX0jTaxjHH//029lcVqvM0taNGUHNinGOnkGohJWtQ4KaFEVySlSSUixzTFwZxYnROv2ByisLgwqCIRRhF4EcKsjgeBrDgUqYDhvLJtoyt33OTZPCKLX83L0Xz+f78uV5eUVmiM/na/b7/TUznfsuL1++PM4nbt682V5VVbXkp4jLy8uP6/V6Hj58yPPnz1mwYAEGg2Hs6NGjuT8kttvtxuXLl4dFhNWrV3PhwgXi4uIQEaxW65jP58uflbijo2Phhw8f/m1tbSUpKYlnz54BcP/+fUpLSwmFQkQikbDX6z1ps9lipy222Wyxbre7LdpzU1MTPT09AHg8HrZs2YLb7QagsbGRnJyc/rq6Ov205Lt3725ftWoVT5484erVq4gIS5cuxel0YjQaERF0Oh3Xr1+frGnjxo3B3t5ewzfFTU1NtfPmzUNEKCgowGKxEBMTQ3x8PE6nk4aGBmJjYzGZTLx//57z58+jUqm4ceMGoVAo8ObNm+Kvint7ew0TExOBy5cvk5GRgc/nA+DWrVs4HI5oS7S0tEzWAnDt2jX8fj8Aw8PDrVPEJ06cSHv9+nUPwOjoKBUVFQwMDADgdDoxmUy8evWKjx8/snXrVtavX4/L5eLx48eo1WrS09Pp6OhwtbW1ab4QX7x4UTGZTENr166lq6uL/fv3IyLo9Xru3r2LTqdDRFixYgV2ux0RQUTIysqisrISESE1NTVcU1Pz+5RbHzt27EF04NSpU+zduxcRISUlBY/HQ1VVFSLCkSNHCIVCNDY2snjxYrq6uohEIpw9ezZ8+PDhyilir9d7IBQKcfr0afbs2UMkEgHAbrfz6NGjyV6vXLnCyMjI5PnMmTOMjo4SiUTwer1TxQ0NDcXv3r0bA+ju7ubgwYMEAgEA6urqyMvLY2hoiP7+flauXElmZiZ9fX2cO3cOEWHDhg08ffq0ZYq4trbWoNfrJ4xGIy9evMBgMCAiGAwGmpubiYmJQUTIyMigoqJisueysjJ27tyJiJCZmemvrq7+ZYr8D7O5Mz4+HkVRuHfv3uRATk4Ob9++Zd++fcTFxXHnzh2CwSBlZWVs2rSJkZERJiYmsFqtfovFsm6KWETEYDBo8rdt++fSpUtBgHA4jM1mY3Bw8Iuew+FwdH+pr69nfHycUCg05vF4fv2q+HN27dp1cnBwcGB8fJzs7GwKCwsZHh6mvb0dRVEwm834fD4KCgoQETZv3ozL5TrwXXGU34zG/Jrqam+018LCQnJzcyd7djgcmEwmRISioqKOaYuj6HS6VLPZ3JeSkkJ3dzeBQIDi4mIOHToEQDAYpL6+/j+bzRY/Y7mIyPbt25U/S0tvj42NDQN0dnZisVgIh8MEg0GX2+3WzUr8OTt27Kjt7OwcSEtLQ0QoKSkZd7vdX9+M2bBmzZrsvLw8v6IolJeXW3+aOEpycvISU1bWg/nz56f/dPknYrUajUWjUpnnKkC0anWhWlGOFxUVTf8zngmLtNp1apXKISIL5yZg0aLEBLXasTAh4duf8Y+QoFbXqBWlZM4CEjWafK1GYxWR2b3a7wYkJqapVaq/tVpt0pwELFu2TJOgVv8lIskiIv8DQ4HqhmfkzxMAAAAASUVORK5CYII=";
var colours = [
'rgb(255, 0, 0)',
'rgb(0, 0, 255)',
'rgb(255, 255, 0)',
'rgb(255, 0, 255)',
'rgb(0, 255, 255)'
];
var topThreeColours = [
'rgb(255,215,0)',
'rgb(230,230,230)',
'rgb(205,133,63)',
'rgb(128,128,128)',
'rgb(128,128,128)'
];
function isCanvasSupported() {
var elem = document.createElement('canvas');
return !!(elem.getContext && elem.getContext('2d'));
}
var canvasSupported = true;
Array.prototype.back = function() {
return this[this.length-1];
};
Array.prototype.binSearch = function( v ) {
var L = this.length, i = -1, m;
while( L - i > 1 )
{
if( this[m = ((L + i)>>1)] < v )
i = m;
else
L = m;
}
return L;
}
Array.prototype.swap = function( x, y ) {
var tmp = this[x];
this[x] = this[y];
this[y] = tmp;
}
String.prototype.escapeHTML = function ()
{                                        
var r =                                                               
this.replace(/&/g,'&amp;').
replace(/>/g,'&gt;').
replace(/</g,'&lt;').
replace(/"/g,'&quot;').
replace(/'/g,'&rsquo;');
return r;
};
String.prototype.escapeID = function() {
return this.replace(/[&<>"'(){}\[\]!@#$%^* ]/g,'_');
};
function encode_utf8( s ) {
return unescape( encodeURIComponent(s) );
}
function decode_utf8( s ) {
return decodeURIComponent( escape(s) );
}
function isEmptyObject( obj ) {
for ( var name in obj ) {
return false;
}
return true;
}
var hidden, visibilityChange; 
if (typeof document.hidden !== "undefined") { 
hidden = "hidden";
visibilityChange = "visibilitychange";
} else if (typeof document.mozHidden !== "undefined") {
hidden = "mozHidden";
visibilityChange = "mozvisibilitychange";
} else if (typeof document.msHidden !== "undefined") {
hidden = "msHidden";
visibilityChange = "msvisibilitychange";
} else if (typeof document.webkitHidden !== "undefined") {
hidden = "webkitHidden";
visibilityChange = "webkitvisibilitychange";
}
var flagImages = null;
function GetFlagImage( uci ) {
if( !flagImages ) {
if( !flags )
return null;
flagImages = {};
for( var cc in flags ) {
img = new Image();
img.src = flags[cc];
img.className = 'flag';
flagImages[cc] = img;
}
}
return flagImages[uci.substring(0, 3)];
}
var translations = {
'languageCode':	['en',				'fr',					'es'],
'language':		['English',			'Franais',				'Espaol'],
'hello':		['Hello!',			'Bonjour!',				'Hola!'],
'Email Comments/Suggestions': ['Email Comments/Suggestions', 'Email Commentaires/Suggestions', 'E-mail Comentarios/Sugerencias'],
'Powered by':	['Powered by',		'Propuls par',			'Desarrollado por'],
'created':		['created',			'cr',					'creada'],
'Refresh':		['Refresh',			'Actualiser',			'Actualizar'],
'by':			['by',				'par',					'por'],
'at':			['at',				'',					'en'],
'miles':		['miles',			'miles',				'millas'],
'Gap':			['Gap',				'cart',				'Lapso'],
'Name':			['Name',			'Nom',					'Nombre'],
'LastName':		['Last Name',		'Dernier nom',			'Apellido'],
'FirstName':	['First Name',		'Prnom',				'Nombre'],
'Team':			['Team',			'quipe',				'Equipo'],
'Category':		['Category',		'Catgorie',			'Categoria'],
'Nat.':			['Nat.',			'Nat.',					'Nac.'],
'State':		['State',			'tat',					'Estado'],
'Prov.':		['Prov.',			'Prov.',				'Prov.'],
'City':			['City',			'Ville',				'Ciudad'],
'License':		['License',			'Licence',				'Licencia'],
'Age':			['Age',				'ge',					'Edad'],
'Time':			['Time',			'Temps',				'Tiempo'],
'Lap':			['Lap',				'Tour',					'Vuelta'],
'lap':			['lap',				'tour',					'vuelta'],
'laps':			['laps',			'tours',				'vueltas'],
'laps of':		['laps of',			'tours de',				'vueltas de'],
'Laps of':		['laps of',			'tours de',				'vuelta de'],
'Laps to go':	['laps to go',		'tours  faire',		'vueltas antes de la meta'],
'to go':		['to go',			' faire',				'antes de la meta'],
'of':			['of',				'de',					'de'],
'1st lap':		['1st lap',			'premier tour',			'primera vuelta'],
'more laps of':	['more laps of',	'tours de plus de',		'vueltas ms de'],
'Estimated':	['Estimated',		'Estim',				'Estimado'],
'Distance':		['distance',		'la distance',			'la distancia'],
'Start':		['start',			'au dbut',				'el comienzo'],
'ClockStartTime':	['Clock Start',		"Heure de dbut",	'Inicio reloj'],
'ClockFinishTime':	['Clock Finish',	"Heure d'arrives",	'Acadabo reloj'],
'StartTime':	['Stopwatch Start',	"Premier chrono",		'Primero tiempo'],
'FinishTime':	['Stopwatch Stop',	"Deuxime chrono",		'Segundo tiempo'],
'ByFinishers':	['Show by Finishers',"Afficher par des arrives","Mostrado de finalistas"],
'CycleCategories':	['Cycle Categories',"Faites dfiler les catgories .","Puede cambiar entre las categoras."],
'Winner':		['winner',			'gagnant',				'ganador'],
'starters':		['starters',		'entres',				'aperitivos'],
'finishers':	['finishers',		'arrives',				'finalistas'],
'registered':	['registered',		"inscrit",				"registrado"],
'Show 100s of Seconds': ['Show 100s of Seconds', 'Afficer 100s de seconds', 'Mostrar 100s de segundos'],
'Hide Lap Info':['Hide Lap Info',	'Masquer les infos de tour',	'Ocultar la info de vuelta'],
'Show Every Lap':['Show Every Lap',	'Afficher tous les tours', 'Mostrar todas las vueltas'],
'Show Every {} Laps': ['Show Every {} Laps','Afficher tous les {} tours', 'Mostrar cada {} vueltas'],
'Show:':		['Show:',			'Afficher:',			'Mostrar:'],
'All':			['All',				'Tous',					'Todo'],
'Lap Times':	['Times',			'Temps',				'Tiempos'],
'Race Times':	['Race Times',		'Temps de course',		'Tiempos de carrera'],
'Race Time':	['Race',			'Temps de la course',		'Tiempo de carrera'],
'Time Gaps':	['Gaps',			"carts",				'Diferencia'],
'Gap Percents':	['Percent',			'Pour cent',			'Ciento'],
'Lap Speed':	['Speed',			'Vitesse',				'Velocidad'],
'Projected Time':['Projected Time',	'Temps prvu',			'Tiempo projectada'],
'Est. Distance Gap': ['Est. Distance',	"Distance est.", 		'Est. distancia'],
'Race Chart':	['Race Chart',		'Tableau de la course',		'Tabla de carrera'],
'Race Position':	['Race Position',	'Position de course',		'Posicin de carrera'],
'Show Start Offsets':	['Show Start Offsets',	'Afficher commencer dcalages',	'Mostrar empezar a desplazamientos'],
'Show Details':	['Show Details',	'Afficher les dtails',	'Mostrar los detalles'],
'Race Lightning':	['Race Lightning',		"clair de course",	'Rayo de carrera'],
'Loop Continuously':['Loop Continuously',	'Boucle continue',	'Repetir continuamente'],
'Playback Speed':['Playback Speed',	'Vitesse de lecture',		'Velocidad de reproduccin'],
'Units:':		['Units:',			'Units:',					'Unidades:'],
'Play':			['Play',			'Lecture',					'Reproducir'],
'Rewind':		['Rewind',			'Rembobinez',				'Rebobinar'],
'Stop':			['Stop',			'Stop',						'Detener'],
'Size':			['Size',			'Taille',					'Ramao'],
'Text':			['Text',			'Texte',					'Texto'],
'Highlight Numbers': ['Highlight Numbers', 'Numros de souligner', 'Nmeros de relieve'],
'Track':		['Oval Track',		'Piste oval',				'Pista ovalada'],
'GPX':			['GPX Course',		'GPX',						'GPX'],
'Apply':		['Apply',			'Appliquer',				'Aplicar'],
'Chip Timing':	['Chip Timing',		'RFID Chronomtrage',		'Cronometraje RFID'],
'Google Earth Ride': ['See Course on Google Earth', 'Montrez cours sur Google Earth', 'Mostrar curso en Google Earth'],
'Course Map': 	['See Course on Google Maps', "Montrez cours sur Google Maps", "Mostrar curso en Google Maps"],
'Participant Map':['Participant Map', 'Carte des participants', 'Maps de los participantes'],
'Get Directions':['Get Directions',	"Obtenir un itinraire",	"Cmo llegar"],
'Total':		['Total',			'Gain',						'Ganancia'],
'Elevation':	['Elevation',		'total',					'total'],
'Gain':			['Gain',			"d'altitude",				'de la elevacin'],
'time penalty':	['time penalty',	"pnalit de temps",		"penalizacin de tiempo"],
'Factor':		['Factor%',			'Facteur%',					'Factor%'],
'ElapsedTime':	['ElapsedTime',		'Chrono',					'Tiempo transcurrido'],
'TimeSlider':	['Time Slider',		'Curseur de temps',			'Deslizador de tiempo'],
'TimeSliderInstructions':	['Slide to Change Time', "Faites glisser pour changer Temps", "Deslice para cambiar Tiempo"],
'ClickGroupInstructions':	['Click Group for Details', "Cliquez sur Groupe pour plus de dtails", "Haga clic en Grupo para detalles"],
'Situation':	['Situation',		'Situation',				'Situacin'],
'Leaders':		['Leaders',			'Tte',						'Cabeza'],
'Chase Group':	['Chase Group',		'Chase',					'Caza'],
'LapsDown':		['Laps Down',		'Rours de retard',			'Vueltas atrs'],
'CategorySummary':	['Category Summary',"Catgorie rsum",			"Resumen de la categora"],
'ShowCategorySummary':['Show Category Summary',"Afficher le catgorie rsum",	"Mostrar el resumen de la categora"],
'Sponsor':		['Sponsor',			"Promoteur",				"Patrocinador"],
'Cash':			['Cash',			"Argent",					"Dinero"],
'Merchandise':	['Merchandise',		"Marchendise",				"Mercanca"],
'Lapped':		['Lapped',			"Doubls",					"Doblados"],
'race in progress':	['race in progress - results unofficial', "course en cours - rsultats non officiels",	"carrera en curso - resultados extraoficiales"],
'last':			['','','']
};
(function() {
var key = 'Show Every {} Laps';
var showLaps = [2, 3, 5, 10, 15, 20, 25, 50, 100];
var showTr = translations[key];
for( var i = 0; i < showLaps.length; ++i ) {
var tr = [];
for( var j = 0; j < showTr.length; ++j )
tr.push( showTr[j].replace('{}', showLaps[i]) );
translations[key.replace('{}', showLaps[i])] = tr;
}
})();
function _( f ) {
var t = translations[f];
return t ? t[langCur] : f;
}
function ordinal( value ) {
value = parseInt( value );
if( langCur == 1 ) return value == 1 ? (value+'er') : (value+'e');
if( langCur == 2 ) return value + '.&#xb0;';
if( Math.floor((value % 100)/10) != 1 )
return value + ['th','st','nd','rd','th','th','th','th','th','th'][value%10];
return value + "th";
}
var degreesToRadians = Math.PI / 180.0;
var radiansToDegrees = 180.0 / Math.PI;
function GreatCircleDistance( lat1, lon1, lat2, lon2 )
{
lon1 *= degreesToRadians;
lat1 *= degreesToRadians;
lon2 *= degreesToRadians;
lat2 *= degreesToRadians;
var dlon = lon2 - lon1;
var dlat = lat2 - lat1;
var a = Math.pow(Math.sin(dlat/2),2) + Math.cos(lat1) * Math.cos(lat2) * Math.pow(Math.sin(dlon/2),2);
var c = 2.0 * Math.asin(Math.sqrt(Math.max(a, 0.0)));
var m = 6371000.0 * c;
return m;
}
function CompassBearing( lat1, lon1, lat2, lon2 )
{
lat1 *= degreesToRadians;
lat2 *= degreesToRadians;
var diffLong = (lon2 - lon1) * degreesToRadians;
var x = Math.sin(diffLong) * Math.cos(lat2);
var y = Math.cos(lat1) * Math.sin(lat2) - (Math.sin(lat1) * Math.cos(lat2) * Math.cos(diffLong));
var bearing = Math.atan2(x, y) * radiansToDegrees;
while( bearing < 0.0 )
bearing += 360.0;
return bearing;
}
function GetLapRatio( leaderRaceTimes, tCur, iLapHint )
{
var maxLaps = leaderRaceTimes.length - 1;
if( maxLaps < 1 )
return [0, 0.0];
if( 0 <= iLapHint && iLapHint < maxLaps &&
leaderRaceTimes[iLapHint] <= tCur && tCur < leaderRaceTimes[iLapHint+1] ) {
lapRatio = (tCur - leaderRaceTimes[iLapHint]) / (leaderRaceTimes[iLapHint + 1] - leaderRaceTimes[iLapHint]);
}
else if( tCur <= leaderRaceTimes[0] ) {
iLapHint = 0;
lapRatio = 0.0;
}
else if ( tCur >= leaderRaceTimes.back() ) {
iLapHint = maxLaps - 1;
lapRatio = 1.0;
}
else {
iLapHint = Math.max( 0, Math.min(maxLaps, iLapHint) );
for( iLapHint = (leaderRaceTimes[iLapHint] < tCur ? iLapHint+1 : 0); iLapHint < maxLaps; ++iLapHint ) {
if( leaderRaceTimes[iLapHint] <= tCur )
break;
}
lapRatio = (tCur - leaderRaceTimes[iLapHint]) / (leaderRaceTimes[iLapHint + 1] - leaderRaceTimes[iLapHint]);
}
return [iLapHint, lapRatio];
}
function doReload( forceRefresh ) {
if( !forceRefresh )
return RefreshPayload();
var params = [
'raceCat=' + encodeURIComponent(encode_utf8(categoryCur)),
'highlight=' + document.getElementById('idNumsToWatch').value,
'lang=' + getLanguageCode()
];
if( cycleCategoriesMode )
params.push( 'cycleCategoriesMode=t' );
if( showCategorySummary )
params.push( 'showCategorySummary=t' );
if( arrivalMode )
params.push( 'arrivalMode=t' );
if( mapMode )
params.push( 'mapMode=t' );
if( kioskMode )
params.push( 'kioskMode=t' );
var href = window.location.href;
var qMark = href.indexOf( '?' );
if( qMark != -1 )
href = href.substring( 0, qMark );
href += '?' + params.join('&');
CloseWebSocket();
if( window.location.href != href )
window.location.href = href;
else
window.location.reload( true );
}
var reloadTriggered = false;
function TriggerReload( leaderRaceTimes, tCur, iLapHint )
{
if( !raceIsRunning || reloadTriggered )
return;
var maxLaps = leaderRaceTimes.length - 1;
if( maxLaps < 1 )
return;
if( 0 <= iLapHint && iLapHint < maxLaps &&
leaderRaceTimes[iLapHint] <= tCur && tCur < leaderRaceTimes[iLapHint+1] ) {
if( leaderRaceTimes[iLapHint+1] - tCur < 1.0 ) {
reloadTriggered = true;
setTimeout( RefreshPayload, Math.round(7000 + Math.random() * 5000) );
}
}
}
function OpenRiderDashboardViewerWindow( bib )
{
var dataToGo = {};
var catDetailsToGo = [];
for( var i = 0; i < catDetails.length; ++i ) {
var c = catDetails[i];
for( var p = 0; p < c.pos.length; ++p ) {
if( c.pos[p] == bib ) {
catDetailsToGo.push( c );
for( var p = 0; p < c.pos.length; ++p )
dataToGo[c.pos[p]] = data[c.pos[p]];
break;
}
}
}	
var payload = {'bib': bib, 'raceName': raceNameText + ': ' + raceDate, 'data':dataToGo, 'catDetails':catDetailsToGo};
var d = data[bib];
var name = (d.FirstName && d.LastName ? d.FirstName + ' ' + d.LastName : d.FirstName ? d.FirstName : d.LastName);
var newTitle = bib + ': ' + name + ' Dashboard';
var template = riderDashboard.replace(/{-{/g, '<').replace(/}-}/g, '>').replace(
'payload = null;', 'payload=' + JSON.stringify(payload) + ';' ).replace(
'TTIITTLLEE', newTitle.escapeHTML() );
var w = window.open( '', '', '', true );
w.document.write( template );
w.document.close();
}
function GetLocationCount() {
if( !travelMap )
return [];
var locCnt = {};
for( bib in data ) {
var d = data[bib];
var city = d['City'];
if( !city ) continue;
var region = (d['Prov'] || d['State'] || d['StateProv']);
if( !region ) continue;
var location = city + ', ' + region;
if( location in locCnt )
locCnt[location] += 1;
else
locCnt[location] = 1;
}
var locationCount = [];
for( location in locCnt )
locationCount.push( [location, locCnt[location]] );
return locationCount;
}
function OpenTravelMapWindow() {
var locationCount = GetLocationCount();
if( locationCount.length == 0 )
return;
var payload = {
'raceName': raceNameText + ': ' + raceDate,
'locationCount':locationCount
};
if( courseCoordinates )
payload.raceCoords = [courseCoordinates[1],courseCoordinates[0]];
if( raceAddress )
payload.raceAddress = raceAddress;
var template = travelMap.replace(/{-{/g, '<').replace(/}-}/g, '>').replace(
'payload = null;', 'payload=' + JSON.stringify(payload) + ';' );
var w = window.open( '', '', '', true );
w.document.write( template );
w.document.close();
}
function OpenCourseViewerWindow()
{
if( !courseCoordinates || !courseViewerTemplate )
return;
var payload = {};
var fields = ['courseCoordinates', 'raceNameText', 'raceDate', 'email', 'displayUnits', 'organizer',
'gpsAltigraph', 'gpsIsPointToPoint', 'gpsTotalElevationGain' ];
for( var f = 0; f < fields.length; ++f ) {
var key = fields[f];
var value = window[key];
if( value )
payload[key] = value;
}
var lengthKm = 0.0;
for( var i = 0; i < courseCoordinates.length - 2; i += 2 )
lengthKm += GreatCircleDistance(courseCoordinates[i],courseCoordinates[i+1],courseCoordinates[i+2],courseCoordinates[i+3]);
if( !gpsIsPointToPoint )
lengthKm += GreatCircleDistance(courseCoordinates[courseCoordinates.length-2],courseCoordinates[courseCoordinates.length-1],
courseCoordinates[0],courseCoordinates[1] );
lengthKm /= 1000.0;
payload['lengthKm'] = lengthKm;
var newTitle = 'Map: ' + payload['raceNameText'] + ' ' + payload['raceDate'];
var template = courseViewerTemplate.replace(/{-{/g, '<').replace(/}-}/g, '>').replace(
'payload = null;', 'payload=' + JSON.stringify(payload) + ';' ).replace(
'TTIITTLLEE', newTitle.escapeHTML() );
var w = window.open( '', '', '', true );
w.document.write( template );
w.document.close();
}
function LineNormal( x1, y1, x2, y2, normLen )
{
var dx = x2 - x1, dy = y2 - y1;
var scale = (normLen / 2.0) / Math.sqrt( dx*dx + dy*dy );
dx *= scale;
dy *= scale;
return [x1 + dy, y1 - dx, x1 - dy, y1 + dx];
}
function getRiderPositionTime( num )
{
var info = data[num];
if( !info )
return [null, null];
var raceTimes = info['raceTimes'];
if( !raceTimes || raceTimes.length == 0 )
return [null, null];
var p;
if( t <= raceTimes[0] )
{
var firstLapRatio = info['flr'];
p = 1.0 - firstLapRatio;
p -= Math.floor(p) - 1.0;
return [p, t];
}
var tSearch = t;
var finishTime = info['finishTime'];
if( finishTime != null && finishTime < t )
tSearch = finishTime;
if( tSearch >= raceTimes.back() )
{
var lastRaceTime = raceTimes.back();
p = raceTimes.length + (tSearch - lastRaceTime) / (lastRaceTime - raceTimes[raceTimes.length-2]);
}
else
{
var i = info['iLast'];
if( !(raceTimes[i-1] < tSearch && tSearch <= raceTimes[i]) )
{
++i;
if( !(raceTimes[i-1] < tSearch && tSearch <= raceTimes[i]) )
{
i = raceTimes.binSearch( tSearch );
if( raceTimes[i] < tSearch )
++i;
}
info['iLast'] = i;
}
if( i == 1 )
{
var firstLapRatio = info['flr'];
p = (tSearch - raceTimes[i-1]) / (raceTimes[i] - raceTimes[i-1]);
p = 1.0 - firstLapRatio + p * firstLapRatio;
p -= Math.floor(p) - 1.0;
}
else
p = i + (tSearch - raceTimes[i-1]) / (raceTimes[i] - raceTimes[i-1]);
}
return [p, tSearch];
}
function DrawCircle( ctx, x, y, radius )
{
ctx.beginPath();
ctx.arc(x, y, radius, 0.0, Math.PI*2, true);
ctx.closePath();
ctx.fill();
ctx.stroke();
}
function DrawLine( ctx, x1, y1, x2, y2 )
{
ctx.beginPath();
ctx.moveTo( x1, y1 );
ctx.lineTo( x2, y2 );
ctx.stroke();
}
function TimeDifference( a, b )
{
if( showTimeDecimals )
{
a *= 100.0;
b *= 100.0;
}
var t = ~~a - ~~b;
if( showTimeDecimals )
t /= 100.0;
return t;
}
function FormatTime( t ) {
var tStr = '';
if( t < 0 )
{
tStr = '-';
t = -t;
}
var secs = ~~t;
var h = ~~(secs / (60*60));
var m = (~~(secs / 60) % 60);
var s = ~~(secs % 60);
if( h > 0 )
tStr += h + (m < 10 ? ':0' : ':') + m + (s < 10 ? ':0' : ':') + s;
else
tStr += m + (s < 10 ? ':0' : ':') + s;
if( showTimeDecimals )
{
var decimals = ~~((t - ~~t) * 100);
tStr += (decimals < 10 ? '.0' : '.') + decimals;
}
return tStr;
}
function FormatTimeGap( t )
{
var tStr = '';
if( t < 0 )
{
tStr = '-';
t = -t;
}
var secs = ~~t;
var h = ~~(secs / (60*60));
var m = (~~(secs / 60) % 60);
var s = ~~(secs % 60);
if( h > 0 )
tStr += h + (m < 10 ? 'h0' : 'h') + m + (s < 10 ? "'0" : "'") + s;
else
tStr += m + (s < 10 ? "'0" : "'") + s;
if( showTimeDecimals )
{
var decimals = ~~((t - ~~t) * 100);
tStr += (decimals < 10 ? '.0' : '.') + decimals;
}
tStr += '"';
return tStr;
}
function getShortName( num )
{
var d = data[num + ''];
var name = '';
if( d['LastName'] )
{
name = d['LastName'];
if( d['FirstName'] )
name += ', ' + d['FirstName'].substring(0, 1) + '.'
}
else if( d['FirstName'] )
name = d['FirstName'];
return name;
}
function FixedFormat( x, Length, Decimals ) {
var s = x.toFixed( Decimals );
if( s.length < Length )
s = Array(Length - s.length + 1).join('0') + s;
return s;
}
function TrackAnimation()
{
this.iLapDistance = 0;
this.getXYfromPosition = function( lane, position )
{
position -= ~~(position);
var curveLength = (r/2.0) * Math.PI;
var trackLength = 4*r + 2 * curveLength;
var laneWidth = (r/2.0) / laneMax;
var laneLength = lane * laneWidth;
var riderLength = trackLength * position;
if( riderLength <= r/2 )
return [2*r + r/2.0 + riderLength, r + r/2.0 + laneLength];
riderLength -= r/2;
if( riderLength <= curveLength )
{
a = Math.PI * riderLength / curveLength;
rd = r/2 + laneLength;
return [3*r + rd*Math.sin(a), r + rd*Math.cos(a)];
}
riderLength -= curveLength;
if( riderLength <= 2*r )
return [3*r - riderLength, r/2 - laneLength];
riderLength -= 2*r;
if( riderLength <= curveLength )
{
a = Math.PI * (1.0 + riderLength / curveLength);
rd = r/2 + laneLength;
return [r + rd*Math.sin(a), r + rd*Math.cos(a)];
}	
riderLength -= curveLength;
return [r + riderLength, r + r/2 + laneLength];
}
this.getRiderXYPT = function( num, lane )
{
var positionTime = getRiderPositionTime( num );
if ( positionTime[0] == null )
return [null, null, null, null];
if( data[num]['finishTime'] != null && t >= data[num]['finishTime'] )
{
lapCur = Math.max( lapCur, data[num]['raceTimes'].length );
return [null, null, positionTime[0], positionTime[1]];
}
lapCur = Math.max(lapCur, ~~positionTime[0]);
var xypt = this.getXYfromPosition( lane, positionTime[0] );
if( reverseDirection )
xypt[0] = r * 4 - xypt[0];
if( finishTop )
xypt[1] = r * 2 - xypt[1];
xypt.push( positionTime[0] );
xypt.push( positionTime[1] );
return xypt;
}
this.resetCache = function() { this.cache = {}; }
this.Refresh = function()
{
if( !canvas || !canvasSupported || document[hidden] )
return;
var dc = canvas.getContext('2d');
dc.textBaseline = "top";
var width = canvas.width;
var height = canvas.height;
var backColour = 'white';
dc.fillStyle = backColour;
dc.fillRect(0, 0, width, height );
if( width < 80 || height < 80 )
return;
r = ~~(width / 4);
if( r * 2 > height )
r = ~~(height / 2);
r -= (r & 1);			
var tHeight = r / 8;
var fontHeight = ~~(tHeight * fontMult);
var fontStr = fontHeight + "px Arial";
var fontStrHightlight = ~~(tHeight * 1.6 * fontMult) + "px Arial";
dc.font = fontStr;
//trackColour = 'rgb(0,255,0)';
trackColour = '#7FE57F';
dc.fillStyle = trackColour;
dc.strokeStyle = trackColour;
DrawCircle( dc, r, r, r );
DrawCircle( dc, 3*r, r, r );
dc.fillRect( r, 0, 2*r, 2*r + 2 );
laneWidth = (r/2) / laneMax;
dc.fillStyle = backColour;
dc.strokeStyle = backColour;
DrawCircle( dc, r, r, r/2 - laneWidth );
DrawCircle( dc, 3*r, r, r/2 - laneWidth );
var pp = [r, r/2 + laneWidth, 2*r, r - 2*laneWidth + 1];
dc.fillRect( pp[0], pp[1], pp[2], pp[3] );
dc.strokeRect( pp[0], pp[1], pp[2], pp[3] );
for( var i = 0; i <= 3; ++i )
{
var p = 0.25 * i;
var p1 = this.getXYfromPosition(-1, p);
var p2 = this.getXYfromPosition(laneMax+0.25, p);
if( reverseDirection )
{
p1[0] = 4*r - p1[0];
p2[0] = 4*r - p2[0];
}
if( finishTop )
{
p1[1] = 2*r - p1[1];
p2[1] = 2*r - p2[1];
}
if( i == 0 )
{
var sfWidth = 8;
dc.strokeStyle = '#FFFFFF';
dc.fillRect( p1[0] - sfWidth / 2, Math.min(p1[1], p2[1]), sfWidth, r );
dc.strokeStyle = 'black';
dc.lineWidth = 2;
}
else
{
dc.lineWidth = 1;
dc.strokeStyle = 'rgb(64,64,64)';
}
DrawLine( dc, p1[0], p1[1], p2[0], p2[1] );
}
dc.strokeStyle = 'black';
dc.fillStyle = 'black';
dc.lineWidth = 1;
numSize = (r/2)/laneMax;
lapCur = 0;
var riderRadius = laneWidth * 0.75;
var thickLine = r / 24;
var hasFirstLapRatio = false;
firstLapRatio = 1.0;
if( data )
{
var riderXYPT = [];
var cd = catDetailsByName[categoryCur];
for( var p = 0; p < cd.pos.length; ++p )
{
var num = cd.pos[p];
if( !hasFirstLapRatio )
{
hasFirstLapRatio = true;
if( cd['firstLapDistance'] && cd['lapDistance'] )
firstLapRatio = cd['firstLapDistance'] / cd['lapDistance'];
}
var xypt = this.getRiderXYPT( num, num % laneMax );
if( xypt[2] == null )
continue;
xypt.splice( 0, 0, num );
riderXYPT.push( xypt );
}
riderXYPT.sort(function(x, y)
{
var r = (y[3] ? y[3] : 0) - (x[3] ? x[3] : 0);	
if( r == 0 )
r = (x[4] ? x[4] : 0) - (y[4] ? y[4] : 0);	
if( r == 0 )
r = (x[0] - y[0]);							
return -r;
});
var leaders = [];
for( var i = riderXYPT.length - 1; i >= 0 && leaders.length < 3; --i )
leaders.push( riderXYPT[i][0] );
var topThree = {};
for( var i = 0; i < leaders.length; ++i )
topThree[leaders[i]] = i;
var riderPosition = {};
for( var i = 0; i < riderXYPT.length; ++i )
{
var rxypt = riderXYPT[i];
riderPosition[rxypt[0]] = riderXYPT.length - i;
var x = rxypt[1];
if( x == null )
continue;
num = rxypt[0];
var y = rxypt[2];
dc.fillStyle = colours[num % colours.length];
var j = topThree[num];
if( j != undefined )
{
dc.strokeStyle = topThreeColours[j];
dc.lineWidth = thickLine;
if( numsToWatch[num] != undefined )
dc.font = fontStrHightlight;
}
else
{
j = numsToWatch[num];
if( j != undefined )
{
dc.strokeStyle = 'white';
dc.lineWidth = thickLine * 1.5;
dc.font = fontStrHightlight;
}
}
if( isNaN(x) || isNaN(y) )
continue;
//DrawCircle( dc, x, y, riderRadius );
dc.beginPath(); dc.arc(x, y, riderRadius, 0.0, Math.PI*2, true); dc.closePath(); dc.fill(); dc.stroke();
dc.fillStyle = 'black';
dc.fillText(num+'', x+numSize, y-numSize );
if( j != undefined )
{
dc.strokeStyle = 'black';
dc.lineWidth = 1;
dc.font = fontStr;
}
}
}
dc.fillStyle = 'black';
if( lapCur > 0 )
{
var table = [[],[]];
if( leaders.length > 0 ) {
var leaderRaceTimes = data[leaders[0]]['raceTimes'];
var maxLaps = leaderRaceTimes.length - 1;
var glr = GetLapRatio( leaderRaceTimes, t, this.iLapDistance );
this.iLapDistance = glr[0];
TriggerReload( leaderRaceTimes, t, this.iLapDistance );
var lapRatio = glr[1];
lapRatio = Math.floor(lapRatio * 10.0) / 10.0		
table[0].push( FixedFormat(this.iLapDistance + lapRatio, 5, 1) + ' ' + _('Laps of') + ' ' + maxLaps );
table[1].push( FixedFormat(maxLaps - this.iLapDistance - lapRatio, 5, 1) + ' ' + _('Laps to go') );
var leaderCategory = data[leaders[0]]['raceCat'];
var cat = (leaderCategory && catDetailsByName ? catDetailsByName[leaderCategory] : null);
if( cat ) {
var distanceCur = null, distanceRace = null;
if( cat['lapDistance'] ) {
var flr = data[leaders[0]]['flr']; if( !flr ) flr = 1.0;
var distanceLap = cat['lapDistance'];
if( cat['distanceUnit'] != displayUnits )
distanceLap *= (displayUnits == 'km' ? 1.60934 : 0.621371);
distanceRace = distanceLap * (flr + maxLaps - 1);
if( this.iLapDistance == 0 )
distanceCur = lapRatio * (distanceLap * flr);
else
distanceCur = distanceLap * (flr + this.iLapDistance - 1 + lapRatio);
}
else if( cat['raceDistance'] && leaderRaceTimes[0] != leaderRaceTimes.back() ) {
distanceRace = cat['raceDistance'];
if( cat['distanceUnit'] != displayUnits )
distanceRace *= (displayUnits == 'km' ? 1.60934 : 0.621371);
var distanceCur = (t - leaderRaceTimes[0]) / (leaderRaceTimes.back() - leaderRaceTimes[0]) * distanceRace;
distanceCur = Math.max( 0.0, Math.min(distanceCur, distanceRace) );
}
if( distanceCur != null ) {
if( distanceCur != distanceRace )
distanceCur = Math.floor( distanceCur * 10.0 ) / 10.0;
table[0].push( FixedFormat(distanceCur, 5, 1) + ' ' + _(displayUnits) + ' ' + _('of') + ' ' + distanceRace.toFixed(1) );
table[1].push( FixedFormat(distanceRace - distanceCur, 5, 1) + ' ' + _(displayUnits) + ' ' + _('to go') );
}
}
}
var xRight  = 3*r + r/7;
for( var col = table[0].length - 1; col >= 0; --col ) {
var tWidth = 0;
for( var row = 0; row < table.length; ++row ) {
tWidth = Math.max( tWidth, dc.measureText(table[row][col]).width );
}
xRight -= tWidth;
var yCur = r + r/2 - laneWidth - fontHeight * 1.2 - fontHeight;
for( var row = 0; row < table.length; ++row ) {
var value = table[row][col];
var tShow = value.replace(/^0+/, '');
if( tShow.substring(0, 1) == '.' )
tShow = '0' + tShow;
dc.fillText( tShow, xRight + dc.measureText(Array(value.length - tShow.length + 1).join('0')).width, yCur );
yCur += fontHeight;
}
xRight -= fontHeight / 2.5;
}
}
var leaderWidthMax = 0;
var xLeft = ~~(r * 0.8);
if( leaders )
{
var x = xLeft;
var y = r / 2 + laneWidth * 1.5;
dc.fillText( 'Leaders:', x, y );
y += tHeight * 1.2;
thickLine = tHeight / 5;
riderRadius = tHeight / 3.5;
for( var i = 0; i < leaders.length; ++i )
{
var num = leaders[i];
dc.lineWidth = 1;
dc.strokeStyle = backColour;
dc.fillStyle = trackColour;
dc.fillRect( x - thickLine/4, y - thickLine/4, tHeight + thickLine/2, tHeight  + thickLine/2 );
dc.strokeStyle = topThreeColours[i];
dc.lineWidth = thickLine;
dc.fillStyle = colours[num % colours.length];
DrawCircle( dc, x + tHeight / 2, y + tHeight / 2, riderRadius );
dc.fillStyle = 'black';
var leadStr = num + ' ' + getShortName(num);
var tWidth = dc.measureText(leadStr).width;
if( tWidth > leaderWidthMax )
leaderWidthMax = tWidth;
dc.fillText( leadStr, x + tHeight * 1.2, y );
y += tHeight * 1.2;
}
}
if( numsToWatch )
{
var colCount = 0;
var x = xLeft + tHeight * 1.2 + leaderWidthMax + dc.measureText(' ').width;
var yTop = r / 2 + laneWidth * 1.5 + tHeight * 1.2;
var y = yTop;
var rp = [];
for( n in numsToWatch )
{
var p = riderPosition[n];
if( p != undefined )
rp.push( [p, n] );
}
rp.sort(function(x, y) { return x[0] - y[0]; });
dc.fillStyle = 'black';
for( var i = 0; i < rp.length && i < 3; ++i )
{
var num = rp[i][1];
dc.fillText( '(' + rp[i][0] + ') ' + num + ' ' + getShortName(num), x, y );
y += tHeight * 1.2;
if( y >= r * 1.5 - tHeight * 1.5 )
{
if( ++colCount == 2 )
break;
y = yTop;
x += tWidth * 1.2;
}
}
}
dc.fillStyle = 'black';
var tStr = FormatTime( t );
var tWidth = dc.measureText(tStr).width;
dc.fillText( tStr, 4*r - tWidth, 2*r - tHeight );
}
}
function GeoTrack()
{
this.setData = function( gpsData )
{
this.gpsPoints = gpsData;
this.xMax = 0.0;
this.yMax = 0.0;
var dCum = 0.0;
this.cumDistance = [];
var gpsPointsLength = this.gpsPoints.length;
for( var i = 0; i < gpsPointsLength; ++i )
{
var g = gpsData[i];
this.xMax = Math.max( this.xMax, g[0] );
this.yMax = Math.max( this.yMax, g[1] );
this.cumDistance.push( dCum );
dCum += g[2];
}
this.distanceTotal = dCum;
this.x = 0;
this.yBottom = 0;
this.mult = 1.0;
this.cache = {};
}
this.resetCache = function() { this.cache = {}; }
this.getXYTrack = function()
{
var x = this.x;
var yBottom = this.yBottom;
var mult = this.mult;
var track = [];
var gpsPointsLength = this.gpsPoints.length;
for( var i = 0; i < gpsPointsLength; ++i )
{
var p = this.gpsPoints[i];
track.push( [p[0] * mult + x, yBottom - p[1] * mult] );
}
return track;
}
this.getXY = function( lap, id )
{
if( id == undefined )
id = -1;
var lap = lap - (~~lap);								
var lapDistance = lap * this.distanceTotal;				
var lenGpsPoints = this.gpsPoints.length;
var i = -1;
if( id in this.cache )
{
i = this.cache[id] % lenGpsPoints;
if( !(this.cumDistance[i] <= lapDistance && lapDistance <= this.cumDistance[i] + this.gpsPoints[i][2]) )
{
i = (i + 1) % lenGpsPoints;
if( !(this.cumDistance[i] <= lapDistance && lapDistance <= this.cumDistance[i] + this.gpsPoints[i][2]) )
i = -1;
}
}
if( i == -1 )
{
i = this.cumDistance.binSearch(lapDistance);
if( this.cumDistance[i] > lapDistance )
i += lenGpsPoints - 1;
i %= lenGpsPoints;
}
if( gpsIsPointToPoint )
i = Math.min( i, lenGpsPoints - 2 )
this.cache[id] = i;
var pCur = this.gpsPoints[i], pNext = this.gpsPoints[(i+1)%lenGpsPoints];
var segDistance = lapDistance - this.cumDistance[i];
var segRatio = segDistance / pCur[2];
var x = pCur[0] + (pNext[0] - pCur[0]) * segRatio;
var y = pCur[1] + (pNext[1] - pCur[1]) * segRatio;
return [x * this.mult + this.x, this.yBottom - y * this.mult];
}
this.setDisplayRect = function( x, y, width, height )
{
if( width <= 0 || height <= 0 )
{
this.mult = 1.0;
this.x = x;
this.yBottom = y + height;
return;
}
var mult = Math.min( width / this.xMax, height / this.yMax );
var w = this.xMax * mult, h = this.yMax * mult;
var xBorder = (width - w) / 4.0;
var yBorder = (height - h) / 2.0;
this.mult = mult;
this.x = xBorder + x;
this.yBottom = y + height;
}
}
function colorBetween( r1, g1, b1, r2, g2, b2, x )
{
var r = (r1 + (r2 - r1) * x).toFixed(0);
var g = (g1 + (g2 - g1) * x).toFixed(0);
var b = (b1 + (b2 - b1) * x).toFixed(0);
return 'rgb(' + r + ',' + g + ',' + b + ')';
}
function Altigraph()
{
this.altigraph = [];
this.yMax = -1000000.0;
this.yMin = 1000000.0
this.xMax = 0.0;
this.setData = function( altigraph )
{
if( !altigraph || altigraph.length == 0 )
altigraph = [];
this.altigraph = altigraph;
this.yMax = -1000000.0;
this.yMin = 1000000.0
this.xMax = 0.0;
for( var i = 0; i < altigraph.length; ++i )
{
if( altigraph[i][1] > this.yMax )
this.yMax = altigraph[i][1];
if( altigraph[i][1] < this.yMin )
this.yMin = altigraph[i][1];
}
if( altigraph.length > 0 )
this.xMax = altigraph[altigraph.length-1][0];
if( this.yMin == this.yMax )
{
this.altigraph = []
gpsAltigraph = null;
gpsTotalElevationGain = null;
}
}
this.empty = function() { return this.altigraph.length == 0; }
this.draw = function( dc, x, y, width, height )
{
if( this.altigraph.length == 0 || this.xMax == 0 || !gpsTotalElevationGain )
return;
dc.save();
y += 2;		
height -= 2;
var fontSize = (height*0.95)/4.0;
dc.font = fontSize + 'px Arial';
var minLabel = '0';
var maxLabel = ((this.yMax - this.yMin) * (displayUnits == 'km' ? 1.0 : 3.28084)).toFixed(0) + (displayUnits == 'km' ? ' m' : ' ft');
var labelWidth = Math.max( dc.measureText(minLabel).width, dc.measureText(maxLabel).width );
var altigraph = this.altigraph;
var teg = 0.0;
for( var i = 1; i < this.altigraph.length; ++i )
teg += Math.max(0.0, altigraph[i][1] - altigraph[i-1][1]);
var tegLabel = '';
var tegWidth = 0;
var tegText = [('Total'), ('Elevation'), ('Gain')];
if( gpsTotalElevationGain )
{
tegLabel = (gpsTotalElevationGain * (displayUnits == 'km' ? 1.0 : 3.28084)).toFixed(0) + (displayUnits == 'km' ? ' m' : ' ft');
tegWidth = dc.measureText(tegLabel).width;
for( var i = 0; i < tegText.length; ++i )
tegWidth = Math.max( tegWidth, dc.measureText(tegText[i]).width );
}
var border = 4;
if( labelWidth + border*2 + tegWidth > width )
{
dc.restore();
return;
}
var xMult = (width - labelWidth - border*2 - tegWidth) / this.xMax;
var yMult = height / (this.yMax - this.yMin);
var points = [];
for( var i = 0; i < this.altigraph.length; ++i )
points.push( [(x + labelWidth + border + altigraph[i][0] * xMult), (y + height - (altigraph[i][1] - this.yMin) * yMult)] );
for( var i = 1; i < this.altigraph.length; ++i )
{
var grade = (altigraph[i][1] - altigraph[i-1][1]) / (altigraph[i][0] - altigraph[i-1][0]);
if( grade > 0 )
dc.fillStyle = colorBetween( 255,255,255, 255,0,0, Math.min(1.0,  grade / 0.12) );
else
dc.fillStyle = colorBetween( 255,255,255,   0,0,0, Math.min(1.0, -grade / 0.12) );
dc.beginPath();
dc.moveTo( points[i-1][0], points[i-1][1] );
dc.lineTo( points[i  ][0], points[i  ][1] );
dc.lineTo( points[i  ][0], y + height );
dc.lineTo( points[i-1][0], y + height );
dc.closePath();
dc.fill();
}
dc.strokeStyle = '#000000';
dc.lineWidth = 2;
dc.beginPath();
dc.moveTo( points[0][0], points[0][1] );
for( var i = 1; i < this.altigraph.length; ++i )
dc.lineTo( points[i][0], points[i][1] );
dc.stroke();
dc.lineWidth = 1;
dc.beginPath();
dc.moveTo( x + labelWidth + border, y + height );
dc.lineTo( x + width - border - tegWidth, y + height );
dc.stroke();
dc.lineWidth = 1;
dc.beginPath();
dc.moveTo( x + labelWidth + border, y );
dc.lineTo( x + labelWidth + border, y + height );
dc.stroke();
dc.beginPath();
dc.moveTo( x + width - tegWidth - border, y );
dc.lineTo( x + width - tegWidth - border, y + height );
dc.stroke();
dc.fillStyle = '#000000';
dc.textAlign = 'right';
dc.textBaseline = 'top';
dc.fillText( maxLabel, x + labelWidth, y );
dc.textBaseline = 'bottom';
dc.fillText( minLabel, x + labelWidth, y + height );
if( gpsTotalElevationGain )
{
dc.textBaseline = 'top';
dc.textAlign = 'left';
var xCur = x + width - tegWidth;
var yCur = y + (height - fontSize * 1.05 * 4) / 2;
for( var i = 0; i < tegText.length; ++i )
{
dc.fillText( tegText[i], xCur, yCur );
yCur += fontSize * 1.05;
}
dc.fillText( tegLabel, xCur, yCur );
}
dc.restore();
}
}
var infoLines = 1;
function GeoAnimation()
{
this.xBanner = 300;
this.geoTrack = new GeoTrack();
this.altigraph = new Altigraph();
this.compassLocation = 'SE';
this.widthLast = -1;
this.heightLast = -1;
this.iLapDistance = 0;
this.tBannerLast = -1;
this.drawCompass = function( dc, width, height, tHeight )
{
dc.save();
var size = width / 20;
var x = this.compassLocation[1] == 'E' ? width - size * 1.4 : size * 1.4;
var y = this.compassLocation[0] == 'N' ? size * 1.4 + tHeight * 3 : height - size * 1.4;
if( this.compassLocation[0] == 'S' && gpsTotalElevationGain )
y -= height / 20;
var factor = 7.0;
var pseg1 = [[0,0], [size/factor,size/factor], [0,size]];		
var pseg2 = [[0,0], [-size/factor,size/factor], [0,size]];
var labels = ['S', 'E', 'N', 'W'];
dc.fillStyle = '#000000';
dc.strokeStyle = '#000000';
dc.lineWidth = 1;
var fontSize = size/4;
dc.font = fontSize + 'px serif';
dc.textAlign = 'center';
for( var i = 0; i < 4; ++i )
{
dc.fillText( labels[i], x + pseg1[2][0]*1.2, y + pseg1[2][1]*1.2 - fontSize/2 );
dc.beginPath();
dc.moveTo( x, y );
for( var p = 0; p < pseg1.length; ++p )
{
dc.lineTo( x + pseg1[p][0], y + pseg1[p][1] );
pseg1[p] = [pseg1[p][1], -pseg1[p][0]];	
}
dc.stroke()
dc.beginPath();
dc.moveTo( x, y );
for( var p = 0; p < pseg2.length; ++p )
{
dc.lineTo( x + pseg2[p][0], y + pseg2[p][1] );
pseg2[p] = [pseg2[p][1], -pseg2[p][0]];	
}
dc.fill()
}
dc.restore();
}
this.drawBanner = function( dc, width, height, tHeight, bannerItems )
{
drawSegment( dc, 0, 0, width, tHeight*1.2, '#0000CC', '#0000EE' );
if( bannerItems.length == 0 )
return
var y = tHeight * 0.1;
tHeight *= 0.85;
var x = this.xBanner;
var tWidth;
var positionFont = (tHeight*.7) + "px Arial";
var numberFont = 'italic bold ' + tHeight + "px Arial";
var nameFont = 'bold ' + tHeight + "px Arial";
while( x < width )
{
for( var i = 0; i < bannerItems.length && x < width; ++i )
{
var position = bannerItems[i][1];
var num = bannerItems[i][0];
var name = getShortName( num );
if( position == 1 )
{
x += tHeight / 2;
tWidth = checkeredFlag.width;
if( x + tWidth > 0 && x < width )
dc.drawImage( checkeredFlag, x, y );
x += tWidth + tHeight / 2;
}
dc.font = positionFont;
tWidth = dc.measureText(position).width;
if( x + tWidth > 0 && x < width )
{
dc.fillStyle = '#FFFFFF';
dc.fillText(position, x, y );
}
x += tWidth + tHeight / 4;
dc.font = numberFont;
tWidth = dc.measureText(num).width;
if( x + tWidth > 0 && x < width)
{
dc.fillStyle = '#FFFF00';
dc.fillText(num, x, y );
}
x += tWidth + tHeight / 3;
dc.font = nameFont;
tWidth = dc.measureText(name).width;
if( x + tWidth > 0 && x < width )
{
dc.fillStyle = '#FFFFFF';
dc.fillText(name, x, y );
}
x += tWidth + tHeight;
}
if( x < 0 )
this.xBanner = x;
}
var tBanner = (new Date().getTime()) / 1000.0;
if( this.tBannerLast < 0 )
this.tBannerLast = tBanner;
this.xBanner -= 64.0 * (tBanner - this.tBannerLast);
this.tBannerLast = tBanner;
}
this.resetCache = function() { this.geoTrack.resetCache(); }
this.getRiderXYPT = function( num )
{
var positionTime = getRiderPositionTime( num );
if( positionTime[0] == null )
return [null, null, null, null];
if( data[num]['finishTime'] != null && t >= data[num]['finishTime'] )
{
lapCur = Math.max( lapCur, data[num]['raceTimes'].length );
return [null, null, positionTime[0], positionTime[1]];
}
lapCur = Math.max(lapCur, ~~positionTime[0]);
var xy = this.geoTrack.getXY( positionTime[0], num );
return [xy[0], xy[1], positionTime[0], positionTime[1]];
}
this.Refresh = function()
{
if( !canvas || !canvasSupported || document[hidden] )
return;
var dc = canvas.getContext('2d');
dc.textBaseline = "top";
var width = canvas.width;
var height = canvas.height;
var sizeChanged = false;
if( width != this.widthLast || height != this.heightLast )
{
this.widthLast = width;
this.heightLast = height;
sizeChanged = true;
}
var backColour = 'white';
dc.fillStyle = backColour;
if( width < 80 || height < 80 )
{
dc.fillRect(0, 0, width, height );
return;
}
if( gpsTotalElevationGain && !this.altigraph.empty() )
{
var altigraphHeight = height / 8;
if( sizeChanged )
{
dc.fillRect(0, 0, width, height );
this.altigraph.draw( dc, 0, height - altigraphHeight, width, altigraphHeight );
}
height -= altigraphHeight;
}
dc.fillRect(0, 0, width, height );
r = ~~(width / 4);
if( r * 2 > height )
r = ~~(height / 2);
r -= (r & 1);			
var border = 8;
var tHeight = ~~((r / 8) * fontMult);
laneWidth = (r/2) / laneMax;
var fontStr = (tHeight*.8) + "px Arial";
var textVSpace = tHeight*0.2;
var fontStrHightlight = ~~(tHeight * 1.1) + "px Arial";
dc.font = fontStr;
compassSize = (width / 20) * 1.4 * 2;
var trackWidth = width - border * 2 - laneWidth*2 - compassSize;
var topMargin = 2*border + tHeight * infoLines + textVSpace;
var trackHeight = height - topMargin;
this.geoTrack.setDisplayRect( border, topMargin, trackWidth, trackHeight - laneWidth );
dc.beginPath();
var points = this.geoTrack.getXYTrack();
dc.moveTo( points[0][0], points[0][1] );
var pointsLength = points.length;
for( var i = 1; i < pointsLength; ++i )
dc.lineTo( points[i][0], points[i][1] );
if( !gpsIsPointToPoint )
dc.closePath();
dc.lineJoin = "round";
dc.strokeStyle = "#808080";
dc.lineWidth = laneWidth * 1.25 + 2;
dc.stroke();
var trackColour = '#7FE57F';
dc.strokeStyle = trackColour;
dc.lineWidth = laneWidth * 1.25;
dc.stroke();
dc.strokeStyle = '#505050';
dc.lineWidth = 1;
dc.stroke();
this.drawCompass( dc, width, height, tHeight )
var finishLineLen = laneWidth * 2;
var fLine;
if( gpsIsPointToPoint )
fLine = LineNormal( points[points.length-1][0], points[points.length-1][1], points[points.length-2][0], points[points.length-2][1], finishLineLen );
else
fLine = LineNormal( points[0][0], points[0][1], points[1][0], points[1][1], finishLineLen );
dc.beginPath()
dc.moveTo( fLine[0], fLine[1] );
dc.lineTo( fLine[2], fLine[3] );
dc.strokeStyle = "#FFFFFF";
dc.lineWidth = laneWidth / 1.5;
dc.stroke();
dc.strokeStyle = "#000000";
dc.lineWidth = laneWidth / 5;
dc.stroke();
if( gpsIsPointToPoint )
fLine = LineNormal( points[points.length-1][0], points[points.length-1][1], points[points.length-2][0], points[points.length-2][1], laneWidth * 4 );
else
fLine = LineNormal( points[0][0], points[0][1], points[1][0], points[1][1], laneWidth * 4 );
dc.drawImage( checkeredFlag, fLine[2] - checkeredFlag.width/2, fLine[3] - checkeredFlag.height/2 );
dc.strokeStyle = 'black';
dc.fillStyle = 'black';
dc.lineWidth = 1;
numSize = (r/2)/laneMax;
lapCur = 0;
var riderRadius = laneWidth * 0.5;
var thickLine = r / 32;
var hasFirstLapRatio = false;
firstLapRatio = 1.0;
if( data )
{
var riderXYPT = [];
var cd = catDetailsByName[categoryCur];
for( var p = 0; p < cd.pos.length; ++p )
{
var num = cd.pos[p];
if( !hasFirstLapRatio )
{
hasFirstLapRatio = true;
if( cd['firstLapDistance'] && cd['lapDistance'] )
firstLapRatio = cd['firstLapDistance'] / cd['lapDistance'];
}
var xypt = this.getRiderXYPT( num );
if( xypt[2] == null )
continue;
xypt.splice( 0, 0, num );
riderXYPT.push( xypt );
}
riderXYPT.sort(function(x, y)
{
var r = (y[3] ? y[3] : 0) - (x[3] ? x[3] : 0);	
if( r == 0 )
r = (x[4] ? x[4] : 0) - (y[4] ? y[4] : 0);	
if( r == 0 )
r = (x[0] - y[0]);							
return -r;
});
var leaders = [];
for( var i = riderXYPT.length - 1; i >= 0 && leaders.length < 5; --i )
leaders.push( riderXYPT[i][0] );
var topThree = {};
for( var i = 0; i < leaders.length; ++i )
topThree[leaders[i]] = i;
var riderPosition = {};
for( var i = 0; i < riderXYPT.length; ++i )
{
var rxypt = riderXYPT[i];
riderPosition[rxypt[0]] = riderXYPT.length - i;
var x = rxypt[1];
if( x == null )
continue;
num = rxypt[0];
var y = rxypt[2];
dc.fillStyle = colours[num % colours.length];
var j = topThree[num];
if( j != undefined )
{
dc.strokeStyle = topThreeColours[j];
dc.lineWidth = thickLine;
if( numsToWatch[num] != undefined )
dc.font = fontStrHightlight;
}
else
{
j = numsToWatch[num];
if( j != undefined )
{
dc.strokeStyle = '#ffa500';
dc.lineWidth = thickLine * 1.5;
dc.font = fontStrHightlight;
}
}
if( isNaN(x) || isNaN(y) )
continue;
//DrawCircle( dc, x, y, riderRadius );
dc.beginPath(); dc.arc(x, y, riderRadius, 0.0, Math.PI*2, true); dc.closePath(); dc.fill(); dc.stroke();
if( topThree[num] != undefined || numsToWatch[num] != undefined )
{
if( isEmptyObject(numsToWatch) || numsToWatch[num] != undefined )
{
dc.fillStyle = 'black';
dc.fillText(num+'', x+numSize, y-numSize );
}
}
if( j != undefined )
{
dc.strokeStyle = 'black';
dc.lineWidth = 1;
dc.font = fontStr;
}
}
}
dc.fillStyle = '#222';
yCur = tHeight+textVSpace*1.6;
tStr = FormatTime( t );
dc.fillText( tStr, width - dc.measureText(tStr).width, yCur );
yCur += tHeight;
if( leaders.length > 0 ) {
var leaderRaceTimes = data[leaders[0]]['raceTimes'];
if( leaderRaceTimes && leaderRaceTimes.length > 0 && leaderRaceTimes[0] < leaderRaceTimes.back() ) {
var table = [];
var leaderRaceTimes = data[leaders[0]]['raceTimes'];
var maxLaps = leaderRaceTimes.length - 1;
var glr = GetLapRatio( leaderRaceTimes, t, this.iLapDistance );
this.iLapDistance = glr[0];
TriggerReload( leaderRaceTimes, t, this.iLapDistance );
var lapRatio = glr[1];
lapRatio = Math.floor(lapRatio * 10.0) / 10.0		
table.push( FixedFormat(this.iLapDistance + lapRatio, 5, 1) + ' ' + _('Laps of') + ' ' + maxLaps );
table.push( FixedFormat(maxLaps - this.iLapDistance - lapRatio, 5, 1) + ' ' + _('Laps to go') );
var leaderCategory = data[leaders[0]]['raceCat'];
var cat = (leaderCategory && catDetails ? catDetails[leaderCategory] : null);
if( cat ) {
var distanceCur = null, distanceRace = null;
if( cat['lapDistance'] ) {
var flr = data[leaders[0]]['flr']; if( !flr ) flr = 1.0;
var distanceLap = cat['lapDistance'];
if( cat['distanceUnit'] != displayUnits )
distanceLap *= (displayUnits == 'km' ? 1.60934 : 0.621371);
distanceRace = distanceLap * (flr + maxLaps - 1);
if( this.iLapDistance == 0 )
distanceCur = lapRatio * (distanceLap * flr);
else
distanceCur = distanceLap * (flr + this.iLapDistance - 1 + lapRatio);
}
else if( cat['raceDistance'] && leaderRaceTimes.length > 0 && leaderRaceTimes[0] != leaderRaceTimes.back() ) {
distanceRace = cat['raceDistance'];
if( cat['distanceUnit'] != displayUnits )
distanceRace *= (displayUnits == 'km' ? 1.60934 : 0.621371);
distanceCur = (t - leaderRaceTimes[0]) / (leaderRaceTimes.back() - leaderRaceTimes[0]) * distanceRace;
distanceCur = Math.max( 0.0, Math.min(distanceCur, distanceRace) );
}
if( distanceCur != null ) {
if( distanceCur != distanceRace )
distanceCur = Math.floor( distanceCur * 10.0 ) / 10.0;
table.push( '' );
table.push( FixedFormat(distanceCur, 5, 1) + ' ' + _(displayUnits) + ' ' + _('of') + ' ' + distanceRace.toFixed(1) );
table.push( FixedFormat(distanceRace - distanceCur, 5, 1) + ' ' + _(displayUnits) + ' ' + _('to go') );
}
}
var widthMax = 0;
for( var w = 0; w < table.length; ++w )
widthMax = Math.max( widthMax, dc.measureText(table[w]).width );
var yCur, xCur;
if( this.compassLocation[0] == 'N' )
yCur = height - tHeight * (table.length + 1);
else
yCur = tHeight+textVSpace*1.6 + tHeight * 2;
if( this.compassLocation[1] == 'E' )
xCur = width - widthMax;
else
xCur = 0;
for( var w = 0; w < table.length; ++w ) {
yCur += tHeight;
if( !table[w] )
continue;
var value = table[w];
var tShow = value.replace( /^0+/, '' );
if( tShow[0] == '.' )
tShow = '0' + tShow;
dc.fillText( tShow, xCur + dc.measureText(Array(value.length - tShow.length + 1).join('0')).width, yCur );
}
}
}
var bannerItems = [];
for( var i = 0; i < leaders.length; ++i )
bannerItems.push( [leaders[i], i+1] );
if( !isEmptyObject(numsToWatch) )
{
var rp = [];
for( var n in numsToWatch )
{
var p = riderPosition[n];
if( p != undefined )
rp.push( [p, n] );
}
rp.sort(function(x, y) { return x[0] - y[0]; });
for( var i = 0; i < rp.length; ++i )
bannerItems.push( [rp[i][1], rp[i][0]] );
}
this.drawBanner( dc, width, height, tHeight, bannerItems );
}
}
function _initAnimation()
{
tLast = (new Date).getTime();
suspendAnimation = false;
}
function NextFrame()
{
tDelta = ((new Date).getTime() - tLast);
SetTime( t + (tDelta/1000.0) * speedup );
tLast += tDelta;
if( !suspendAnimation )
{
if( t < tMax )
setTimeout( NextFrame, 1000.0 / framesPerSecond );
else if( loopContinuously && !raceIsRunning )
{
t = 0;
setTimeout( NextFrame, 1000.0 / framesPerSecond );
}
}
}
function HasDisplayUnit( aData )
{
for( var num in aData )
{
var info = aData[num];
if( info['speed'] )
return true;
}
return false;
}
function GetDistanceUnit( aData )
{
for( var num in aData )
{
var info = aData[num];
if( info['speed'] )
{
var speedUnit = info['speed'].split(' ')[1];
return (speedUnit.substring(0, 1) == 'k' ? 'km' : 'miles');
}
}
return 'km';
}
var lastRaceTime = 0;
function SetData( aData, tCur )
{
if( !catDetails )
catDetails = [];
catDetailsByName = {};
for( var i = 0; i < catDetails.length; ++i )
catDetailsByName[catDetails[i].name] = catDetails[i];
data = (aData || null);
if( tCur != undefined )
t = tCur;
var hasLapSpeeds = false;
var hasMultipleLaps = false;
lastRaceTime = 0;
for( var num in data )
{
var info = data[num];
info['iLast'] = 1;
if( info['raceTimes'] && info['raceTimes'].length > 2 )
hasMultipleLaps = true;
if( info['lapSpeeds'] )
hasLapSpeeds = true;
if( info['status'] == 'Finisher' && info['raceTimes'].length > 1 )
info['finishTime'] = info['raceTimes'].back()
else
info['finishTime'] = info['lastTime']
if( info['finishTime'] )
lastRaceTime = Math.max( info['finishTime'], lastRaceTime );
}
categories = [];
for( var i = 0; i < catDetails.length; ++i )
categories.push( catDetails[i].name );
var catHTML = '';
if( categories.length > 2 )
{
var catHTML = '<div id="buttongroup">';
for( var i = 0; i < categories.length; ++i )
{
var cat = categories[i];
catHTML +=
'<label class="green">' +
'<input ' +
'type="radio" ' +
'name="categorySelect" ' +
'id="idCat' + i + '" ' +
'onClick="SelectCategory(\''+i+'\');" ' +
(cat == categoryCur ? 'checked="true"': '') +
'/>' +
'<span>' + cat.escapeHTML() + '</span>' +
'</input>' +
'</label>';
}
catHTML += '</div><hr class="invisible"/>';
}
else if( categories.length > 1 )
catHTML = '<h2>' + categories[1].escapeHTML() + '</h2>';
document.getElementById('idCategories').innerHTML = catHTML;
var options = [
{ i:0, name:'Lap Times',	value:'showLapTimes',		requiresMultipleLaps:false, requiresLapSpeeds:false },
{ i:1, name:'Race Times',	value:'showRaceTimes',		requiresMultipleLaps:true, requiresLapSpeeds:false },
{ i:2, name:'Time Gaps',	value:'showLapGaps',		requiresMultipleLaps:true, requiresLapSpeeds:false },
{ i:3, name:'Gap Percents',	value:'showGapPercent',		requiresMultipleLaps:false, requiresLapSpeeds:false },
{ i:4, name:'Lap Speed',	value:'showLapSpeed',		requiresMultipleLaps:true, requiresLapSpeeds:true },
{ i:5, name:'Est. Distance Gap',value:'showDistanceGap',requiresMultipleLaps:true, requiresLapSpeeds:true }
];
var showOptionsSpan = document.getElementById( 'idShowOptions' );
var showHTML = '<div id="display_menu"><label class="heading" data-tr="Show:"></label><div class="buttonset">';
var firstOption = true;
for( var i = 0; i < options.length; ++i )
{
var o = options[i];
if( o.requiresMultipleLaps && !hasMultipleLaps )
continue;
if( o.requiresLapSpeeds && !hasLapSpeeds )
continue;
showHTML += '<input type="radio" name="showOptions" id="idShowOption' + i + '" onClick="SetLapDataOption('+o.i+');"';
if( firstOption )
{
showHTML += ' checked="true"';
firstOption = false;
}
showHTML += '/><label for="idShowOption' + i + '" data-tr="' + o.name +'"></label>&nbsp;';
}
showHTML += '</div></div>';
showOptionsSpan.innerHTML = showHTML;
if( animationObj != null )
animationObj.Refresh();
}
function Animate( tRunning, aTMax, tCur )
{
StopAnimate();
_initAnimation();
if( !canvas )
return;
t = (tCur || 0);
if( !data )
return;
if( aTMax == undefined )
{
tMax = 0;
for( var num in data )
if( data[num]['raceTimes'].length > 0 )
tMax = Math.max(tMax, data[num]['raceTimes'].back());
}
else
tMax = aTMax;
speedup = (raceIsRunning ? 1.0 : tMax / tRunning);
setTimeout( NextFrame, 1000.0/framesPerSecond );
}
function createChild( parent, tag )
{
var child = document.createElement(tag);
parent.appendChild( child );
return child;
}
function createTextChild( parent, s )
{
var child = document.createTextNode(s);
parent.appendChild( child );
return child;
}
var statusSortSeq = { 'Finisher':1, 'PUL':2, 'OTL':6, 'DNF':3, 'DQ':4, 'DNS':5, 'NP':7 };
function CmpResultsData( x, y )
{
var xStatus = statusSortSeq[x[4]], yStatus = statusSortSeq[y[4]];
var dStatus = xStatus - yStatus
if( dStatus != 0 )
return dStatus;
var d = x[0] - y[0];
if( d != 0 )
return -d;
if( x[4] == 'Finisher' )
return x[1] - y[1];
var d = x[5] - y[5];
if( d != 0 )
return d;
return x[2] - y[2];
}
function CmpCategoryResultsData( x, y )
{
var c = x[6] - y[6];
if( c )
return c;
return CmpResultsData( x, y );
}
function getStartOffset( num ) {
var d = data[num];
return d.raceTimes && d.raceTimes.length > 0 ? d.raceTimes[0] : 0;
}
function UpdateCatPosIndex() {
for( var c = 0; c < catDetails.length; ++c ) {
var catDetail = catDetails[c];
var posIndex = {};
var finisherCount = 0;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetail.pos[p];
var d = data[num];
if( d.status == 'Finisher' ) {
posIndex[num] = p+1;
++finisherCount;
}
}
catDetail.posIndex = posIndex;
catDetail.finisherCount = finisherCount;
}
}
function GetAllCategoryResults( num ) {
var results = [];
if( catDetails && catDetails.length > 0 ) {
if( !catDetails[0].posIndex )
UpdateCatPosIndex();
for( var c = 0; c < catDetails.length; ++c ) {
var catDetail = catDetails[c];
if( catDetail.name != 'All' && catDetail.posIndex[num] )
results.push( catDetail.posIndex[num] + '/' + catDetail.finisherCount + ' ' + catDetail.name );
}
}
return results.join( ',  ' );
}
//----------------------------------------------------------------------
function applyRAM( dest, ram ) {
var src, i, k;
src = ram.a;
for( k in src )
dest[k] = src[k];
src = ram.m;
for( k in src )
dest[k] = src[k];
src = ram.r;
for( i = src.length-1; i >= 0; --i )
delete dest[src[i]];
}
function PostMessageRefresh() {
SetData( data, undefined );
SetRaceTime();
setCategory( categoryCur );			
RefreshResultsTable();
RefreshRaceChart();
SituationRefresh();
if( animationObj )
animationObj.resetCache();		
Animate( animationSeconds, undefined, t );
}
function SyncMsgPayload( msg ) {
for( f in msg.reference )
window[f] = msg.reference[f];
}
function isCurrentResults() {
return window.location.href.indexOf("CurrentResults.html") >= 0;
}
function isPreviousResults() {
return window.location.href.indexOf("PreviousResults.html") >= 0;
}
var versionCount = 0;
function ProcessRAM( msg ) {
if( !isCurrentResults() ) {
if( raceName && msg.reference.raceName != raceName )
return true;
}
if( msg.cmd != 'ram' || msg.reference.versionCount != versionCount + 1 )
return false;
if( !data )
data = {};
applyRAM( data, msg.infoRAM );
var c, k, f;
var catDetailsCur = {};
if( catDetails )
for( c = 0; c < catDetails.length; ++c )
catDetailsCur[catDetails[c].name] = catDetails[c];
applyRAM( catDetailsCur, msg.categoryRAM );
catDetails = [];
for( k in catDetailsCur )
catDetails.push( catDetailsCur[k] );
catDetails.sort( function(a, b) {return a.iSort - b.iSort;} );
SyncMsgPayload( msg );
return true;
}
var baselinePending = false;
function ProcessBaseline( msg ) {
if( !isCurrentResults() ) {
if( msg.reference.raceName != raceName )
return true;
}
if( msg.cmd != 'baseline' )
return false;
data = msg.info;
var c, k, f;
catDetails = [];
for( k in msg.categoryDetails )
catDetails.push( msg.categoryDetails[k] );
catDetails.sort( function(a, b) {return a.iSort - b.iSort;} );
SyncMsgPayload( msg );
baselinePending = false;	
return true;
}
var websocket = null;
var timeoutID = null;
function RetryResetWebSocket() {
if( timeoutID === null )
timeoutID = setTimeout( ResetWebSocket, 5000 );
}
function ResetWebSocket() {
if( window.location.port != '8765' )	
return;
if( timeoutID !== null ) {
clearTimeout( timeoutID );
timeoutID = null;
}
if ("WebSocket" in window) {
if( websocket && websocket.readyState != websocket.CLOSED ) {
websocket.close();
websocket = null;
}
var wsurl = 'ws://' + window.location.hostname + ':' + (parseInt(window.location.port) + 1) + '/';
//var wsurl = 'ws://' + 'localhost' + ':' + (parseInt(window.location.port) + 1) + '/';
console.log( 'wsurl="' + wsurl + '"' );
websocket = new window.WebSocket( wsurl );
websocket.onmessage = function( evt ) {
var isCurResults = isCurrentResults();
var localRaceName = isCurResults ? 'CurrentResults' : raceName;
var msg = JSON.parse( evt.data );
if( !msg.reference ) {
console.log( evt.data );
return;
}
if( msg.reference.raceName == raceName || isCurResults ) {
if( msg.cmd == 'ram' ) {
if( ProcessRAM(msg) )
PostMessageRefresh();
else {
if( !baselinePending ) {
websocket.send( JSON.stringify({'cmd':'send_baseline', 'raceName':localRaceName}) );
baselinePending = true;
}
}
}
else if( msg.cmd == 'baseline' ) {
if( ProcessBaseline(msg) )
PostMessageRefresh();
}
}
else if( msg.cmd == 'reload_previous' && isPreviousResults() ) {
RefreshPayload();
}
};
websocket.onerror = function(e) {
console.log('WebSocket: Error.  Scheduling reconnect in 5 seconds...');
RetryResetWebSocket();
};
websocket.onclose = function(e) {
console.log('WebSocket: Closed.  Scheduling reconnect in 5 seconds...');
RetryResetWebSocket();
};
}
}
function CloseWebSocket() {
if( websocket )
websocket.close();
websocket = null;
}
function RefreshResultsTableArrival( raceTimesLength, raceTimesCopy )
{
var riderBib = [];		
var riderInfo = {};		
var categoryLaps;
var leaderTime;
var catTypes = (categoryCur == 'All' ? ['Start Wave', 'Component'] : ['Start Wave']);
for( var cc = 0; cc < catTypes.length; ++cc ) {
for( var c = 0; c < catDetails.length; ++c ) {
var catDetail = catDetails[c];
var catName = catDetail.name;
if( categoryCur != 'All' ) {
if( catDetail.catType != catTypes[cc] )
continue;
}
else {
if( categoryCur != catName )
continue;
}
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var d = data[num];
if( p == 0 ) {
categoryLaps = raceTimesLength[num];
leaderTime = raceTimesCopy[num].back() - raceTimesCopy[num][0];
if( d['factor'] )
leaderTime *= d.factor / 100.0;
}
if( d['status'] != 'Finisher' || riderInfo[num] || raceTimesLength[num] == 0 )
continue;
var riderLaps = raceTimesLength[num];
var riderTime = raceTimesCopy[num][raceTimesLength[num]-1] - raceTimesCopy[num][0];
if( d.factor )
riderTime *= d.factor / 100.0;
var gap = '';
var gapValue = catDetails[c].gapValue[p];
if( gapValue > 0 )
gap = FormatTimeGap( gapValue );
else if( gapValue < 0 )
gap = gapValue + ' ' + (gapValue == -1 ? _('lap') : _('laps'));
riderInfo[num] = {
'pos': p+1,
'gap': gap,
'catName': catName,
'time': riderTime,
'finishTime': d.clockStartTime + riderTime
};
riderBib.push( num );
}
}
}
riderBib.sort( function(a, b) { return riderInfo[b].finishTime - riderInfo[a].finishTime; } );
//
var curFields = {};
var allFactorsEqual = true;
var firstFactor = null;
var speedUnit = '';
var distanceUnit = '';
for( var i = 0; i < riderBib.length; ++i ) {
var num = riderBib[i];
var d = data[num];
for( var f = 0; f < infoFields.length; ++f )
if( d[infoFields[f]] )
curFields[infoFields[f]] = true;
if( d['factor'] ) {
if( firstFactor == null )
firstFactor = d['factor'];
if( firstFactor != d['factor'] )
allFactorsEqual = false;
}
if( !speedUnit && d['speed'] ) {
speedUnit = d['speed'].split(' ')[1];
distanceUnit = (speedUnit.substring(0, 1) == 'k' ? 'km' : 'miles');
}
}
var hasFactor = !allFactorsEqual;
var lastTimeField = hasFactor ? 'lastTime' : 'lastTimeOrig';
var hasFirstLastName = (curFields['FirstName'] && curFields['LastName']);
if( hasFirstLastName ) {
curFields['FirstName'] = false;
curFields['LastName'] = false;
curFields['Name'] = true;
}
curFields['Category'] = false;
var table = document.createElement('TABLE');
table.className = 'results';
thead = createChild( table, 'THEAD' );
tr = createChild( thead, 'TR' );
createTextChild( td = createChild(tr, 'TH'), _('Bib') );
td.id = 'idNonNumeric';
for( var f = 0; f < infoFields.length; ++f ) {
if( curFields[infoFields[f]] ) {
createTextChild( td = createChild(tr, 'TH'), _(infoFields[f]) );
td.id = 'idNonNumeric';
}
}
createTextChild( td = createChild(tr, 'TH'), _('Seq') );
td.id = 'idNonNumeric';
createTextChild( td = createChild(tr, 'TH'), _('CategorySummary') );
td.id = 'idNonNumeric';
createTextChild( td = createChild(tr, 'TH'), _('ClockFinishTime') );
createTextChild( td = createChild(tr, 'TH'), _('ClockStartTime') );
createTextChild( td = createChild(tr, 'TH'), _('Time') );
if( hasFactor )
createTextChild( td = createChild(tr, 'TH'), _('Factor') );
if( speedUnit )
createTextChild( td = createChild(tr, 'TH'), displayUnits == 'km' ? 'km/h' : 'mph' );
tbody = createChild( table, 'TBODY' );
for( var i = 0; i < riderBib.length; ++i ) {
var num = riderBib[i];
var info = riderInfo[num];
var d = data[num];
tr = createChild(tbody, 'TR');
tr.className = ((i & 1) ? 'odd' : 'even');
var projectedLap = (raceIsRunning && d.interp && d.laps && d.interp[d.laps]);
function createTD( tr ) {
var td = createChild(tr, 'TD');
return td;
}
createTextChild( td = createTD(tr), num );
for( var f = 0; f < infoFields.length; ++f ) {
var field = infoFields[f];
if( curFields[field] ) {
var v;
if( field == 'Name' ) {
if( d['LastName'] && d['FirstName'] )
v = d['LastName'] + ',&nbsp;' + d['FirstName'];
else
v = d['LastName'] || d['FirstName'];
}
else
v = d[field];
td = createTD(tr);
if( v && field == 'License' && licenseLinkTemplate )
v = '<a href="' + licenseLinkTemplate + v + '" target="_blank">'+v+'</a>';
td.innerHTML = v;
if( field != 'Age' && field != 'Factor' )
td.id = 'idNonNumeric'; 
}
}
createTextChild( td = createTD(tr), riderBib.length - i );
createTextChild( td = createTD(tr), GetAllCategoryResults(num) );
td.id = 'idNonNumeric';
createTextChild( td = createTD(tr), FormatTime(info.finishTime) );
createTextChild( td = createTD(tr), FormatTime(d.clockStartTime) );
createTextChild( td = createTD(tr), FormatTime(info.time) );
if( hasFactor )
createTextChild( td = createTD(tr), (d['factor'] ? d['factor'] : 100.0).toFixed(2) );
if( speedUnit ) {
var speed = d['speed'];
if( speed )
createTextChild( td = createTD(tr), FormatSpeed(parseFloat(speed.split(' ')[0]), distanceUnit, false) );
else
createTextChild( td = createTD(tr), '' );
}
}
resultsDiv.appendChild( table );
}
function GetPrimesTable( primeFromBib, pos ) {
if( !primes || primes.length == 0 )
return null;
var primesCur = [];
for( var p = 0; p < pos.length; ++p ) {
if( primeFromBib[pos[p]] != undefined )
for( var i = 0; i < primeFromBib[pos[p]].length; ++i )
primesCur.push( primeFromBib[pos[p]][i] );
}
if( primesCur.length == 0 )
return null;
primesCur.sort( function(x, y) {return x-y;} );
var hasMerchandise=false, hasCash=false, hasPoints=false, hasTimeBonus=false, hasSponsor=false, hasName=false, hasTeam=false;
for( var p = 0; p < primesCur.length; ++p ) {
var prime = primes[primesCur[p]];
var bib = prime.winnerBib;
var info = data[bib];
hasCash = (hasCash || prime.cash);
hasMerchandise = (hasMerchandise || prime.merchandise);
hasSponsor = (hasSponsor || prime.sponsor);
hasPoints = (hasPoints || prime.points);
hasTimeBonus = (hasTimeBonus || prime.timeBonus);
hasName = (hasName || (info['FirstName'] || info['LastName']));
hasTeam = (hasTeam || info['Team']);
}
var table = document.createElement('TABLE');
table.className = 'results';
var thead = createChild( table, 'THEAD' );
var tr = createChild( thead, 'TR' );
var td;
createTextChild( td = createChild(tr, 'TH'), _('Primes') );
td.style.fontSize = '120%';
td.colSpan = (1 + 1 + (hasName?1:0) + (hasTeam?1:0) + 1 + 1 + 1 +
(hasCash?1:0) + (hasMerchandise?1:0) + (hasPoints?1:0) + (hasTimeBonus?1:0) + 1);
td.id = 'idNonNumeric';
var tr = createChild( thead, 'TR' );
createTextChild( td = createChild(tr, 'TH'), '');
createTextChild( td = createChild(tr, 'TH'), _('Bib'));
if( hasName ) {
createTextChild( td = createChild(tr, 'TH'), _('Name'));
td.id = 'idNonNumeric';
}
if( hasTeam ) {
createTextChild( td = createChild(tr, 'TH'), _('Team'));
td.id = 'idNonNumeric';
}
createTextChild( td = createChild(tr, 'TH'), _('laps to go').replace(/^./, function (match) {return match.toUpperCase();}));
createTextChild( td = createChild(tr, 'TH'), _('For'));
td.id = 'idNonNumeric';
createTextChild( td = createChild(tr, 'TH'), _('Position'));
td.id = 'idNonNumeric';
if( hasCash )
createTextChild( td = createChild(tr, 'TH'), _('Cash'));
if( hasMerchandise ) {
createTextChild( td = createChild(tr, 'TH'), _('Merchandise'));
td.id = 'idNonNumeric';
}
if( hasSponsor ) {
createTextChild( td = createChild(tr, 'TH'), _('Sponsor'));
td.id = 'idNonNumeric';
}
if( hasPoints )
createTextChild( td = createChild(tr, 'TH'), _('Points'));
if( hasTimeBonus )
createTextChild( td = createChild(tr, 'TH'), _('Time Bonus'));
var tbody = createChild( table, 'TBODY' );
for( var p = 0; p < primesCur.length; ++p ) {
var prime = primes[primesCur[p]];
var bib = prime.winnerBib;
var info = data[bib];
var tr = createChild( thead, 'TR' );
createTextChild( td = createChild(tr, 'TD'), (primesCur[p]+1) + '.');
createTextChild( td = createChild(tr, 'TD'), bib );
if( hasName ) {
var s = '';
if( info.LastName )		s = info.LastName;
if( info.FirstName )	s += (s ? ', ' : '') + info.FirstName;
createTextChild( td = createChild(tr, 'TD'), s );
td.id = 'idNonNumeric';
}
if( hasTeam ) {
createTextChild( td = createChild(tr, 'TD'), info.Team ? info.Team : '' );
td.id = 'idNonNumeric';
}
createTextChild( td = createChild(tr, 'TD'), prime.lapsToGo );
createTextChild( td = createChild(tr, 'TD'), prime.effortType != 'Custom' ? _(prime.effortType) : prime.effortCustom );
td.id = 'idNonNumeric';
createTextChild( td = createChild(tr, 'TD'), prime.position ? ordinal(prime.position) : '' );
td.id = 'idNonNumeric';
if( hasCash )
createTextChild( td = createChild(tr, 'TD'), prime.cash ? prime.cash.toFixed(2) : '');
if( hasMerchandise ) {
createTextChild( td = createChild(tr, 'TD'), prime.merchandise ? prime.merchandise : '');
td.id = 'idNonNumeric';
}
if( hasSponsor ) {
createTextChild( td = createChild(tr, 'TD'), prime.sponsor ? prime.sponsor : '');
td.id = 'idNonNumeric';
}
if( hasPoints )
createTextChild( td = createChild(tr, 'TD'), prime.points ? (prime.points != parseInt(prime.points) ? prime.points.toFixed(2) : prime.points) : '');
if( hasTimeBonus )
createTextChild( td = createChild(tr, 'TD'), prime.timeBonus ? FormatTime(prime.timeBonus).replace(/\..+$/,'') : '' );
}
return table;
}
var sameValue = '"';
function RefreshResultsTable()
{
resultsDiv.innerHTML = '';
if( !data )
return;
var primeFromBib = {};
if( primes && primes.length > 0 ) {
for( var i = 0; i < primes.length; ++i ) {
var winnerBib = primes[i].winnerBib;
if( !winnerBib )
continue;
if( primeFromBib[winnerBib] )
primeFromBib[winnerBib].push( i );
else
primeFromBib[winnerBib] = [i];
}
}
var raceTimesLength = {};
var raceTimesCopy = {};
if( raceIsRunning ) {
for( var num in data ) {
var raceTimes = data[num]['raceTimes'];
var adjust = 0.0;
if( isTimeTrial ) {
adjust = data[num]['startTime'];
if( !adjust )
adjust = 0.0;
}
raceTimesLength[num] = raceTimes.binSearch( t - adjust );
raceTimesCopy[num] = raceTimes.slice(0);
}
}
else {
for( var num in data ) {
var raceTimes = data[num]['raceTimes'];
raceTimesLength[num] = raceTimes.length;
raceTimesCopy[num] = raceTimes.slice(0);
}
}
if( isTimeTrial && arrivalMode ) {
RefreshResultsTableArrival( raceTimesLength, raceTimesCopy );
return;
}
if( showLapsFrequency < 0 ) {
var maxLaps = 0;
for( var num in data ) {
if( maxLaps < raceTimesLength[num] )
maxLaps = raceTimesLength[num];
}
var showLaps = document.getElementById('idShowLaps');
for( var i = 0; i < showLaps.options.length; ++i ) {
var freqCur = parseInt(showLaps.options[i].value, 10);
if( freqCur != 0 && (~~(maxLaps / freqCur) <= 12 || i == showLaps.options.length - 1) ) {
showLaps.selectedIndex = i;
showLapsFrequency = freqCur;
break;
}
}
}
var speedUnit = '';
var distanceUnit = '';
for( var c = 0; c < catDetails.length; ++c ) {
var catDetail = catDetails[c];
var catName = catDetail.name;
if( catName == 'All' )
continue;
if( categoryCur != 'All' && categoryCur != catName )
continue;
var curFields = {};
var hasLapSpeeds = false;
var allFactorsEqual = true;
var firstFactor = null;
var showingAllLaps = true;
var starters = 0, finishers = 0, finishersPercent = 0.0;
var finishTimeLast = 'xxx', gapValueLast = -1;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var d = data[num];
if( d['factor'] ) {
if( firstFactor == null )
firstFactor = d['factor'];
if( firstFactor != d['factor'] )
allFactorsEqual = false;
}
if( !speedUnit && d['speed'] ) {
speedUnit = d['speed'].split(' ')[1];
distanceUnit = (speedUnit.substring(0, 1) == 'k' ? 'km' : 'miles');
}
if( !hasLapSpeeds && d['lapSpeeds'] )
hasLapSpeeds = true;
var raceTimes = raceTimesCopy[num];
if( raceTimesLength[num] != raceTimes.length )
showingAllLaps = false;
}
var hasFactor = !allFactorsEqual;
var lastTimeField = hasFactor ? 'lastTime' : 'lastTimeOrig';
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var d = data[num];
var lastTime = d[lastTimeField];
var raceTimes = raceTimesCopy[num];
if( raceTimes.length > 0 ) {
var firstTime = raceTimes[0];
for( var j = 0; j < raceTimes.length; ++j )
raceTimes[j] -= firstTime;
}
for( var f = 0; f < infoFields.length; ++f )
if( d[infoFields[f]] )
curFields[infoFields[f]] = true;
if( d['status'] != 'DNS' )
starters += 1;
if( d['status'] == 'Finisher' )
finishers += 1;
}
if( starters > 0 )
finishersPercent = (100.0 * finishers) / starters;
var hasFirstLastName = (curFields['FirstName'] && curFields['LastName']);
if( hasFirstLastName ) {
curFields['FirstName'] = false;
curFields['LastName'] = false;
curFields['Name'] = true;
}
var tLapMin = 100000 * 60.0 * 60.0;
var sLapMax = 0.0;
var lapMinCoords = null;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var info = data[num];
if( info.lapSpeeds ) {
var lapSpeeds = info.lapSpeeds;
for( var i = 0; i < lapSpeeds.length; ++i ) {
var s = lapSpeeds[i];
if( s > sLapMax ) {
sLapMax = s;
lapMinCoords = [p, i+1];
}
}
}
else {
var raceTimes = raceTimesCopy[num];
for( var i = 1; i < raceTimesLength[num]; ++i ) {
var tMax = Math.max(raceTimes[i] - raceTimes[i-1], 0.0);
if( tMax < tLapMin ) {
tLapMin = tMax;
lapMinCoords = [p, i];
}
}
}
}
var table = document.createElement('TABLE');
table.className = 'results';
var leaderNum = catDetails[c].pos[0];
var leaderraceTimes = raceTimesCopy[leaderNum];
var catStr = catName;
var thead = createChild( table, 'THEAD' );
var tr = createChild( thead, 'TR' );
tr.onclick = doReload;
tr.style.cursor = 'pointer';
var td;
createTextChild( td = createChild(tr, 'TH'), catName + (raceIsUnstarted ? ': ' + catDetail.pos.length + ' ' + _('registered') : '') );
var catTitleTD = td;
td.style.fontSize = '120%';
td.colSpan = 4;
td.id = 'idNonNumeric';
var tdTitle = td;
var numHeaders = 0;
thead = createChild( table, 'THEAD' );
tr = createChild( thead, 'TR' );
tr.onclick = doReload;
tr.style.cursor = 'pointer';
createTextChild( td = createChild(tr, 'TH'), _('Pos') );	++numHeaders;
createTextChild( td = createChild(tr, 'TH'), _('Bib') );	++numHeaders;
td.id = 'idNonNumeric';
for( var f = 0; f < infoFields.length; ++f ) {
if( curFields[infoFields[f]] ) {
createTextChild( td = createChild(tr, 'TH'), _(infoFields[f]) );
td.id = 'idNonNumeric';
++numHeaders;
}
}
if( showCategorySummary ) {
createTextChild( td = createChild(tr, 'TH'), _('CategorySummary') );	++numHeaders;
td.id = 'idNonNumeric';
}
if( isTimeTrial ) {
createTextChild( td = createChild(tr, 'TH'), _('ClockStartTime') );	++numHeaders;
createTextChild( td = createChild(tr, 'TH'), _('StartTime') );	++numHeaders;
createTextChild( td = createChild(tr, 'TH'), _('FinishTime') );	++numHeaders;
}
if( hasFactor ) {
createTextChild( td = createChild(tr, 'TH'), _('ElapsedTime') );	++numHeaders;
createTextChild( td = createChild(tr, 'TH'), _('Factor') );	++numHeaders;
}
createTextChild( td = createChild(tr, 'TH'), _('Time') );	++numHeaders;
if( !hasFactor )
createTextChild( td = createChild(tr, 'TH'), _('Gap') );	++numHeaders;
if( speedUnit ) {
createTextChild( td = createChild(tr, 'TH'), displayUnits == 'km' ? 'km/h' : 'mph' );
++numHeaders;
}
var categoryLaps	= raceTimesLength[leaderNum];
if( winAndOut ) {
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
if( raceTimesLength[num] && raceTimesLength[num] > categoryLaps )
categoryLaps = raceTimesLength[num];
}
}
var leaderTime	= raceTimesLength[leaderNum] ? raceTimesCopy[leaderNum][raceTimesLength[leaderNum]-1] : 99999;
if( categoryLaps > 2 && showLapsFrequency != 0 ) {
for( var i = 1; i < categoryLaps; ++i ) {
if( (i % showLapsFrequency == 0 || i == 1 || i == categoryLaps-1)  ) {
createTextChild( td = createChild(tr, 'TH'), _('Lap') + ' ' + i );
++numHeaders;
}
}
}
if( !showingAllLaps ) {
createTextChild( td = createChild(tr, 'TH'), '...' );
++numHeaders;
}
tdTitle.colSpan = numHeaders;
tbody = createChild( table, 'TBODY' );
for( var p = 0; p < catDetail.pos.length; ++p ) {
var position, num;
if( arrivalMode ) {
if( !catDetail.finisherCount )
UpdateCatPosIndex();
if( p < catDetail.finisherCount ) {
position = catDetail.finisherCount - p;
num = catDetails[c].pos[position-1];
}
else {
position = p + 1;
num = catDetails[c].pos[p];
}
}
else {
position = p + 1;
num = catDetails[c].pos[p];
}
var d = data[num];
function createTD( tr ) {
var td = createChild(tr, 'TD');
return td;
}
tr = createChild(tbody, 'TR');
tr.className = ((r & 1) ? 'odd' : 'even');
var riderLaps	= raceTimesLength[num];
var riderTime	= raceTimesLength[num] ? raceTimesCopy[num][raceTimesLength[num]-1] : 99999;
var raceTimes	= raceTimesCopy[num];
var isFinisher	= (d['status'] == 'Finisher');
var tFinish = (isFinisher ? riderTime : 0.0);
tr.onclick = function(n) { return function() {ToggleNumberHighlight(n);}; }(num);
var posText = (isFinisher ? '' + position + (data[num]['relegated'] ? ' REL' : ''): d['status'] );
createTextChild( td = createTD(tr), posText );
var a = createChild( td = createTD(tr), 'A' );
createTextChild( a, num );
if( d['status'] != 'DNS' && d['status'] != 'NP' && raceTimes.length >= 2 ) {
a.onclick = function(n) { return function() {OpenRiderDashboardViewerWindow(n);}; }(num);
a.href = 'javascript:void(0)';
}
var iFastestLap = -1, iSlowestLap = -1;
if( d.lapSpeeds && d.lapSpeeds.length > 1 ) {
iFastestLap = iSlowestLap = 0;
for( var i = 1; i < d.lapSpeeds.length; ++i ) {
if( d.lapSpeeds[i] > d.lapSpeeds[iFastestLap] )
iFastestLap = i;
if( d.lapSpeeds[i] <= d.lapSpeeds[iSlowestLap] )
iSlowestLap = i;
}
}
for( var f = 0; f < infoFields.length; ++f ) {
var field = infoFields[f];
if( curFields[field] ) {
var v;
if( field == 'Name' ) {
if( d['LastName'] && d['FirstName'] )
v = d['LastName'] + ',&nbsp;' + d['FirstName'];
else
v = d['LastName'] || d['FirstName'];
}
else
v = d[field];
td = createTD(tr);
if( v && field == 'License' && licenseLinkTemplate )
v = '<a href="' + licenseLinkTemplate + v + '" target="_blank">'+v+'</a>';
else if( field == 'UCICode' && v ) {
var img = GetFlagImage( v );
if( img ) {
span = createChild( td, 'SPAN' );
span.style.whiteSpace = "nowrap";
span.appendChild( img.cloneNode(true) );
createTextChild( span, ' ' + v );
v = null;
}
}
if( v )
td.innerHTML = v;
if( field != 'Age' && field != 'Factor' )
td.id = 'idNonNumeric'; 
}
}
if( position == 1 && isFinisher && distanceUnit && d['speed'] ) {
var tFinishStr = FormatTime( tFinish );
var dot = tFinishStr.indexOf('.');
if( dot > 0 )
tFinishStr = tFinishStr.substring(0, dot);
catStr = '';
var cd = catDetail;
if( cd.raceDistance )
catStr += _('Distance') + ': ' + FormatDistance(cd.raceDistance, cd.distanceUnit ? cd.distanceUnit : 'km', true);
if( cd.lapDistance && cd.laps > 1 ) {
if( catStr )
catStr += ', ';
if( cd.firstLapDistance && cd.firstLapDistance != cd.lapDistance ) {
catStr += (
_('1st lap') + ' ' + FormatDistance(cd.firstLapDistance, cd.distanceUnit ? cd.distanceUnit : 'km', true) + ', ' +
(cd.laps-1) + ' ' + _('more laps of') + ' ' + FormatDistance(cd.lapDistance, cd.distanceUnit ? cd.distanceUnit : 'km', true));
}
else
catStr += cd.laps + ' ' + _('laps of') + ' ' + FormatDistance(cd.lapDistance, cd.distanceUnit ? cd.distanceUnit : 'km', true);
}
if( raceStartTime ) {
if( catStr )
catStr += ', ';
catStr += _('Start') + ': ' + FormatTime(raceStartTime + cd.startOffset);
}
catStr +=  '<br/>';
catStr +=
(raceIsRunning ? _('Estimated') + ': ' : '') +
_('Winner') + ': ' + tFinishStr + ' ' + _('at') + ' ' +
FormatSpeed(parseFloat(d['speed'].split(' ')[0]), cd.distanceUnit ? cd.distanceUnit : 'km', true) + ', ' +
starters + ' ' + _('starters') + ', ' +
finishers + ' ' + _('finishers') + ' (' + finishersPercent.toFixed(1) + '%)';
catTitleTD.innerHTML = '<span class="biggerFont">' + catName +
(raceIsRunning ? " (" + _('race in progress') + ')' : '') + '</span>' +
'<br/><span class="smallfont">' + catStr + '</span>';
}
if( showCategorySummary ) {
createTextChild( td = createTD(tr), GetAllCategoryResults(num) );
td.id = 'idNonNumeric'; 
}
if( isTimeTrial ) {
createTextChild( td = createTD(tr), d['clockStartTime'] ? FormatTime(d['clockStartTime']) : '' );
createTextChild( td = createTD(tr), d['startTime'] ? FormatTime(d['startTime']) : '' );
var ttPenalty = (d['ttPenalty'] ? d['ttPenalty'] : 0.0);
createTextChild( td = createTD(tr),
(isFinisher && d['startTime'] && d['lastTimeOrig'])
? FormatTime(d['startTime']+d['lastTimeOrig']-ttPenalty)
: '' );
}
if( hasFactor ) {
var tFinishOrig = (isFinisher ? Math.max(d['lastTimeOrig'] - getStartOffset(num), 0.0) : 0.0);
var finishTimeOrig = (isFinisher ? FormatTime(tFinishOrig) : '');
createTextChild( td = createTD(tr), finishTimeOrig );
var factor = d['factor'];
if( !factor )
factor = 100.0;
createTextChild( td = createTD(tr), factor.toFixed(2) );
}
var finishTime = '';
if( isFinisher && d[lastTimeField] > 0.0 ) {
finishTime = FormatTime(d[lastTimeField] - getStartOffset(num) );
if( isTimeTrial ) {
if( d['ttPenalty'] )
finishTime += '*';
}
else {
if( roadRaceFinishTimes ) {
if( finishTime == finishTimeLast )
finishTime = sameValue;
else
finishTimeLast = finishTime;
}
}
}
createTextChild( td = createTD(tr), finishTime );
if( finishTime == sameValue )
td.className = 'same-value';
var gap = (winAndOut ? FormatTimeGap(0) : '');
var gapValue = catDetail.gapValue[position-1];
if( isFinisher ) {
if( gapValue > 0 ) {
if( roadRaceFinishTimes && gapValue == gapValueLast )
gap = sameValue;
else if( r != 0 && lapDataOption == 3 )
gap = '+' + ((100.0 * gapValue) / (leaderTime - getStartOffset(num))).toFixed(2);
else
gap = FormatTimeGap( gapValue );
}
else if( gapValue < 0 ) {
gap = gapValue + ' ' + (gapValue == -1 ? _('lap') : _('laps'));
}
else if( roadRaceFinishTimes && gapValue == 0.0 && gapValueLast == 0.0 ) {
gap = sameValue;
}
gapValueLast = gapValue;
}
if( !hasFactor ) {
createTextChild( td = createTD(tr), gap );
if( gap == sameValue )
td.className = 'same-value';
}
if( speedUnit ) {
var speed = d['speed'];
if( speed )
createTextChild( td = createTD(tr), FormatSpeed(parseFloat(speed.split(' ')[0]), distanceUnit, false) );
else
createTextChild( td = createTD(tr), '' );
}
if( categoryLaps > 2 && showLapsFrequency != 0 ) {
for( var i = 1; i < categoryLaps; ++i ) {
if( !(i % showLapsFrequency == 0 || i == 1 || i == raceTimesLength[num]-1)  )
continue
if( i >= raceTimesLength[num] ) {
createTextChild( td = createChild(tr, 'TD'), ' ' );
continue;
}
switch( lapDataOption )
{
case 0:	
createTextChild( td = createChild(tr, 'TD'), FormatTime(Math.max(raceTimes[i] - raceTimes[i-1], 0.0)) );
break;
case 1:	
createTextChild( td = createChild(tr, 'TD'), FormatTime(raceTimes[i]) );
break;
case 2:	
if( r == 0 )
createTextChild( td = createChild(tr, 'TD'), FormatTime(Math.max(raceTimes[i] - raceTimes[i-1], 0.0)) );
else {
var v = TimeDifference(raceTimes[i], raceTimesCopy[leaderNum][i]);
createTextChild( td = createChild(tr, 'TD'), FormatTimeGap(v) );
}
break;
case 3:	
if( r == 0 )
createTextChild( td = createChild(tr, 'TD'), FormatTime(Math.max(raceTimes[i] - raceTimes[i-1], 0.0)) );
else
{
var v = (100.0 * (raceTimes[i] - raceTimesCopy[leaderNum][i])) / raceTimesCopy[leaderNum][i];
var sign = '+';
if( v < 0 )
{
sign = '-';
v = -v;
}
createTextChild( td = createChild(tr, 'TD'), sign + v.toFixed(2) + '%' );
}
break;
case 4:	
createTextChild( td = createChild(tr, 'TD'), FormatSpeed(d.lapSpeeds[i-1], distanceUnit, false) );
break;
case 5: 
if( r == 0 )
createTextChild( td = createChild(tr, 'TD'), '-' );
else {
var dt = raceTimes[i] - raceTimesCopy[leaderNum][i];
var s = d.lapSpeeds && d.lapSpeeds.length >= i ? d.lapSpeeds[i-1] : 0.0;
var v = '';
if( s > 0.0 )
{
var distance = s * (dt / (60.0*60.0));
v = FormatDistanceGap( distance, distanceUnit );
}
createTextChild( td = createChild(tr, 'TD'), v );
}
break;
}
var classes = [];
var isFastestLap = (lapMinCoords && p == lapMinCoords[0] && i == lapMinCoords[1]);
if( isFastestLap )													classes.push( 'fastest' );
else { 
if( i == iFastestLap+1 )										classes.push( 'fastest-lap' );
else if( i == iSlowestLap+1 )									classes.push( 'slowest-lap' );
}
if( numsToWatch[num] )												classes.push( 'highlight' );
if( classes )	td.className = classes.join( ' ' );
}
}
if( !showingAllLaps )
createTextChild( td = createTD(tr), '' );
}
var hasTTPenalties = false;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var d = data[num];
if( d.ttPenalty ) {
hasTTPenalties = true;
break;
}
}
if( hasTTPenalties ) {
tr = createChild( tbody, 'TR' );
tr.className = 'noborder';
for( var k = 0; k < numHeaders; ++k ){
createTextChild( td = createChild(tr, 'TD'), '' );
td.innerHTML = '&nbsp;'
}
var penaltyColCount = numHeaders;
for( var f in curFields )
--penaltyColCount;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var d = data[num];
if( d.ttPenalty ) {
tr = createChild( tbody, 'TR' );
tr.className = 'noborder';
createTextChild( td = createChild(tr, 'TD'), '' );				
createTextChild( td = createChild(tr, 'TD'), '* ' + num );		
for( var f = 0; f < infoFields.length; ++f )					
{
var field = infoFields[f];
if( curFields[field] )
{
var v;
if( field == 'Name' )
{
if( d['LastName'] && d['FirstName'] )
v = d['LastName'] + ',&nbsp;' + d['FirstName'];
else
v = d['LastName'] || d['FirstName'];
}
else
v = d[field];
td = createChild(tr, 'TD');
td.innerHTML = v;
if( field != 'Age' )
td.id = 'idNonNumeric'; 
}
}
td = createChild( tr, 'TD' );
td.id = 'idNonNumeric'; 
td.setAttribute( 'colspan', penaltyColCount );
td.innerHTML = d.ttPenalty.toFixed(3) + ' sec ' + _('time penalty') + (d.ttNote ? (' - ' + d.ttNote.escapeHTML()) : '');
}
}
}
resultsDiv.appendChild( table );
var primesTable = GetPrimesTable( primeFromBib, catDetail.pos );
if( primesTable )
resultsDiv.appendChild( primesTable );
createChild(resultsDiv, 'P').innerHTML = '&nbsp;'
}
}
function byte2Hex(n) {
var nybHexString = "0123456789ABCDEF";
return String(nybHexString.substr((n >> 4) & 0x0F,1)) + nybHexString.substr(n & 0x0F,1);
}
function RGB2Color(r,g,b) {
return '#' + byte2Hex(r) + byte2Hex(g) + byte2Hex(b);
}
function makeColorGradient(frequency1, frequency2, frequency3,
phase1, phase2, phase3,
center, width, len)
{
if (len == undefined)      len = 50;
if (center == undefined)   center = 128;
if (width == undefined)    width = 127;
var grad = [];
for (var i = 0; i <= len; ++i)
{
var red = Math.sin(frequency1*i + phase1) * width + center;
var grn = Math.sin(frequency2*i + phase2) * width + center;
var blu = Math.sin(frequency3*i + phase3) * width + center;
grad.push( RGB2Color(red,grn,blu) );
}
return grad.slice(1);  
}
function lighterColor( k ) {
var s = '#';
for( var i = 0; i < 3; ++i )
{
var c = parseInt(k.substring(1 + i*2, 1 + i*2 + 2), 16);
c += (255 - c) * 0.6;
c = ~~c;
s += (c < 16 ? '0' : '') + c.toString(16);
}
return s;
}
function drawSegment( c, x, y, w, h, color, colorLighter ) {
c.save();
var gr = c.createLinearGradient( x, y, x, y+h );
gr.addColorStop(0.0, color);
gr.addColorStop(0.33, colorLighter);
gr.addColorStop(1.0, color );
c.fillStyle = gr;
c.fillRect( x, y, w, h );
if( color != '#FFFFFF' )
{
c.strokeStyle = '#000';
c.strokeRect( x, y, w, h );
}
c.restore();
}
function drawDiamond( c, xCenter, yCenter, radius ) {
c.save();
c.beginPath();
c.moveTo( xCenter + radius, yCenter );
c.lineTo( xCenter         , yCenter - radius );
c.lineTo( xCenter - radius, yCenter );
c.lineTo( xCenter         , yCenter + radius );
c.closePath();
var grd = c.createRadialGradient( 0+ xCenter, - radius*0.50 + yCenter, 0, 0 + xCenter, radius + 1 + yCenter, radius );
grd.addColorStop(0, '#FFFFFF');
grd.addColorStop(1, 'rgb(220,220,0)');
c.fillStyle = 'rgb(220,220,0)';
c.fill();
c.fillStyle = grd;
c.fill();
c.lineWidth = 1.0;
c.strokeStyle = 'rgb(128,128,128)';
c.stroke();
c.restore();
}
function drawStar( c, xCenter, yCenter, numPoints, radius, radiusInner ) {
c.save();
c.beginPath();
var angle = (Math.PI * 2.0) / numPoints;
var angle2 = angle / 2.0;
c.moveTo( 0 + xCenter, -radius + yCenter );
for( var p = 0; p < numPoints; ++p ) {
var a = p * angle + angle2 + Math.PI / 2.0;
c.lineTo( Math.cos(a) * radiusInner+ xCenter, -Math.sin(a) * radiusInner+ yCenter );
a = (p + 1) * angle + Math.PI / 2.0;
c.lineTo( Math.cos(a) * radius+ xCenter, -Math.sin(a) * radius+ yCenter );
}
c.closePath();
var grd = c.createRadialGradient( 0+ xCenter, - radius*0.50 + yCenter, 0, 0 + xCenter, radius + 1 + yCenter, radius );
grd.addColorStop(0, '#FFFFFF');
grd.addColorStop(1, 'rgb(255,165,0)');
c.fillStyle = 'rgb(255,165,0)';
c.fill();
c.fillStyle = grd;
c.fill();
c.lineWidth = 1.0;
c.strokeStyle = 'rgb(128,128,128)';
c.stroke();
c.restore();
}
var xFactorCur = 0.0;
var	barHeightCur = 0.0;
var	labelsWidthCur = 0.0;
var segmentsCur = [];
function findPos(obj) {
var curleft = curtop = 0;
if (obj.offsetParent) {
curleft = obj.offsetLeft
curtop = obj.offsetTop
while (obj = obj.offsetParent) {
curleft += obj.offsetLeft
curtop += obj.offsetTop
}
}
return [curleft,curtop];
}
var hoverTimer = null;
var xEvent = null;
var yEvent = null;
function RaceChartProcessMouse( event )
{
var canvasRaceChart = document.getElementById('idRaceChart');
var pos = findPos( canvasRaceChart );
xEvent = event.pageX - canvasRaceChart.offsetLeft;
yEvent = event.pageY - canvasRaceChart.offsetTop;
if( hoverTimer != null )
clearTimeout( hoverTimer );	
hoverTimer = setTimeout( "RaceChartUpdateInfo()", 25 );
}
function RaceChartProcessClick( event )
{
var canvasRaceChart = document.getElementById('idRaceChart');
var pos = findPos( canvasRaceChart );
xEvent = event.pageX - canvasRaceChart.offsetLeft;
yEvent = event.pageY - canvasRaceChart.offsetTop;
for( var s = 0; s < segmentsCur.length; ++s )
{
var seg = segmentsCur[s];
if( seg[0] <= xEvent && xEvent < (seg[0] + seg[2]) &&
seg[1] <= yEvent && yEvent < (seg[1] + seg[3]) )
{
var num = seg[5];
document.getElementById('idNumsToWatch').value = num + '';
SetNumsToWatch();
return;
}
}
}
function getRiderName( num ) {
var name = '';
var riderData = data[num];
if( riderData )
{
if( riderData['LastName'] )
name = riderData['LastName'];
if( riderData['FirstName'] )
{
if( name )
name = name + ', ' + riderData['FirstName'];
else
name = riderData['FirstName'];
}
}
return name;
}
function getRiderTeam( num ) {
var team = '';
var riderData = data[num];
if( riderData && riderData['Team'] )
team = riderData['Team'];
return team;
}
function getRiderNameNum( num ) {
var name = getRiderName(num);
if( name )
return name + ' ' + num;
return num + '';
}
function RaceChartUpdateInfo()
{
RefreshRaceChart();
var canvasRaceChart = document.getElementById('idRaceChart');
for( var s = 0; s < segmentsCur.length; ++s )
{
var seg = segmentsCur[s];
if( seg[0] <= xEvent && xEvent < (seg[0] + seg[2]) &&
seg[1] <= yEvent && yEvent < (seg[1] + seg[3]) )
{
var hover = seg[4];
var num = seg[5];
var name = getRiderNameNum( num );
var lap = seg[6];
hover = name + ': ' + _('Lap') + ' ' + hover;
if( showDetails ) {
var d = data[num];
if( d.interp[lap] )
hover += '\n' + _('Projected Time');
var detail = lapDetails[num + ',' + lap];
if( detail ) {
for( var dd = 0; dd < detail.length; ++dd ) {
if( detail[dd] )
hover += '\n' + detail[dd];
}
}
}
hover = hover.trim();
var splitHover = hover.split( '\n' );
var hoverLines = splitHover.length;
var fontHeight = 14;
var height = fontHeight * hoverLines + fontHeight / 2.0;
var margin = fontHeight / 4.0 - 1;
var c = canvasRaceChart.getContext('2d');
c.font = fontHeight + 'px Arial';
c.save();
c.lineWidth = 3;
c.strokeStyle = '#000';
c.strokeRect( seg[0], seg[1], seg[2]-1, seg[3]-1 );
var textWidth = 0;
for( var isp = 0; isp < splitHover.length; ++isp )
textWidth = Math.max( textWidth, c.measureText(splitHover[isp]).width );
var drawDirection = (x + textWidth > canvasRaceChart.width*0.90 ? -1 : 1);
c.lineWidth = 1;
var x = xEvent, y = yEvent;
c.fillStyle = '#FFF';
c.beginPath();
c.moveTo( x, y );
y -= fontHeight;
var yMax = y;
c.lineTo( x, y );
x += drawDirection * textWidth;
c.lineTo( x, y );
y -= height / 2;
c.arc( x, y, height / 2, Math.PI / 2, 3 * Math.PI / 2, drawDirection > 0 );
y -= height / 2;
var yMin = y;
x -= drawDirection * textWidth;
c.lineTo( x, y );
y += height / 2;
c.arc( x, y, height / 2, 3 * Math.PI / 2, drawDirection > 0 ? Math.PI : 0.0, drawDirection > 0 );
c.closePath();
c.fill();
c.stroke();
c.fillStyle = '#000';
c.textBaseline = 'top';
var yText = yMin + (yMax - yMin - splitHover.length*fontHeight) / 2;
for( var isp = 0; isp < splitHover.length; ++isp, yText += fontHeight )
c.fillText( splitHover[isp], xEvent - (drawDirection < 0 ? textWidth : 0), yText );
c.restore();
c.lineWidth = 2;
return;
}
}
}
function RefreshRaceChart()
{
var canvasRaceChart = document.getElementById('idRaceChart');
if( !data || !canvasRaceChart || !canvasSupported || winAndOut )
return;
var iFromCategory = {};
for( var i = 0; i < categories.length; ++i )
iFromCategory[categories[i]] = i;
var showStartOffsetOption = document.getElementById('idShowStartOffsetOption');
var showStartOffsetButton = document.getElementById('idShowStartOffsets');
var showStartOffsets = showStartOffsetButton.checked;
showDetails = document.getElementById('idShowDetails').checked;
var categoriesUsed = {};
var dataMax = 0;
var resultsData = [];
var lapsMax = 0;
for( var c = 0; c < catDetails.length; ++c )
{
var catDetail = catDetails[c];
var catName = catDetail.name;
if( catName == 'All' )
continue;
if( categoryCur != 'All' && categoryCur != catName )
continue;
for( var p = 0; p < catDetail.pos.length; ++p )
{
var num = catDetail.pos[p];
var d = data[num];
var raceTimes = d['raceTimes'].slice(0);	
if( catDetail.catType != 'Start Wave' && raceTimes.length > 0 )
{
for( var j = 1; j < raceTimes.length; ++j )
raceTimes[j] -= raceTimes[0];
raceTimes[0] = 0;
}
resultsData.push( [	raceTimes.length,
raceTimes.length ? raceTimes.back() : 99999,
num,
raceTimes,
d['status'],
d['finishTime'],
iFromCategory[catName]
] );
categoriesUsed[catName] = true;
if( raceTimes.length > 0 )
{
if( raceTimes.back() > dataMax )
dataMax = raceTimes.back();
if( raceTimes.length > lapsMax )
lapsMax = raceTimes.length;
}
}
}
if( resultsData.length == 0 || lapsMax == 0 )
{
canvasRaceChart.height = 8;
return;
}
var categoryCount = 0;
for( var c in categoriesUsed )
++categoryCount;
var rowMin = 14, rowMax = rowMin*2, rows = resultsData.length + categoryCount + 2;
if( canvasRaceChart.height / rows < rowMin )
canvasRaceChart.height = ~~(rowMin * rows);
else if( canvasRaceChart.height / rows > rowMax )
canvasRaceChart.height = ~~(rowMax * rows);
var width = canvasRaceChart.width;
var height = canvasRaceChart.height;
var dc = canvasRaceChart.getContext('2d');
var backColour = 'white';
dc.textBaseline = "top";
dc.fillStyle = backColour;
dc.fillRect(0, 0, width, height );
resultsData.sort( CmpCategoryResultsData );
var iNum = 2;
var iRaceTimes = 3;
var iStatus = 4;
var iCategory = 6;
showStartOffsetOption.className = 'hidden';
var startOffset = resultsData[0][iRaceTimes][0];
for( var i = 1; i < resultsData.length; ++i ) {
if( resultsData[i][iRaceTimes][0] != startOffset ) {
showStartOffsetOption.className = 'shown';
startOffset = 0.0;
break;
}
}
if( startOffset != 0.0 ) {
for( var i = 0; i < resultsData.length; ++i ) {
var raceTimes = resultsData[i][iRaceTimes];
for( var j = 0; j < raceTimes.length; ++j )
raceTimes[j] -= startOffset;
}
dataMax -= startOffset;
}
else if( !showStartOffsets ) {
dataMax = 0;
for( var i = 0; i < resultsData.length; ++i ) {
var num = resultsData[i][iNum];
var d = data[num];
var raceTimes = resultsData[i][iRaceTimes];
if( raceTimes.length > 0 ) {
startOffset = raceTimes[0];
if( startOffset ) {
for( var j = 0; j < raceTimes.length; ++j )
raceTimes[j] -= startOffset;
}
if( raceTimes.back() > dataMax )
dataMax = raceTimes.back();
}
}
}
lapsMax = resultsData.length > 0 ? resultsData[0][iRaceTimes].length : 0;
var colors = makeColorGradient(2.4,2.4,2.4,0,2,4,128,127,500);
var lighterColors = [];
for( var i = 0; i < colors.length; ++i )
lighterColors.push( lighterColor(colors[i]) );
var barHeight = ~~(height / (resultsData.length + 3 + (categoryCur == 'All' ? categories.length-1 : 0)));
if( barHeight < 4 || dataMax == 0 )
return;
barHeight = Math.min( barHeight, 18 );
var minimizeLabels = false;
var normalTextHeight = barHeight * 0.80;
var textHeight = normalTextHeight;
var fontStr = textHeight + "px Arial";
dc.font = fontStr;
var textWidthLeft = dc.measureText('0000').width;
for( var i = 0; i < resultsData.length; ++i ) {
var rd = resultsData[i];
var num = rd[iNum];
textWidthLeft = Math.max(	dc.measureText(getRiderNameNum(num) + '0:0').width,
dc.measureText(categories[rd[iCategory]] + '0:0').width,
textWidthLeft );
}
var legendSep = 4;			
var labelsWidthLeft = textWidthLeft + legendSep;
var labelsWidthRight = dc.measureText('0000').width + legendSep;
var drawLabels = true;
if( labelsWidthLeft + labelsWidthRight > width ) {
labelsWidthLeft = labelsWidthRight = 0;
drawLabels = false;
}
var xLeft = labelsWidthLeft;
var xRight = width - labelsWidthRight;
var yBottom = barHeight * (resultsData.length + categoryCount + 1);
var yTop = 2 * barHeight;
var lineWidth = 0.5;
var fontLegendStr = (normalTextHeight*.75) + "px Arial";
dc.font = fontLegendStr;
textHeight = (normalTextHeight * .75);
textWidth = dc.measureText( dataMax < 60*60 ? '00:00' : '00:00:00' ).width;
var numLabels = (xRight - xLeft) / (textWidth * 2.0);
var idealInterval = dataMax / numLabels;
var intervals = [1, 2, 5, 10, 15, 20, 30, 1*60, 2*60, 5*60, 10*60, 15*60, 20*60, 30*60, 1*60*60, 2*60*60, 4*60*60, 8*60*60, 12*60*60, 24*60*60];
for( d = 1; d < intervals.length - 1 && intervals[d] < idealInterval; ++d )
continue;
d = intervals[d];
var dFactor = (xRight - xLeft) / dataMax;
dc.strokeStyle = 'black';
dc.fillStyle = 'black';
dc.lineWidth = lineWidth;
for( var tCur = 0; tCur < dataMax; tCur += d ) {
var x = xLeft + tCur * dFactor;
var s = FormatTime(tCur);
var w = dc.measureText(s).width;
dc.fillText( s, x - w/2, barHeight + 2 );
if( !minimizeLabels )
dc.fillText( s, x - w/2, yBottom + 4 );
DrawLine( dc, x, yBottom+3, x, yTop-3 );
}
dc.font = fontStr;
textHeight = normalTextHeight;
textWidth = dc.measureText('0000').width;
dc.lineCap = 'butt';
dc.lineJoin = 'miter';
var categoryStartOffset = 0;
var xFactor = (width - labelsWidthLeft - labelsWidthRight) / dataMax;
var yLast = 2 * barHeight;
var yHighlight = null;
segmentsCur = [];
var iCategoryLast = -1;
for( var i = 0; i < resultsData.length; ++i ) {
if( i == 0 || resultsData[i][iCategory] != iCategoryLast ) {
if( !showStartOffsets )
categoryStartOffset = resultsData[i][iRaceTimes] ? resultsData[i][iRaceTimes][0] : 0;
iCategoryLast = resultsData[i][iCategory];
if( i == 0 ) {
dc.fillStyle = '#FFFFFF';
var w = dc.measureText(categories[iCategoryLast] + '0:00').width;
dc.fillRect( legendSep, yLast, w + 1, barHeight + 1 );
dc.fillStyle = '#000000';
dc.fillText( categories[iCategoryLast], legendSep, yLast - barHeight );
DrawLine( dc, 0, yLast, width - labelsWidthRight + 1, yLast );
}
else {
var negOffset = -4;
dc.fillStyle = '#FFFFFF';
dc.fillRect( negOffset, yLast, width - labelsWidthRight + 1 - negOffset, barHeight + 1 );
dc.strokeRect( negOffset, yLast, width - labelsWidthRight + 1 - negOffset, barHeight );
dc.fillStyle = '#000000';
dc.fillText( categories[iCategoryLast], legendSep, yLast );
yLast += barHeight;
}
}
yCur = yLast + barHeight;
xLast = labelsWidthLeft;
xCur = xLast;
var num = resultsData[i][iNum];
var raceTimes = resultsData[i][iRaceTimes];
if( resultsData[i][iStatus] != 'Finisher' ) {
dc.fillStyle = dnfBackgroundColour;
dc.fillRect( 0, yLast, width, yCur - yLast + 1 );
}
dc.strokeStyle = "#0F0F0F";
for( var j = 0; j < raceTimes.length; ++j ) {
if( raceIsRunning && raceTimes[j] > t )
break;
var tCur = raceTimes[j] - categoryStartOffset;
xCur = ~~(labelsWidthLeft + tCur * xFactor);
if( j == 0 ) {
dc.fillStyle = resultsData[i][iStatus] == 'Finisher' ? '#FFFFFF' : dnfBackgroundColour;
dc.fillRect( xLast, yLast, xCur - xLast + 1, yCur - yLast + 1 );
dc.strokeRect( xLast, yLast, xCur - xLast + 1, yCur - yLast + 1 );
}
else {
var riderData = data[num];
var hover = j + ', ' + FormatTime(raceTimes[j] - raceTimes[j-1]);
drawSegment( dc, xLast, yLast, xCur - xLast + 1, yCur - yLast + 1, colors[j], lighterColors[j] );
segmentsCur.push( [xLast, yLast, xCur - xLast + 1, yCur - yLast + 1, hover, num, j] );
if( showDetails ) {
var detail = lapDetails[num + ',' + j];
if( detail && detail[0] ) {
dc.fillStyle = '#000000';
dc.fillText( detail[0], xLast + 2, yLast + (yCur - yLast - textHeight) / 2 );
}
}
}
xLast = xCur;
}
xCur = ~~(labelsWidthLeft + dataMax * xFactor);
dc.fillStyle = resultsData[i][iStatus] == 'Finisher' ? '#FFFFFF' : dnfBackgroundColour;
dc.fillRect( xLast, yLast, width - xLast, yCur - yLast + 1 );
dc.strokeRect( xLast, yLast, xCur - xLast + 1, yCur - yLast + 1 );
dc.fillStyle = '#000000';
var lab = getRiderName( resultsData[i][iNum] );
if( lab )
lab += ' ' + resultsData[i][iNum];
else
lab = resultsData[i][iNum] + '';
dc.fillStyle = '#000000';
dc.fillText( lab, labelsWidthLeft - dc.measureText(lab).width - legendSep, yLast );
if( !minimizeLabels ) {
lab = resultsData[i][iNum] + '';
dc.fillText( lab, width - labelsWidthRight + legendSep, yLast );
}
if( numsToWatch[resultsData[i][iNum]] != undefined ) {
dc.save()
dc.strokeStyle = "#000000";
var lineWidth = 2;
dc.lineWidth = lineWidth;
dc.strokeRect( lineWidth / 2, yLast, width - lineWidth / 2, yCur - yLast + 1 - lineWidth );
dc.restore();
}
if( showDetails ) {
xLast = labelsWidthLeft;
xCur = xLast;
for( var j = 0; j < raceTimes.length; ++j ) {
if( raceIsRunning && raceTimes[j] > t )
break;
var tCur = raceTimes[j] - categoryStartOffset;
xCur = ~~(labelsWidthLeft + tCur * xFactor);
if( j != 0 ) {
var num = resultsData[i][iNum];
var d = data[num];
if( d && d.interp[j] )
drawDiamond( dc, xCur, (yCur + yLast) / 2.0, barHeight / 2.0 );
else {
var detail = lapDetails[num + ',' + j];
if( detail && detail[1] )
drawStar( dc, xCur, (yCur + yLast) / 2.0, 5, barHeight / 2.0, barHeight / 4.0 );
}
}
xLast = xCur;
}
}
yLast = yCur;
}
xFactorCur = xFactor;
barHeightCur = barHeight;
labelsWidthCur = labelsWidthLeft;
}
function Rect( x, y, width, height ) {
this.x = x;
this.y = y;
this.width = width;
this.height = height;
}
Rect.prototype.GetLeft = function() { return this.x; }
Rect.prototype.GetRight = function() { return this.x + this.width; }
Rect.prototype.GetTop = function() { return this.y; }
Rect.prototype.GetBottom = function() { return this.y + this.height; }
Rect.prototype.GetWidth = function() { return this.width; }
Rect.prototype.GetHeight = function() { return this.height; }
Rect.prototype.SetTop = function( y ) { this.y = y; }
Rect.prototype.SetBottom = function( y ) { this.y = y - this.height; }
Rect.prototype.SetLeft = function( x ) { this.x = x; }
Rect.prototype.SetRight = function( x ) { this.x = x - this.width; }
Rect.prototype.ContainsXY = function(x, y) {
return this.x <= x && x <= this.x + this.width && this.y <= y && y <= this.y + this.height;
}
Rect.prototype.print = function( label ) {
console.log( label + ': Rect(' + this.x + ',' + this.y + ',' + this.width + ',' + this.height + ')' );
}
Rect.prototype.Intersects = function( r ) {
return !(
r.x + r.width < this.x ||
this.x + this.width < r.x ||
r.y + r.height < this.y ||
this.y + this.height < r.y
);
}
var _resultsNums = [];
var _raceTMax = null;
var _lastCategory = '';
function GetValidResultsNums() {
if( _lastCategory == categoryCur )
return _resultsNums;
_resultsNums = [];
_raceTMax = null;
for( var c = 0; c < catDetails.length; ++c )
{
var catDetail = catDetails[c];
if( categoryCur != catDetail.name )
continue;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetail.pos[p];
var d = data[num];
var raceTimes = d['raceTimes'];
if( raceTimes && raceTimes.length >= 2 )
_resultsNums.push( num );
}
break;
}
_lastCategory = categoryCur;
return _resultsNums;
}
function GetRaceTMax() {
if( _lastCategory == categoryCur && _raceTMax != null )
return _raceTMax;
var resultsNums = GetValidResultsNums();
_raceTMax = 0.0;
for( var i = 0; i < resultsNums.length; ++i ) {
var d = data[resultsNums[i]];
if( d ) {		
var raceTimes = d['raceTimes'];
if( raceTimes.back() > _raceTMax )
_raceTMax = raceTimes.back();
}
}
return _raceTMax;
}
function ShortFormatTimeGap( t ) {
var tStr = FormatTimeGap( t );
if( tStr.substring(0, 3) == "0'0" )
tStr = tStr.substring(3);
else if( tStr.substring(0,2) == "0'" )
tStr = tStr.substring(2);
return tStr;
}
function GetLapLE( raceTimes, t ) {
var lap = raceTimes.binSearch( t );
if( lap >= raceTimes.length )
lap = raceTimes.length - 1;
return raceTimes[lap] > t ? lap-1 : lap;
}
function GetPositionSpeed( raceTimes, t ) {
var lap = GetLapLE( raceTimes, t );
var lapStartTime = raceTimes[lap];
var lapTime = 0.0;
if( lap+1 < raceTimes.length )
lapTime = raceTimes[lap+1] - raceTimes[lap];
else
lapTime = raceTimes[lap] - raceTimes[lap-1];
var speed = 1.0 / lapTime;
return {'position': lap + (t - lapStartTime) * speed, 'speed': speed};
}
function GetLeaderGap( leaderPosition, leaderSpeed, leaderRaceTimes, raceTimes, t ) {
if( !raceTimes || raceTimes.length == 0 )
return null;
if( t >= raceTimes[raceTimes.length-1] ) {
if( t >= leaderRaceTimes[leaderRaceTimes.length-1] )
return {
'gap':leaderRaceTimes.length == raceTimes.length ? raceTimes[raceTimes.length-1] - leaderRaceTimes[leaderRaceTimes.length-1] : null,
'lapsDown': raceTimes.length - leaderRaceTimes.length
};
return {'gap':null, 'lapsDown':raceTimes.length - leaderRaceTimes.length};
}
var ps = GetPositionSpeed( raceTimes, t );
var riderPosition = ps.position, riderSpeed = ps.speed;
var deltaPostion = leaderPosition - riderPosition;
var positionFraction = deltaPostion - Math.floor(deltaPostion);
if( positionFraction < 0.0 )
positionFraction += 1.0;
return {'gap':positionFraction / leaderSpeed, 'lapsDown': -Math.floor(deltaPostion)};
}
function PathFromPoints( dc, points, xTranslate, yTranslate ) {
xTranslate = xTranslate ? xTranslate : 0;
yTranslate = yTranslate ? yTranslate : 0;
dc.beginPath();
dc.moveTo( points[0][0] + xTranslate, points[0][1] + yTranslate );
for( var p = 1; p < points.length; ++p )
dc.lineTo( points[p][0] + xTranslate, points[p][1] + yTranslate );
}
function GetSituationGaps( t ) {
var BigTime = 1000.0*24.0*60.0*60.0;
var resultsNums = GetValidResultsNums();
if( resultsNums.length == 0 )
return [];
var maxLaps = 0;
for( var i = 0; i < resultsNums.length; ++i ) {
var d = data[resultsNums[i]];
if( d && d.raceTimes && d.raceTimes.length - 1 > maxLaps )
maxLaps = d.raceTimes.length - 1;
}
if( t == undefined ) {
if( raceIsRunning && timestamp ) {
var tServer = (new Date(timestamp[0]).getTime()) / 1000.0;
var tBrowser = (new Date().getTime()) / 1000.0;
while( tBrowser - tServer < 0 )
tBrowser += 60*60;
t = timestamp[1] + (tBrowser - tServer);
}
else
t = BigTime;
}
var raceTMax = GetRaceTMax();
t = Math.min( t, raceTMax );
var leaderRaceTimes = [];
for( var lap = 0; lap <= maxLaps; ++lap ) {
var tMinLap = BigTime;
for( var i = 0; i < resultsNums.length; ++i ) {
var d = data[resultsNums[i]];
if( d && d.raceTimes.length > lap && d.raceTimes[lap] < tMinLap )
tMinLap = d.raceTimes[lap];
}
leaderRaceTimes.push( tMinLap );
}
function getInfo( num, lapsDown ) {
var d = data[num];
var names = [];
if( d.LastName ) names.push( d.LastName );
if( d.FirstName ) names.push( d.FirstName.slice(0, 1) );
if( lapsDown != 0 )
num = '\u2198' + num;
return num + ' ' + names.join(',') + (lapsDown != 0 ? ' (' + lapsDown + ')': '');
}
var ps = GetPositionSpeed( leaderRaceTimes, t );
var leaderPosition = ps.position, leaderSpeed = ps.speed;
var gaps = [];
for( var i = 0; i < resultsNums.length; ++i ) {
var num = resultsNums[i];
var d = data[num];
if( d ) {
gapLapsDown = GetLeaderGap( leaderPosition, leaderSpeed, leaderRaceTimes, d.raceTimes, t );
if( gapLapsDown != null && gapLapsDown.gap != null )
gaps.push( [gapLapsDown.gap, getInfo(num, gapLapsDown.lapsDown), num] );
}
}
gaps.sort( function(a, b) { return a[0] - b[0]; } );
if( gaps.length > 0 ) {
var gapMin = gaps[0][0];
if( gapMin > 0 ) {
for( var g = 0; g < gaps.length; ++g )
gaps[g][0] -= gapMin;
}
}
var thisLap = GetLapLE(leaderRaceTimes, t);
var tCur = t;
var tAfterLeader = t - leaderRaceTimes[thisLap];
var laps = leaderRaceTimes.length - 1;
var lap = Math.min( thisLap + 1, laps );
var lapsToGo = Math.max(laps - lap, 0);
var title = 
'   ' + _('Lap') + ': ' + lap + '/' + laps + '   ' + _('Laps to go') + ': ' + lapsToGo +
'    ' + _('Race Time') + ': ' + FormatTime(tCur);
return {"gaps":gaps, "tAfterLeader":tAfterLeader, "title":title, "tCur":tCur};
}
function Situation( situationCanvas, timeRange, detailDiv) {
this.situationCanvas = situationCanvas;
this.timeRange = timeRange;
this.detailDiv = detailDiv;
var groupIndexColour = '#FFCC99';
var groupGapColour = 'rgb(255,255,102)';
var groupSizeColour = '#99CCFF';
var groupColour = 'rgb(128,128,255)';
var packColour = 'rgb(200,255,200)';
var greyPenColour = 'rgb(100,100,100, 0.64)';
var greyBrushColour = 'rgb(232,232,232)';
var blackColour = '#000000';
var whiteColour = '#FFFFFF';
this.gaps = [];
this.groupRectList = [];
this.groupFullData = [];
this.tAfterLeader = null;
this.title = null;
this.tCur = null;
this.zoom = 1.0;
this.groupClickHandler = null;
//	self.Bind(wx.EVT_LEFT_UP, self.OnMouseUp )
this.SetData = function( gaps, tAfterLeader, title, tCur ) {
this.gaps = (gaps && gaps.length > 0) ? gaps : [];
this.tAfterLeader = tAfterLeader;
this.title = title;
this.tCur = tCur;
this.DrawDetails( null, null, null, null );
this.Refresh();
}
this.SetZoom = function( zoom ) {
this.zoom = zoom;
this.Refresh();
}
this.Refresh = function() { this.Draw(); }
this.Draw = function() {
var dc = situationCanvas.getContext('2d');
var width = situationCanvas.width;
var height = situationCanvas.height;
dc.fillStyle = whiteColour;
dc.fillRect( 0, 0, width, height );
this.groupRectList = [];
this.groupFullData = [];
function SetGreyPen() { dc.strokeStyle = greyPenColour; dc.lineWidth = 1; }
var maxGapSec = 20.0*60.0*60.0;	
var groups = [];
var group = [];
var gapPrev = null;
for( var g = 0; g < this.gaps.length; ++g ) {
var gap = this.gaps[g];
if( gap[0] > maxGapSec )
break;
if( gapPrev == null || gap[0] - gapPrev[0] <= 1.0 )
group.push( gap );
else {
groups.push( group );
group = [gap];
}
gapPrev = gap;
}
if( group.length > 0 )
groups.push( group );
this.groupFullData = [];
var groupMax = 0;
var groupTimeMaxSize = null;
for( var g = 0; g < groups.length; ++g ) {
var group = groups[g];
this.groupFullData.push( group.slice() );
if( group.length > groupMax ) {
groupMax = group.length;
groupTimeMaxSize = group[0][0];
}
}
for( var i = 0; i < groups.length; ++i ) {
var group = groups[i];
if( group.length == 0 )
continue;
var groupSize = group.length;
if( group.length > 10 ) {
group = [].concat( group.slice(0,5), [[group[5][0], '...']], group.slice(group.length-5, group.length) );
}
if( i == 0 )
group.splice( 0, 0, [group[0][0], 'Lead  \u200B  ' + groupSize] );
else
group.splice( 0, 0, [group[0][0], 'Chase\u00A0' + i + '  ' + ShortFormatTimeGap(group[0][0]) + 'gap  ' + groupSize] );
groups[i] = group;
}
var fontHeight = height / 40;
if( fontHeight == 0 )
return;
var font = fontHeight + 'px Arial';
dc.font = font;
var spaceWidth = fontHeight / 2;
var boldFont = 'bold ' + fontHeight + 'px Arial';
var smallFontHeight = fontHeight * 0.75;
var smallFont = smallFontHeight + 'px Arial';
dc.font = font;
dc.fillStyle = blackColour;
dc.textBaseline = "top";
var border = Math.min( width, height ) / 25;
var xLeft = border*2;
var yTop = border*2.25 + fontHeight;
if( this.title != null )
dc.fillText( this.title, xLeft, border );
if( groups.length == 0 )
return;
function GetGroupTextExtent( group ) {
var widthMax = 0;
var widthCur;
for( var g = 0; g < group.length; ++g ) {
if( numsToWatch[group[g][2]] != undefined ) {
dc.save();
dc.font = boldFont;
widthCur = dc.measureText(group[g][1]).width;
dc.restore();
}
else
widthCur = dc.measureText(group[g][1]).width;
widthMax = Math.max( widthMax, widthCur );
}
return {"width":widthMax, "height":group.length*fontHeight*1.1};
}
var lastWidth = GetGroupTextExtent( groups[groups.length-1] ).width;
var xRight = width - border - lastWidth;
var yBottom = height - border;
var gapMax = 0.0;
if( groups.length > 0 && groups[0].length > 0 ) {
var groupFirst = groups[0], groupLast = groups[groups.length-1];
var tFirst = groupFirst[0][0];
var tLast = groupLast[groupLast.length-1][0];
gapMax = tLast - tFirst;
}
var xScale = (xRight - xLeft) / (gapMax != 0.0 ? gapMax : 1.0) * this.zoom;
function drawFinishLine() {
if( this.tAfterLeader == null )
return;
var x = xLeft + this.tAfterLeader * xScale;
var flWidth = width / 32;
if( x - flWidth > width )
return;
var flTop = yTop - border / 2;
var flBottom = flTop + border;
dc.strokeStyle = 'rgb(220,220,220)';
dc.lineWidth = Math.max(width / 800, 1);
dc.fillStyle = whiteColour;
dc.fillRect( x - flWidth / 2, flTop, flWidth, flBottom - flTop );
dc.strokeRect( x - flWidth / 2, flTop, flWidth, flBottom - flTop );
dc.lineWidth = flWidth / 4;
dc.lineCap = 'butt';
DrawLine( dc, x, flTop, x, flBottom );
dc.fillStyle = whiteColour;
dc.fillRect( width-border, 0, width, height );
}
drawFinishLine();
dc.strokeStyle = blackColour;
dc.lineWidth = 1;
dc.fillStyle = blackColour;
DrawLine( dc, xLeft - border, yTop, width-border, yTop );
var arrowLength = border * 0.8;
var points = [[0,0], [arrowLength, arrowLength/4], [arrowLength, -arrowLength/4]];
PathFromPoints( dc, points, border/2, yTop ); dc.closePath();
dc.fill();
dc.stroke();
SetGreyPen();
var groupTitleBrushes = [
groupIndexColour,
groupGapColour,
groupSizeColour,
];
var existingRects = [];	
var groupHeight = height / 40;
var groupRectList = [];
for( var g = 0; g < groups.length; ++g ) {
var group = groups[g];
var xBegin = xLeft + group[0][0] * xScale;
var xEnd = xLeft + group[group.length-1][0] * xScale;
dc.fillStyle = groupColour;
dc.fillRect( xBegin - groupHeight/2, yTop - groupHeight/2, xEnd - xBegin + groupHeight, groupHeight );
dc.strokeStyle = blackColour;
dc.lineCap = 'butt';
dc.lineWidth = height / 100;
DrawLine( dc, xBegin, yTop, xEnd, yTop );
var xText = xBegin;
var yText = yTop + groupHeight/2 + fontHeight;
var gte = GetGroupTextExtent( group );
var gWidth = gte.width;
var gHeight = gte.height;
var gRect = new Rect( xText, yText, gWidth + spaceWidth*2, gHeight + fontHeight*0.6 );
var conflict = true;
while( conflict ) {
conflict = false;
for( var ir = 0; ir < existingRects.length; ++ir ) {
var r = existingRects[ir];
if( r.GetRight() < gRect.GetLeft() )
break;
if( r.Intersects(gRect) ) {
gRect.SetTop( r.GetBottom()+1 );
conflict = true;
}
}
}
existingRects.push( gRect );
for( var i = existingRects.length-2; i >= 0;  --i ) {
if( existingRects[i].GetRight() < existingRects[i+1].GetRight() )
existingRects.swap(i, i+1);
else
break;
}
groupRectList.push( [group, gRect] );
}
SetGreyPen();
for( var g = 0; g < groupRectList.length; ++g ) {
var gRect = groupRectList[g][1];
DrawLine( dc, gRect.GetLeft(), yTop, gRect.GetLeft(), gRect.GetTop() );
}
dc.textBaseline = "top";
for( var ig = 0; ig < groupRectList.length; ++ig ) {
var group = groupRectList[ig][0], gRect = groupRectList[ig][1];
SetGreyPen();
dc.fillStyle = group[0][0] != groupTimeMaxSize ? greyBrushColour : packColour;
dc.fillRect( gRect.GetLeft(), gRect.GetTop(), gRect.GetWidth()-1, gRect.GetHeight()-fontHeight/2, fontHeight/3 );
dc.strokeRect( gRect.GetLeft(), gRect.GetTop(), gRect.GetWidth()-1, gRect.GetHeight()-fontHeight/2, fontHeight/3 );
var xText = gRect.GetLeft();
SetGreyPen();
dc.fillStyle = blackColour;
var yText = gRect.GetTop()
for( var i = 0; i < group.length; ++i ) {
var gap = group[i];
if( i == 0 ) {
var title = gap[1];
var fieldWidths = [-spaceWidth+2];
var iSpace = 0;
while( true ) {
var iSpace = title.indexOf( '  ', iSpace );
if( iSpace < 0 ) {
fieldWidths.push( dc.measureText(title).width + spaceWidth );
break;
}
fieldWidths.push( dc.measureText(title.slice(0,iSpace)).width + spaceWidth );
iSpace += 1;
}
fieldWidths[fieldWidths.length-1] += spaceWidth/2;
var iBrush = (fieldWidths.length > 2 ? 0 : 2);
var xLast = xText;
for( var iField = 1; iField < fieldWidths.length; ++iField ) {
var tWidth = fieldWidths[iField] - fieldWidths[iField-1]
dc.fillStyle = groupTitleBrushes[iBrush];
dc.fillRect( xLast, yText, tWidth, fontHeight*1.08 );
dc.strokeRect( xLast, yText, tWidth, fontHeight*1.08 );
iBrush += 1;
xLast += tWidth;
}
}
dc.fillStyle = blackColour;
if( numsToWatch[gap[2]] != undefined ) {
dc.save();
dc.font = boldFont;
dc.fillText( gap[1], xText + spaceWidth, yText+fontHeight*0.07 );
dc.restore();
}
else
dc.fillText( gap[1], xText + spaceWidth, yText+fontHeight*0.07 );
yText += fontHeight*1.1;
}
}
this.groupRectList = groupRectList;
SetGreyPen();
dc.fillStule = greyBrushColour;
dc.font = smallFont;
var yUp = yTop - groupHeight - smallFontHeight
var yText = yUp + smallFontHeight/2;
var yTextCenter = yText + smallFontHeight * 0.5;
yUp += smallFontHeight/4;
var arrowLength = smallFontHeight * 0.75;
var leftArrow = [[0,0], [arrowLength, arrowLength/4], [arrowLength, -arrowLength/4]];
var rightArrow = [[0,0], [-arrowLength, arrowLength/4], [-arrowLength, -arrowLength/4]];
dc.textBaseline = "middle";
for( var iGroup = 1; iGroup < groups.length; ++iGroup ) {
var groupPrev = groups[iGroup-1], groupNext = groups[iGroup];
var tPrev = groupPrev[groupPrev.length-1][0], tNext = groupNext[0][0];
var xPrev = xLeft + tPrev * xScale, xNext = xLeft + tNext * xScale;
var sepStr = ShortFormatTimeGap(tNext - tPrev);
var tWidth = dc.measureText( sepStr ).width;
if( xNext - xPrev < tWidth * 1.25 )
continue;
DrawLine( dc, xPrev, yTop, xPrev, yUp );
DrawLine( dc, xNext, yTop, xNext, yUp );
if( xNext - xPrev > tWidth + arrowLength * 4 ) {
DrawLine( dc, xPrev, yTextCenter, xPrev + (xNext - xPrev - tWidth) / 2 - 2, yTextCenter );
DrawLine( dc, xNext - (xNext - xPrev - tWidth) / 2 + 2, yTextCenter, xNext, yTextCenter );
PathFromPoints( dc, leftArrow, xPrev, yTextCenter ); dc.closePath(); dc.stroke(); dc.fill();
PathFromPoints( dc, rightArrow, xNext, yTextCenter ); dc.closePath(); dc.stroke(); dc.fill();
}
dc.fillStyle = blackColour;
dc.fillText( sepStr, xPrev + (xNext - xPrev - tWidth) / 2, yTextCenter );
}
}
this.processClick = function( event ) {
var rect = this.situationCanvas.getBoundingClientRect();
var xEvent = event.clientX - rect.left;
var yEvent = event.clientY - rect.top;
for( var i = 0; i < this.groupRectList.length; ++i ) {
var gRect = this.groupRectList[i][1];
if( gRect.ContainsXY( xEvent, yEvent ) ) {
this.DrawDetails( gRect, i, this.groupFullData[i], this.tCur, null );
return;
}
}
this.DrawDetails( null, null, null, null );
}
this.DrawDetails = function( gRect, groupIndex, groupInfo, raceTime, clockTime ) {
this.detailDiv.innerHTML = '';
if( groupIndex == undefined || groupIndex == null ) {
var text = '\u25C0&nbsp;&nbsp;' + _('TimeSliderInstructions') + '<br/><br/><br/><br/><br/>\u25C0&nbsp;&nbsp;' + _('ClickGroupInstructions');
var para = createChild( this.detailDiv, 'p' );
para.innerHTML = text;
para.id = 'detailTitle';
return;
}
var bigSpace = '&nbsp;&nbsp;&nbsp;&nbsp;';
var title = 
(groupIndex != 0 ? _('Chase Group') + ': ' + groupIndex : _('Leaders') + ': \u2714') + 
(groupIndex != 0 ? bigSpace + _('Gap') + ': ' + ShortFormatTimeGap(groupInfo[0][0]) : '') +
bigSpace +_('Size') + ': ' + groupInfo.length + 
(raceTime != null ? bigSpace + _('Race Time') + ': ' + FormatTime(raceTime) : '' ) + 
(clockTime != null ? bigSpace + _('Clock') + ': ' + FormatTime(clockTime) : '' );
var para = createChild( this.detailDiv, 'p' );
para.innerHTML = title;
para.id = 'detailTitle';
var nums = [];
var lapsDown = {};
var sequence = {};
var numGap = {};
for( var i = 0; i < groupInfo.length; ++i ) {
var gap = groupInfo[i][0];
var info = groupInfo[i][1];
var fields = info.split(' ');
var num = parseInt( fields[0].replace(/\D/g,'') );
var lastField = fields[fields.length-1];
if( lastField.slice(0, 1) == '(' && lastField.slice(-1) == ')')
lapsDown[num] = lastField.slice(1).slice(0, -1);
nums.push( num );
numGap[num] = gap;
sequence[num] = i+1;
}
var detailFields = infoFields.slice();
var curFields = {'Seq':true, 'Gap':true, 'Bib':true, 'LapsDown':true};
for( var i = 0; i < nums.length; ++i ) {
var num = nums[i];
var d = data[num];			
for( var f = 0; f < detailFields.length; ++f )
if( d[infoFields[f]] )
curFields[infoFields[f]] = true;
}
var hasFirstLastName = (curFields['FirstName'] && curFields['LastName']);
if( hasFirstLastName ) {
curFields['FirstName'] = false;
curFields['LastName'] = false;
curFields['Name'] = true;
}
detailFields.splice( 0, 0, 'Seq', 'Bib' );
var numericFields = {'Seq':true, 'Bib':true, 'LapsDown':true, 'Age':true};
for( var n in lapsDown ) {
var iInsert = 2;
for( var i = 0; i < detailFields.length; ++i ) {
if( detailFields[i] == 'Name' ) {
iInsert = i + 1;
break;
}
}
detailFields.splice( iInsert, 0, 'LapsDown' );
break;
}
var table = createChild( this.detailDiv, 'TABLE');
table.className = 'results';
var thead = createChild( table, 'THEAD' );
var tr = createChild( thead, 'TR' );
for( var f = 0; f < detailFields.length; ++f ) {
var field = detailFields[f];
if( curFields[field] ) {
createTextChild( td = createChild(tr, 'TH'), _(detailFields[f]) );
td.id = 'idNonNumeric';
}
}
var tbody = createChild( table, 'TBODY' );
for( var i = 0; i < nums.length; ++i ) {
var num = nums[i];
var d = data[num];			
function createTD( tr ) {
var td = createChild(tr, 'TD');
if( numsToWatch[num] )
td.className = 'highlight';
return td;
}
var tr = createChild(tbody, 'TR');
tr.onclick = function(n) { return function() {ToggleNumberHighlight(n);}; }(num);
for( var f = 0; f < detailFields.length; ++f ) {
var field = detailFields[f];
if( curFields[field] ) {
var v;
if( field == 'Seq' )
v = i+1;
else if( field == 'Bib' )
v = num;
else if( field == 'LapsDown' )
v = lapsDown[num] != undefined ? lapsDown[num] : '';
else if( field == 'Name' ) {
if( d['LastName'] && d['FirstName'] )
v = d['LastName'] + ',&nbsp;' + d['FirstName'];
else
v = d['LastName'] || d['FirstName'];
}
else
v = d[field];
td = createTD(tr);
td.innerHTML = v;
if( !numericFields[field] )
td.id = 'idNonNumeric'; 
}
}
}
createChild( this.detailDiv, 'hr' );
}
}
function pDistanceSquared(x, y, x1, y1, x2, y2) {
var A = x - x1, B = y - y1, C = x2 - x1, D = y2 - y1;
var dot = A * C + B * D;
var len_sq = C * C + D * D;
var param = -1;
if (len_sq != 0) 
param = dot / len_sq;
var xx, yy;
if (param < 0) {
xx = x1;
yy = y1;
}
else if (param > 1) {
xx = x2;
yy = y2;
}
else {
xx = x1 + param * C;
yy = y1 + param * D;
}
var dx = x - xx;
var dy = y - yy;
return dx * dx + dy * dy;
}
var dnfBackgroundColour = "#E0E0E0";
function LapChart( ) {
this.lineColours = [
"#3A3312",
"#9756EF",
"#00D222",
"#69D2FD",
"#F04403",
"#FE3D94",
"#0EAB6E",
"#301F5B",
"#CDA303",
"#2C6900",
"#45DD97",
"#E8B8A4",
"#D629BD",
"#0AA2A1",
"#C30043",
"#53131A",
"#784B07",
"#395B8F",
"#284299",
"#F4B478",
"#993AAE",
"#13A3E7",
"#340631",
"#F25DEE"
];
this.lapLineColour = '#B0B0B0';
this.positionBackgroundColour = '#B7B7B7';
this.positionHorizontalLineColor = '#B9B9B9';
this.topCornerBackgroundColour = '#8E8C8D';
this.legendBackgroundColour = '#C8C8C8';
this.lappedBackgroundColour = '#D8E6F4';
this.lapLabelBorderColour = '#707070';
this.primeColour = '#FFFFAA';
this.regularLineWidth = 3;
this.selectedLineWidth = 7;
this.rowHeight = 22;
this.canvas = null;
this.data = [];
this.lapsMax = 0;
this.numSelect = null;
this.moveTimer = null;
this.doMouseMove = function( evt ) {
var numSelectOld = this.numSelect;
this.numSelect = null;
var rect = this.canvas.getBoundingClientRect();
var x = evt.clientX - rect.left, y = evt.clientY - rect.top;
for( var c = 0; c < this.data.length; ++c ) {
if( !(this.data[c].yTop <= y && y < this.data[c].yTop + this.data[c].height) )
continue;
if( this.data[c].xRight <= x ) {
var i = parseInt(((y - this.data[c].yTop) / this.rowHeight) - 1);
if( 0 <= i && i < this.data[c].nums.length )
this.numSelect = this.data[c].nums[i];
break;
}
if( this.data[c].xLeft <= x ) {
var numPos = this.data[c].numPos;
var lapsData = this.data[c].lapsData;
var xLeft = this.data[c].xLeft, xRight = this.data[c].xRight, lapWidth = this.data[c].lapWidth;
var yTop = this.data[c].yTop;
var rowHeight = this.rowHeight;
var lap = parseInt((x - xLeft) / lapWidth);
function getX(lap) { return xLeft + lap * lapWidth; }
function getY(pos) { return yTop + rowHeight * (pos + 1); }
function getSegment( lapCur, j ) {
if( !lapsData[lapCur] || !lapsData[lapCur][j] )
return null;
var num = lapsData[lapCur][j].num;
var x1, y1;
if( lapCur == 0 ) {
x1 = getX(0);
y1 = getY(numPos[num][0]) + rowHeight/2;
}
else {
x1 = getX(lapCur-1) + lapWidth/2;
y1 = getY(numPos[num][lapCur-1]) + rowHeight/2;
}
var x2 = getX(lapCur) + lapWidth/2;
var y2 = getY(numPos[num][lapCur]) + rowHeight/2;
return {'x1':x1, 'y1':y1, 'x2':x2, 'y2':y2, 'num':num};
}
var dBest = Number.MAX_VALUE;
for( var j = 0; j < lapsData[lap].length; ++j ) {
for( var lapCur = lap; lapCur < lap + 2; ++lapCur ) {
var segment = getSegment( lapCur, j );
if( segment !== null ) {
var dCur = pDistanceSquared( x, y, segment.x1, segment.y1, segment.x2, segment.y2 );
if( dCur < dBest ) {
dBest = dCur;
this.numSelect = segment.num;
}
}
}
}
break;
}
}
if( numSelectOld != this.numSelect )
this.draw();
}
this.onMouseMove = function( evt ) {
if( this.moveTimer ) {
if( this.numSelect ) {
this.numSelect = null;
this.draw();
}
clearTimeout( this.moveTimer );
}
var that = this;
this.moveTimer = setTimeout( function() { that.doMouseMove(evt); that.moveTimer=null; }, 25 );
}
this.init = function( canvas ) {
this.canvas = canvas;
var that = this;
this.canvas.addEventListener( 'mousemove', function(evt) {that.onMouseMove(evt);} );
}
this.getData = function() {
this.data = [];
this.lapsMax = 0;
for( var c = 0; c < catDetails.length; ++c )
{
var catDetail = catDetails[c];
var catName = catDetail.name;
if( catName === 'All' )
continue;
if( categoryCur !== 'All' && categoryCur !== catName )
continue;
var lapsData = [];
var numIndex = {};
var nums = [];
for( var p = 0; p < catDetail.pos.length; ++p )
{
var num = catDetail.pos[p];
if( num in numIndex )
continue;
var d = data[num];
var raceTimes = d['raceTimes'].slice(0);	
if( raceTimes.length === 0 )
continue
numIndex[num] = nums.length;
nums.push( num )
if( catDetail.catType != 'Start Wave' && raceTimes.length > 0 ) {
for( var j = 1; j < raceTimes.length; ++j )
raceTimes[j] -= raceTimes[0];
raceTimes[0] = 0;
}
for( var j = 1; j < raceTimes.length; ++j ) {
if( raceIsRunning && raceTimes[j] > t )
break;
while( lapsData.length < j )
lapsData.push( [] );
lapsData[j-1].push( {'raceTime':raceTimes[j], 'num':num, 'lapsDown':0} );
}
this.lapsMax = Math.max( this.lapsMax, raceTimes.length-1 );
}
for( var lap = 0; lap < lapsData.length; ++lap )
lapsData[lap].sort( function(x, y) { return x.raceTime - y.raceTime; } );
for( var lap = 0; lap < lapsData.length-1; ++lap ) {
for( var j = lapsData[lap].length-1; j > 0; --j ) {
for( var lapNext = lap+1; lapNext < lapsData.length && lapsData[lap][j].raceTime > lapsData[lapNext][0].raceTime; ++lapNext )
--lapsData[lap][j].lapsDown;
if( lapsData[lap][j] === 0 )
break;
}
}
var numPos = {};
for( var lap = 0; lap < lapsData.length; ++lap ) {
for( var pos = 0; pos < lapsData[lap].length; ++pos ) {
var num = lapsData[lap][pos].num;
if( num in numPos )
numPos[num].push( pos );
else
numPos[num] = [pos];
}
}
if( lapsData.length > 1 && nums.length > 1 )
this.data.push( {'lapsData': lapsData, 'numPos': numPos, 'nums': nums, 'catName':catName} );
}
}
this.draw = function() {
if( !this.canvas )
return;
var that = this;
this.getData();
if( this.data.length == 0 || this.lapsMax <= 1 ) {
this.canvas.height = 0;
return;
}
var primeLaps = {};
if( primes && primes.length > 0 ) {
var lapsMax = 0;
for( var c = 0; c < this.data.length; ++c ) {
lapsMax = Math.max( lapsMax, this.data[c].lapsData.length );
}
for( var i = 0; i < primes.length; ++i )
primeLaps[lapsMax-primes[i].lapsToGo-1] = true;
}
var rowsTotal = 0;
for( var c = 0; c < this.data.length; ++c ) {
rowsTotal += this.data[c].nums.length + 1.5 + 2;
}
var rowHeight = this.rowHeight;
this.canvas.height = rowHeight * rowsTotal;
var width = this.canvas.width;
var dc = this.canvas.getContext('2d');
dc.setTransform( 1, 0, 0, 1, 0, 0 );
for( var c = 0; c < this.data.length; ++c ) {
var lapsData = this.data[c].lapsData;
var numPos = this.data[c].numPos;
var nums = this.data[c].nums;
var rowTextFraction = 0.7;
var fontHeight = rowHeight * rowTextFraction;
dc.font = fontHeight + 'px Arial';
dc.translate( 0, rowHeight / 2 );
var yTop = rowHeight / 2;
dc.fillStyle = '#000000';
dc.textBaseline = 'middle';
dc.textAlign = 'left';
dc.fillText( this.data[c].catName, 0, rowHeight / 2 );
dc.translate( 0, rowHeight );
yTop += rowHeight;
var height = rowHeight * (nums.length + 2);
this.data[c].yTop = (c == 0 ? yTop : this.data[c-1].yTop + this.data[c-1].height + yTop);
this.data[c].height = height;
function getName( num ) {
var d = data[num];
var name = '';
if( d.LastName && d.FirstName ) name = d.LastName + ', ' + d.FirstName;
else if( d.LastName ) name = d.LastName;
else if( d.FirstName ) name = d.FirstName;
return name;
}
var numWidth = 0;
var nameWidth = 0;
for( var j = 0; j < nums.length; ++j ) {
var num = nums[j];
numWidth = Math.max( dc.measureText(''+num).width, numWidth );
nameWidth = Math.max( dc.measureText(getName(num)).width, nameWidth );
}
var paddingWidth = dc.measureText('  ').width;
nameWidth += paddingWidth;
var posWidth = dc.measureText(''+(nums.length+1) ).width + paddingWidth;
var swatchColWidth = rowHeight;
var xLeft = posWidth;
var xRight = width - (swatchColWidth + numWidth + nameWidth + posWidth);
this.data[c].xLeft = xLeft;
this.data[c].xRight = xRight;
var lapsWidth = xRight - xLeft;
var lapWidth = lapsWidth / lapsData.length;
this.data[c].lapWidth = lapWidth;
dc.clearRect(0, 0, width, height);
if( nums.length === 0 )
return;
height = rowHeight * (nums.length + 1);
dc.lineCap = 'butt';
dc.lineJoin = 'round';
dc.setLineDash( [] );
function getY(row) { return rowHeight * (row+1); }
function getX(lap) { return xLeft + lapWidth * lap; }
var hasPrimes = false;
dc.lineWidth = 1;
dc.fillStyle = this.primeColour;
for( var lap = 0; lap < lapsData.length; ++lap ) {
if( lap in primeLaps ) {
dc.fillRect( getX(lap), getY(0), lapWidth, getY(nums.length) - getY(0) );
hasPrimes = true;
}
}
var hasLapped = false;
dc.fillStyle = this.lappedBackgroundColour;
for( var lap = 0; lap < lapsData.length; ++lap ) {
for( var row = 0; row < lapsData[lap].length; ++row ) {
if( lapsData[lap][row].lapsDown !== 0 ) {
hasLapped = true;
for( ; row < nums.length; ++row )
dc.fillRect( getX(lap), getY(row), lapWidth, rowHeight );
}
}
}
dc.fillStyle = this.legendBackgroundColour;
dc.fillRect( 0, 0, width, rowHeight );
dc.fillRect( 0, getY(nums.length), width, rowHeight );
dc.fillRect( 0, 0, xLeft, height );
dc.fillRect( width - posWidth, 0, xLeft, height );
dc.fillStyle = '#FFFFFF';
dc.textBaseline = 'middle';
dc.textAlign = 'center';
for( var j = 0; j < nums.length; ++j ) {
dc.fillText( ''+(j+1), posWidth/2, getY(j) + rowHeight/2 );
if( data[nums[j]].status == 'Finisher' )
dc.fillText( ''+(j+1), width - posWidth/2, getY(j) + rowHeight/2 );
}
dc.lineWidth = 1;
dc.strokeStyle = this.lapLineColour;
for( var lap = 0; lap <= lapsData.length; ++lap ) {
dc.beginPath();
dc.moveTo( getX(lap), 0 );
dc.lineTo( getX(lap), height );
dc.stroke();
}
dc.fillStyle = dnfBackgroundColour;
for( var j = 0; j < nums.length; ++j ) {
var d = data[nums[j]];
if( nums[j] == this.numSelect ) {
dc.save();
dc.fillStyle = '#FFFF66';
dc.fillRect( xRight, getY(j), width-xRight-posWidth, rowHeight );
dc.restore();
}
else if( d.status !== 'Finisher' )
dc.fillRect( xRight, getY(j), width-xRight-posWidth, rowHeight );
}
dc.fillStyle = '#000000';
dc.textAlign = 'right';
var xText = width - nameWidth - posWidth;
for( var j = 0; j < nums.length; ++j )
dc.fillText( nums[j], xText, getY(j) + rowHeight/2 );
dc.textAlign = 'left';
var xText =  width - nameWidth - posWidth + paddingWidth/2;
for( var j = 0; j < nums.length; ++j )
dc.fillText( getName(nums[j]), xText, getY(j) + rowHeight/2 );
function drawPath( j, colour ) {
var num = nums[j];
var path = numPos[num];
dc.strokeStyle = colour ? colour : that.lineColours[j % that.lineColours.length];
dc.setLineDash( [] );
dc.beginPath();
dc.moveTo( getX(0), getY(path[0])+rowHeight/2 );
dc.lineTo( getX(0) + lapWidth/2, getY(path[0])+rowHeight/2 );
var lap;
for( lap = 1; lap < path.length; ++lap )
dc.lineTo( getX(lap) + lapWidth/2, getY(path[lap])+rowHeight/2 );
var lap = path.length-1;
dc.stroke();
if( lap != lapsData.length-1 )
dc.setLineDash( [10, 5] );
dc.beginPath();
dc.moveTo( getX(lap) + lapWidth/2, getY(path[lap])+rowHeight/2 );
dc.quadraticCurveTo( getX(lap) + lapWidth/2, getY(j) + rowHeight/2, xRight+ + rowHeight/2, getY(j) + rowHeight/2 );
dc.stroke();
}
dc.lineWidth = this.regularLineWidth;
dc.lineCap = 'round';
var jSelect = null;
for( var j = nums.length - 1; j >= 0; --j ) {
if( nums[j] === this.numSelect )
jSelect = j;
drawPath( j );
}
if( jSelect !== null ) {
dc.lineWidth = this.selectedLineWidth + 4;
drawPath( jSelect, '#FFFF00' );
dc.lineWidth = this.selectedLineWidth;
drawPath( jSelect );
}
var swatchSize = rowHeight * rowTextFraction;
var swatchBorder = (rowHeight - swatchSize) / 2.0;
var swatchX = xRight + swatchBorder;
for( var j = 0; j < nums.length; ++j ) {
dc.fillStyle = this.lineColours[j % this.lineColours.length];
dc.fillRect( swatchX, getY(j) + swatchBorder, swatchSize, swatchSize );
}
var lapNumHeight = fontHeight;
dc.font = lapNumHeight*0.8 + 'px Arial';
dc.textAlign = 'center';
dc.textBaseline = 'bottom';
dc.lineWidth = 1;
dc.setLineDash( [] );
var xLast = width;
for( var lap = lapsData.length - 1; lap >= 0; --lap ) {
var sLap = ' ' + (lap+1) + ' ';
var tWidth = dc.measureText(sLap).width;
var xMiddle = getX(lap) + lapWidth/2;
if( xMiddle + tWidth / 2 > xLast )
continue;
var x = getX(lap) + lapWidth/2;
var y = getY(0) - lapNumHeight;
dc.beginPath()
dc.moveTo( x - tWidth/2, y );
dc.lineTo( x + tWidth/2, y );
dc.lineTo( x + tWidth/2, y + lapNumHeight );
dc.lineTo( x, y + lapNumHeight * 1.25 );
dc.lineTo( x - tWidth/2, y + lapNumHeight );
dc.closePath();
dc.fillStyle = '#FFFFFF';
dc.fill();
dc.strokeStyle = this.lapLabelBorderColour;
dc.stroke();
dc.fillStyle = '#000000';
dc.fillText( sLap, getX(lap) + lapWidth/2, getY(0) );
xLast = xMiddle - tWidth/2 - 2;
}
dc.font = fontHeight + 'px Arial';
dc.textAlign = 'left';
dc.textBaseline = 'middle';
var x = xRight;
if( hasLapped ) {
var s = _('Lapped') || 'Lapped';
x -= dc.measureText(s).width;
dc.fillStyle = '#000000';
dc.fillText( s, x, getY(nums.length) + rowHeight/2 );
x -= rowHeight * 1.2;
dc.fillStyle = this.lappedBackgroundColour;
dc.fillRect( x + swatchBorder, getY(nums.length) + swatchBorder, swatchSize, swatchSize );
x -= rowHeight;
}
if( hasPrimes ) {
var s = _('Prime') || 'Prime';
x -= dc.measureText(s).width;
dc.fillStyle = '#000000';
dc.fillText( s, x, getY(nums.length) + rowHeight/2 );
x -= rowHeight * 1.2;
dc.fillStyle = this.primeColour;
dc.fillRect( x + swatchBorder, getY(nums.length) + swatchBorder, swatchSize, swatchSize );
x -= rowHeight;
}
dc.translate( 0, height+rowHeight );
}
}
}
function SelectCategory( i )
{
categoryCur = categories[i];
var catButton = document.getElementById('idCat' + i);
if( catButton )
catButton.checked = true;
RefreshResultsTable();
if( animationObj != null )
animationObj.Refresh();
RefreshRaceChart();
SituationRefresh();
if( lapChartObj )
lapChartObj.draw();
}
function setCategory( catName )
{
var catNameDecode = decode_utf8( decodeURIComponent(catName) );
for( var i = 0; i < categories.length; ++i ) {
if( catName == categories[i] || catNameDecode == categories[i] ) {
SelectCategory( i );
return;
}
}
SelectCategory( 0 );
}
function StartAnimateRealtime()
{
_initAnimation();
speedup = 1.0;
tMax = 999999;
setTimeout( NextFrame, 1000.0/framesPerSecond );
}
function StopAnimate() {
t = tMax;
}
function SuspendAnimate() {
suspendAnimation = true;
}
function IsAnimating() {
return !suspendAnimation && t < tMax;
}
function SetTime( aT ) {
t = aT;
if( animationObj != null )
animationObj.Refresh();
}
function SetSpeed( i )
{
animationSeconds = 90;
var factor = 0.65;
for( ; i < 0; ++i )
animationSeconds /= factor;
for( ; i > 0; --i )
animationSeconds *= factor;
Animate( animationSeconds, tMax, t );
}
function SetNumsToWatch()
{
var numsToWatchText = document.getElementById('idNumsToWatch');
var numStr = numsToWatchText.value;
numStr = numStr.replace( / /g, ',' );
numStr = numStr.replace( /[^\d,]/g, '' );
numStr = numStr.replace( /,+/g, ',' );
numsToWatchText.value = numStr;
var nums = numStr.split(',');
numsToWatch = {};
for( var i = 0; i < nums.length; ++i )
{
var num = parseInt( nums[i], 10 );
if( !isNaN(num) )
numsToWatch[num] = num;
}
if( animationObj != null )
animationObj.Refresh();
RefreshResultsTable();
RefreshRaceChart();
SetSituationTime();
}
function ToggleNumberHighlight( num )
{
var numsToWatchText = document.getElementById('idNumsToWatch');
if( numsToWatch[num] == num )
{
var s = [];
for( var n in numsToWatch )
{
if( n != num )
s.push( n + '' );
}
numsToWatchText.value = s.join( ', ' );
}
else
numsToWatchText.value += (numsToWatchText.value ? ', ' : '') + num;
SetNumsToWatch();
}
function getStartTime()
{
if( !data )
return 0.001;
var t = 9999999;
for( var num in data )
{
if( categoryCur == 'All' || data[num]['raceCat'] == categoryCur )
if( data[num]['raceTimes'][0] < t )
{
t = data[num]['raceTimes'][0];
}
}
t += 0.001;
return t;
}
function Rewind()
{
if( raceIsRunning )
return;
t = getStartTime();
if( animationObj != null )
animationObj.Refresh();
document.getElementById('idPlayStop').innerHTML = _('Play');
Animate( animationSeconds, tMax, t );
suspendAnimation = true;
}
function PlayStop()
{
if( raceIsRunning )
return;
if( IsAnimating() )
{
SuspendAnimate();
document.getElementById('idPlayStop').innerHTML = _('Play');
}
else
{
Animate( animationSeconds, tMax, t );
document.getElementById('idPlayStop').innerHTML = _('Stop');
}
}
function rnd_normal()
{ return (Math.random()*2-1)+(Math.random()*2-1)+(Math.random()*2-1); }
function normal_variate( mean, stdev )
{ return rnd_normal()*stdev + mean; }
function rand_int( iMax )
{ if( iMax == null ) iMax = 100000000; return ~~(Math.random() * iMax); }
function rand_str()
{
var iMax = rand_int(7) + 1;
var s = '';
for( var i = 0; i < iMax; ++i )
s += rand_int( 10 );
return s
}
function GenerateRandomData()
{
var cats = ['Test Data Junior', 'Test Data Senior', 'Test Data Women'];
infoFields = ['LastName', 'FirstName', 'Name', 'Team', 'Category','License', ];
data = {};
for( var num = 100; num < 150; ++num )
{
var iCat = num % cats.length;
var cat = cats[iCat];
var mean = normal_variate(6.0,0.3);
var raceTimes = [60 * iCat];
for( var lap = 0; lap < 20; ++lap )
raceTimes.push( raceTimes.back() + normal_variate(mean, mean/20)*60.0 );
data[num] = { 'raceTimes': raceTimes, 'lastTime': raceTimes.back(), 'raceCat' : cat, 'status' : 'Finisher' };
data[num]['License']	= rand_str() + '';
data[num]['LastName']	= ["SAMPLE", "EXAMPLE", "DEMONSTRATION"][rand_int(3)];
data[num]['FirstName']	= ["John", "Peter", "Adam", "Kirk", "Vlad"][rand_int(5)];
data[num]['Team']		= ["Red", "Green", "Black"][rand_int(3)];
data[num]['flr'] = 1.0;
}
return data;
}
function getUrlParam( param, url )
{
param = param.replace(/([\[\](){}*?+^$.\\|])/g, "\\$1");
var regex = new RegExp("[?&]" + param + "=([^&#]*)");
url = url || decodeURIComponent(window.location.href);
var match = regex.exec(url);
return match ? match[1] : "";
}
function SetLapDataOption( opt )
{
lapDataOption = opt;
RefreshResultsTable();
}
function SetShowLaps()
{
var showLaps = document.getElementById('idShowLaps');
showLapsFrequency = parseInt( showLaps.options[showLaps.selectedIndex].value, 10 );
RefreshResultsTable();
}
function FormatDistance( distance, inUnit, showUnits )
{
if( (inUnit ? inUnit : 'km') != displayUnits )
distance *= (displayUnits == 'km' ? 1.609344 : 0.621371192237334);
var s = distance.toFixed(2);
if( showUnits )
s += ' ' + _(displayUnits);
return s;
}
function FormatSpeed( speed, inUnit, showUnits )
{
if( inUnit.substring(0,1) != displayUnits.substring(0,1) )
speed *= (displayUnits == 'km' ? 1.609344 : 0.621371192237334);
var s = speed.toFixed(2);
if( showUnits )
s += ' ' + (displayUnits == 'km' ? 'km/h' : 'mph');
return s;
}
function FormatDistanceGap( distance, inUnit )
{
if( inUnit != displayUnits )
distance *= (displayUnits == 'km' ? 1.609344 : 0.621371192237334);
var v = '';
if( displayUnits == 'km' )
{
if( Math.abs(distance) > 1.0 )
v = distance.toFixed(2) + ' km';
else
v = (distance*1000).toFixed(2) + ' m';
}
else
{
if( Math.abs(distance) > 0.25 )
v = distance.toFixed(2) + ' ' + _('miles');
else if( Math.abs(distance) > 0.1 )
v = (distance * 1760).toFixed(1) + ' yds';
else
{
if( Math.abs(distance * 5280) < 3 )
v = (distance * 5280 * 12).toFixed(0) + ' in';
else
v = (distance * 5280).toFixed(1) + ' ft';
}
}
return v;
}
function SetDisplayUnits()
{
var select = document.getElementById('idDisplayUnits');
displayUnits = select.options[select.selectedIndex].value;
RefreshResultsTable();
SetTotalElevationGain();
animationObj.widthLast = -1;
}
function LoopContinuously()
{
loopContinuously ^= true;
}
function AdjustSize( increase )
{
if( !canvas )
return;
if( increase )
{
if( canvas.width < 4096 )
{
canvas.width *= 1.2;
canvas.height *= 1.2;
}
}
else
{
if( canvas.width > 100 )
{
canvas.width /= 1.2;
canvas.height /= 1.2;
}
}
if( animationObj != null )
animationObj.Refresh();
}
function AdjustFont( increase )
{
if( !canvas || !animationObj )
return;
if( increase )
fontMult *= (fontMult < 3.0 ? 1.2 : 1.0);
else
fontMult /= (fontMult > 0.2 ? 1.2 : 1.0);
animationObj.Refresh();
}
function SetShowTrack()
{
var select = document.getElementById('idShowTrack');
var track = select.options[select.selectedIndex].value;
if( track == 'gpx' && gpsPoints )
{
animationObj = new GeoAnimation();
animationObj.geoTrack.setData( gpsPoints );
animationObj.altigraph.setData( gpsAltigraph );
}
else
animationObj = new TrackAnimation();
animationObj.Refresh();
}
function ToggleTimeDecimals()
{
var cb = document.getElementById('idShowTimeDecimals');
showTimeDecimals = cb.checked;
RefreshResultsTable();
}
var replaceHtmlEntites = (function() {
var translate_re = /&(nbsp|amp|quot|lt|gt);/g;
var translate = {
"nbsp": " ", 
"amp" : "and", 
"quot": "\"",
"lt"  : "<", 
"gt"  : ">"
};
return function( s ) {
return ( s.replace(translate_re, function(match, entity) { 
return translate[entity]; 
}) );
}
})();
function SetTotalElevationGain() {
//
//	if( gpsTotalElevationGain )
//	{
//		var units = (displayUnits == 'km' ? 'm' : ' ft');
//		var totalElevationGain = (displayUnits == 'km' ? 1.0 : 3.28084) * gpsTotalElevationGain;
//		document.getElementById('idTotalElevationGain').innerHTML = '<' + 'br/>' + totalElevationGain.toFixed(0) + units + ' Total Elevation Gain per Lap';
//	}
//	else
//		document.getElementById('idTotalElevationGain').innerHTML = '';
//
}
function setLanguage( langCode ) {
var langs = translations['languageCode'];
for( var i = 0; i < langs.length; ++i ) {
if( langs[i] == langCode ) {
langCur = i;
break;
}
}
if( langCur == null ) {
var browser_languages = navigator.languages ? navigator.languages : [(navigator.language || navigator.userLanguage || 'en')];
for( var b = 0; b < browser_languages.length && langCur == null; ++b ) {
var base_lang = browser_languages[b].split('-')[0];
for( var i = 0; i < langs.length; ++i ) {
if( base_lang == langs[i] ) {
langCur = i;
break;
}
}
}
}
if( langCur == null )
langCur = 0;
var textAttr = {
'#text':	'nodeValue',
'OPTION':	'text'
};
var elements = document.getElementsByTagName('*');
for( var i = 0; i < elements.length; ++i )
{
e = elements[i];
trTag = e.getAttribute('data-tr');
if( trTag )
{
var tAttr = textAttr[e.nodeName];
if( !tAttr )
tAttr = 'innerHTML';
//alert( 'e.nodeName=' + e.nodeName + ' trTag="' + trTag + '" _(trTag)="' + _(trTag) + '" tAttr=' + tAttr + ' e.id=' + e.id );
e[tAttr] = _(trTag);
}
}
RefreshResultsTable();
SetTotalElevationGain();
SituationRefresh();
}
function getLanguageCode() {
return translations['languageCode'][langCur];
}
function initLanguages() {
var languages = translations['language'];
var languageCodes = translations['languageCode'];
langCur = (langCur || 0);
var iLang = [langCur];
for( var i = 0; i < languages.length; ++i )
if( i != langCur )
iLang.push( i );
var languageHTML = '<div id="buttongroup">';
for( var j = 0; j < languages.length; ++j )
{
var i = iLang[j];
languageHTML +=
'<label class="green">' +
'<input ' +
'type="radio" ' +
'name="languageSelect" ' +
'id="idLanguage' + i + '" ' +
'onClick="setLanguage(\''+languageCodes[i]+'\');" ' +
(i == langCur ? 'checked="true"': '') +
'/>' +
'<span>' + languages[i] + '</span>' +
'</input>' +
'</label>';
}
languageHTML += '</div><hr/>';
document.getElementById('idLanguages').innerHTML = languageHTML;
}
function SetSituationZoom( rbutton ) {
situationObj.zoom = parseFloat(rbutton.value);
SituationRefresh();
}
var situationTimer = null;
function SetSituationTime( value ) {
if( situationObj == null )
return;
if( value == undefined )
value = 10000;
value = parseInt( value );
if( situationTimer != null ) {
clearTimeout( situationTimer );
situationTimer = null;
}
var tMax;
if( raceIsRunning ) {
var tServer = (new Date(timestamp[0])).getTime() / 1000.0;
var tBrowser = (new Date().getTime()) / 1000.0;
while( tBrowser - tServer < 0 )
tBrowser += 60*60;
tMax = timestamp[1] + (tBrowser - tServer);
}
else
tMax = GetRaceTMax();
var tRace = tMax * (value / 10000.0);
var gs = GetSituationGaps( tRace );
situationObj.SetData( gs.gaps, gs.tAfterLeader, gs.title, gs.tCur );
if( value == 10000 && raceIsRunning )
situationTimer = setTimeout( SetSituationTime, 1001 - (new Date()).getTime() % 1000 );
}
function SituationRefresh() {
var timeRange = document.getElementById('idTimeRange');
SetSituationTime( timeRange.value );
}
function SetArrivalMode() {
arrivalMode = document.getElementById('idArrivalMode').checked;
RefreshResultsTable();
}
function SetMapMode() {
mapMode = document.getElementById('idMapMode').checked;
document.getElementById('idResultsDiv').className = (mapMode ? 'hidden' : '');
}
function SelectCategoryNonAll() {
if( categories.length <= 1 || (categoryCur && categoryCur != 'All') )
return;
var i;
for( i = 0; i < categories.length; ++i ) {
if( categoryCur == categories[i] )
break;
}
for( ;; ) {
if( ++i >= categories.length )
i = 0;
if( categories[i] != 'All' )
break;
}
SelectCategory( i );
}
function GetNextValidCategory() {
if( categories.length <= 1 )
return null;
var i;
for( i = 0; i < categories.length; ++i ) {
if( categoryCur == categories[i] )
break;
}
for( ;; ) {
if( ++i >= categories.length )
i = 0;
if( categories[i] != 'All' )
break;
}
return i;
}
var cycleCount = 0;
var cycleTimer = null;
function SetNextCategory() {
var i = GetNextValidCategory();
if( i == null )
return;
SelectCategory( i );
if( ++cycleCount % 12 == 0 )	
doReload();
}
function SetShowCategorySummary() {
showCategorySummary = document.getElementById('idShowCategorySummary').checked;
RefreshResultsTable();
}
function SetCycleCategoriesMode() {
cycleCategoriesMode = document.getElementById('idCycleCategoriesMode').checked;
clearInterval( cycleTimer );
if( cycleCategoriesMode )
cycleTimer = setInterval( SetNextCategory, 1000*15 );
}
function OpenGetDirections()
{
var url = 'http://maps.google.com?daddr=' + courseCoordinates[1].toFixed(4) + ' ' + courseCoordinates[0].toFixed(4) + ' (' + raceName + ')';
window.open( url, null, null, true );
}
function createXMLHttpRequest() {
try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}
try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}
try { return new XMLHttpRequest(); } catch(e) {}
return null;
}
function TryAgain( error, responseText ) {
console.log( 'RefreshPayload: failure: "' + error + '".  Trying again in a few seconds...' );
if( responseText ) {
console.log( 'responseText:' );
console.log( responseText.slice(0, 256) + '...' );
}
else
console.log( 'No responseText.' );
setTimeout( RefreshPayload, Math.round(5000 + Math.random() * 3000) );
return true;
}
function eqTimestamp( ts1, ts2 ) {
return	( (ts1 && ts1.length > 0 ? ts1[0] : '') == (ts2 && ts2.length > 0 ? ts2[0] : '') ) &&
( (ts1 && ts1.length > 1 ? ts1[1] : -1) == (ts2 && ts2.length > 1 ? ts2[1] : -1) );
}
function RefreshPayload() {
var xhr = createXMLHttpRequest();
if( !xhr || window.location.href.substring(0,5) == 'file:')
return doReload(true);
var requestTimer = setTimeout( function() { xhr.abort(); }, 10*1000 );
xhr.onreadystatechange = function() {
if( xhr.readyState != 4 )
return;
clearTimeout( requestTimer )
if( xhr.status != 200 )
return TryAgain();
console.log( 'RefreshPayload: processing...' );
var startSearch = /\/\* !!! payload begin !!! \*\/[^{]+\{/g;
var result = startSearch.exec( xhr.responseText );
if( result == null ) return TryAgain( 'missing payload start', xhr.responseText );
var pStart = startSearch.lastIndex - 1;
var endSearch = /\}\s*;\s*\/\* !!! payload end !!! \*\//g;
var result = endSearch.exec( xhr.responseText );
if( result == null ) return TryAgain( 'missing payload end', xhr.responseText );
var pEnd = result.index + 1;
var payloadJSON = xhr.responseText.substring(pStart, pEnd)
var payload = null;
try {
payload = JSON.parse(payloadJSON);
}
catch( e ) {
console.log( 'RefreshPayload: parse payload error: ' + e.message );
payload = null;
}
payloadJSON = null;
if( payload ) {
reloadTriggered = false;
if( eqTimestamp(timestamp, payload.timestamp) ) {
console.log( 'RefreshPayload: success: no change.' );
return;
}
raceWasRunning = raceIsRunning;
for( v in payload ) window[v] = payload[v]; payload = null;
SetData( data, undefined );
SetRaceTime();
setLanguage( translations['languageCode'][langCur] );
setCategory( categoryCur );
RefreshResultsTable();
RefreshRaceChart();
SituationRefresh();
if( !raceIsRunning && raceWasRunning )
Animate( animationSeconds, undefined, getStartTime() );
console.log( 'RefreshPayload: success: new timestamp.' );
}
else
return TryAgain( 'payload extract fails', xhr.responseText );
}
xhr.open('GET', window.location.href);
xhr.send();
}
var finishUpdateTimer = null;
var queryPayloadTimer = null;
function QueryPayloadLoop() {
if( lastRaceTime == 0 ) {
console.log( 'QueryPayloadLoop:' );
RefreshPayload();
queryPayloadTimer = setTimeout( QueryPayload, (3 + Math.random()) * 60 * 1000 );
}
}
function SetRaceTime() {
var s = (organizer ? organizer : '');
if( finishUpdateTimer ) {
clearTimeout( finishUpdateTimer );
finishUpdateTimer = null;
}
if( queryPayloadTimer ) {
clearTimeout( queryPayloadTimer );
queryPayloadTimer = null;
}
if( timestamp )
{
var tServer = (new Date(timestamp[0]).getTime()) / 1000.0;
var tBrowser = (new Date().getTime()) / 1000.0;
while( tBrowser - tServer < 0 )
tBrowser += 60*60;
var tRace = timestamp[1] + (tBrowser - tServer);
if( tRace > 25*60*60 )
raceIsRunning = false;		
if( raceIsRunning )
{
t = tRace;
document.getElementById('idAnimateControls').className = 'hidden';
s += ' (race in progress, last updated ' + timestamp[0] + ')';
speedup = 1.0;
if( !isTimeTrial ) {
if( lastRaceTime > 0 )
finishUpdateTimer = setTimeout( function() {doReload(true); }, (Math.min(0, lastRaceTime - tRace) + 5*60) * 1000 );
else
queryPayloadTimer = setTimeout( QueryPayloadLoop, (3 + Math.random()) * 60 * 1000 );
}
}
else {
document.getElementById('idAnimateControls').className = '';
s += ' (' + '<span data-tr="created"></span> ' + timestamp[0] + ')';
}
}
document.getElementById('idOrganizer').innerHTML = s;
return s;
}
function displaySelect( select ) {
var k = (select.value.indexOf('kiosk') >= 0);
var a = (select.value.indexOf('arrival') >= 0);
var m = (select.value.indexOf('map') >= 0);
if( k || a || m ) {
var message;
if( k && a )
message = 'Switch to Kiosk Arrival Mode?';
else if( k && m )
message = 'Switch to Kiosk Map Mode?';
else
message = 'Switch to Kiosk Mode?';
if( !window.confirm(message) ) {
kioskMode = false;
arrivalMode = false;
mapMode = false;
select.selectedIndex = 0;
return;
}
}
kioskMode = k;
arrivalMode = a;
mapMode = m;
doReload( true );
}
function onLoad()
{
if( payload ) { for( v in payload ) window[v] = payload[v]; payload = null; }
resultsDiv = document.getElementById('idResultsDiv');
showLaps = document.getElementById('idShowLaps');
if( data == null )
{
GenerateRandomData();
if( !gpsPoints )
gpsPoints = gpsPointsTest;
}
else
gpsPointsTest = null;
if( showCourseAnimation ) {
if( gpsPoints )
{
animationObj = new GeoAnimation();
animationObj.geoTrack.setData( gpsPoints );
animationObj.altigraph.setData( gpsAltigraph );
}
else
{
animationObj = new TrackAnimation();
document.getElementById('idShowTrack').className = 'hidden';
}
}
else {
document.getElementById('idTrackDiv').className = 'hidden';
}
if( hideDetails )
document.getElementById('idShowDetailsOption').className = 'hidden';
if( !rfid )
document.getElementById('idRFID').className = 'hidden';
else
document.getElementById('idRFID').innerHTML = '<span data-tr="Chip Timing"></span>.';
if( !raceNotes )
document.getElementById('idRaceNotes').className = 'hidden';
else
document.getElementById('idRaceNotes').innerHTML = raceNotes.replace(/{-{/g, '<').replace(/}-}/g, '>');
if( !courseCoordinates ) {
document.getElementById('idCourseViewer').className = 'hidden';
document.getElementById('idGetDirections').className = 'hidden';
}
if( !travelMap )
document.getElementById('idTravelMap').className = 'hidden';
canvasSupported = isCanvasSupported();
if( canvasSupported && !winAndOut )
{
var raceChartCanvas = document.getElementById('idRaceChart');
raceChartCanvas.addEventListener('click', function(event) { RaceChartProcessClick(event); }, false);
raceChartCanvas.addEventListener('mousemove', function(event) { RaceChartProcessMouse(event); }, false);
raceChartCanvas.addEventListener('mouseout', function(event) {
if( hoverTimer != null )
clearTimeout( hoverTimer );
hoverTimer = null;
RefreshRaceChart();
},
false
);
if( !isTimeTrial ) {
var situationCanvas = document.getElementById('idSituation');
var timeRange = document.getElementById( 'idTimeRange' );
var situationDetail = document.getElementById( 'idSituationDetailDiv' );
situationObj = new Situation( situationCanvas, timeRange, situationDetail );
situationCanvas.addEventListener('click', function(event) { situationObj.processClick(event); }, false);
}
else
document.getElementById('idSituationDiv').className = 'hidden';
if( !showCourseAnimation || (isTimeTrial && raceIsRunning) )
document.getElementById('idTrackDiv').className = 'hidden';
else
canvas = document.getElementById('idTrack');
var lapChartCanvas = document.getElementById('idLapChart');
lapChartObj = new LapChart();
lapChartObj.init( lapChartCanvas );
}
else
{
document.getElementById('idTrackDiv').className = 'hidden';
document.getElementById('idRaceChartDiv').className = 'hidden';
document.getElementById('idSituationDiv').className = 'hidden';
document.getElementById('idLapChartDiv').className = 'hidden';
}
document.getElementById('idRaceName').innerHTML = document.getElementById('idTitle').innerHTML;
if( email ) {
document.getElementById('idEmail').href =
'mailto:' + email +
'?subject=' + replaceHtmlEntites(document.getElementById('idTitle').innerHTML);
}
SetRaceTime();
if( HasDisplayUnit(data) )
{
displayUnits = GetDistanceUnit( data );
document.getElementById('idDisplayUnits').selectedIndex = (displayUnits == 'km' ? 0 : 1);
}
else
document.getElementById('idShowUnits').style.display = 'none';
SetData( data, undefined );
showCategorySummary = (getUrlParam('showCategorySummary', undefined) == 't');
if( showCategorySummary )
document.getElementById('idShowCategorySummary').checked = true;
arrivalMode = (getUrlParam('arrivalMode', undefined) == 't');
if( arrivalMode )
document.getElementById('idArrivalMode').checked = true;
mapMode = (getUrlParam('mapMode', undefined) == 't');
if( mapMode )
document.getElementById('idMapMode').checked = true;
cycleCategoriesMode = (getUrlParam( 'cycleCategoriesMode', undefined ) == 't');
if( cycleCategoriesMode ) {
document.getElementById('idCycleCategoriesMode').checked = true;
SetCycleCategoriesMode();
}
kioskMode = (getUrlParam('kioskMode', undefined) == 't');
if( kioskMode ) {
document.getElementById('idRaceChartDiv').classList.add('hidden');
document.getElementById('idSituationDiv').classList.add('hidden');
document.getElementById('idLapChartDiv').classList.add('hidden');
document.getElementById('idPageHeader').classList.add('hidden');
document.getElementById('idResultOptions').classList.add('hidden');
if( mapMode ) {
document.getElementById('idResultsDiv').classList.add('hidden');
document.getElementById('idMapMode').checked = true;
}
else {
document.getElementById('idTrackDiv').classList.add('hidden');
}
document.getElementById('idCycleCategoriesMode').checked = cycleCategoriesMode = true;
document.getElementById('idShowCategorySummary').checked = showCategorySummary = true;
SetShowCategorySummary();
SetArrivalMode();
SetCycleCategoriesMode();		
}
var numbers = getUrlParam( 'highlight', undefined );
if( numbers != '' )
numsToWatchStr = numbers;
if( numsToWatchStr )
{
var numsToWatch = document.getElementById('idNumsToWatch');
numsToWatch.value = numbers;
SetNumsToWatch();
}
setCategory( getUrlParam('raceCat', undefined) );
setLanguage( getUrlParam('lang', undefined) );
initLanguages();
RefreshResultsTable();
RefreshRaceChart();
SetSituationTime();
Animate( animationSeconds, undefined, raceIsRunning ? t : getStartTime() );
document.getElementById('idPlayStop').innerHTML = _('Stop');
if( raceIsRunning )
setTimeout( RefreshPayload, 5*60*1000+10 );
document.getElementById('idDisplaySelect').selectedIndex = (kioskMode && arrivalMode ? 2 : kioskMode ? 1 : 0);
ResetWebSocket();
}
</script>
</head>
<body onload="onLoad()">
<div id="idPageHeader">
<p>
<table style="border-spacing: 8px;"><tr>
<td style="vertical-align: top;"><img alt="CrossMgr Logo" onclick="doReload();" style="cursor:pointer" id="idImgHeader" src="data:image/png;base64,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"/></td>
<td style="vertical-align: top;"><span id="idRaceName" onclick="doReload();" style="cursor:pointer">Cyclo-Cross Race Results</span><br/><span data-tr="by"></span> <span id="idOrganizer">CrossMgr</span>
&nbsp;&nbsp;&nbsp;&nbsp;
<span class="noprint">
<a id="idEmail" href="mailto:helpful.organizer@great_race_organization.com?subject=CrossMgr+Results+Output"><span data-tr="Email Comments/Suggestions"></span></a>.
<br/>
<span data-tr="Powered by"></span> <a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a>.
<span id="idRFID"></span>&nbsp;&nbsp;&nbsp;
<br/>
<button id="idGetDirections" onclick="OpenGetDirections()" data-tr="Get Directions"></button>&nbsp;&nbsp;
<button id="idCourseViewer" onclick="OpenCourseViewerWindow()" data-tr="Course Map"></button>&nbsp;&nbsp;
<button id="idTravelMap" onclick="OpenTravelMapWindow()" data-tr="Participant Map"></button>&nbsp;&nbsp;
<button onclick="doReload()" data-tr="Refresh"></button>&nbsp;&nbsp;&nbsp;
<select id="idDisplaySelect" onchange="displaySelect(this);">
<option value="normal" data-tr="Results">Results</option>
<option value="kiosk" data-tr="Kiosk">Kiosk</option>
<option value="kiosk-arrival" data-tr="Kiosk A">Kiosk A</option>
<option value="kiosk-map" data-tr="Kiosk Map">Kiosk Map</option>
</select>
<br/>
<input id="idCycleCategoriesMode" type="checkbox" class="hidden" onclick="SetCycleCategoriesMode()">
<label for="idCycleCategoriesMode" data-tr="CycleCategories" class="hidden"></label>&nbsp;&nbsp;
<input id="idShowCategorySummary" type="checkbox" class="hidden" onclick="SetShowCategorySummary()">
<label for="idShowCategorySummary" data-tr="ShowCategorySummary" class="hidden"></label>&nbsp;&nbsp;
<input id="idArrivalMode" type="checkbox" class="hidden" onclick="SetArrivalMode()">
<label for="idArrivalMode" id="idArrivalModeLabel" data-tr="ByFinishers" class="hidden"></label>
<input id="idMapMode" type="checkbox" class="hidden" onclick="SetMapMode()">
<label for="idMapMode" id="idMapModeLabel" data-tr="Map Only" class="hidden"></label>
</span>
</tr></table><span id="idReloadStatus"></span><span id="idRaceNotes"></span>
<p></p>
<div class="noprint" id="idLanguages"></div>
<p></p>
<div class="noprint" id="idCategories"></div>
<p></p>
</div> <!-- idPageHeader -->
<div id="idTrackDiv">
<canvas id="idTrack" width="600" height="300" class="noprint">
<a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a> Race Results requires support the HTML5 Canvas.<br/>
Please upgrade to a more recent browser version.<br/>
For Internet Explorer (IE), you need version 9.0 or higher.<br/><br/>
Current versions of Chrome, FireFox and Opera work fine.
</canvas>
<p class="noprint">
<span id="idAnimateControls">
<button id="idRewind" onClick="Rewind()"><span data-tr="Rewind"></span></button>
<button id="idPlayStop" onClick="PlayStop()"><span data-tr="Play"></span></button>
<input type="checkbox" id="idLoop" onClick="LoopContinuously()" checked>
<label for="idLoop" data-tr="Loop Continuously"></label>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<label for=playbackSpeed data-tr="Playback Speed">: </label>
<input type="range" id="playbackSpeed" min="-9" value="0" max="3" step="1" oninput="SetSpeed(this.value)" onchange="SetSpeed(this.value)">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span data-tr="Size"></span>:
<button id="idIncreaseSize" onClick="AdjustSize(true)">+</button>
<button id="idDecreaseSize" onClick="AdjustSize(false)">-</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span data-tr="Text"></span>:
<button id="idIncreaseFont" onClick="AdjustFont(true)">+</button>
<button id="idDecreaseFont" onClick="AdjustFont(false)">-</button>
</span>
</p>
<p class="noprint">
<span data-tr="Highlight Numbers"></span>:
<input type="text" id="idNumsToWatch" value="" onChange="SetNumsToWatch()">
<button><span data-tr="Apply"></span></button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<select class="noprint" id="idShowTrack" onChange="SetShowTrack()">
<option value="gpx" selected="selected" data-tr="GPX">GPX</option>
<option value="oval" data-tr="Track">Track</option>
</select>
</p>
</div> <!-- idTrackDiv -->
<div id="idResultOptions">
<p>
<span class="noprint" id="idShowUnits">
<span data-tr="Units:"></span>
<select class="noprint" id="idDisplayUnits" onChange="SetDisplayUnits()">
<option value="km" selected="selected">km</option>
<option value="miles" data-tr="miles">miles</option>
</select>
&nbsp;&nbsp;&nbsp;
</span>
<input class="noprint" type="checkbox" id="idShowTimeDecimals" onClick="ToggleTimeDecimals()">
<label for="idShowTimeDecimals" class="noprint" data-tr="Show 100s of Seconds"></label>
&nbsp;&nbsp;&nbsp;
<select class="noprint" id="idShowLaps" onChange="SetShowLaps()">
<option value="0" data-tr="Hide Lap Info">0</option>
<option value="1" selected="selected" data-tr="Show Every Lap">1</option>
<option value="2" data-tr="Show Every 2 Laps">2</option>
<option value="3" data-tr="Show Every 3 Laps">3</option>
<option value="5" data-tr="Show Every 5 Laps">5</option>
<option value="10" data-tr="Show Every 10 Laps">10</option>
<option value="15" data-tr="Show Every 15 Laps">15</option>
<option value="20" data-tr="Show Every 20 Laps">20</option>
<option value="25" data-tr="Show Every 25 Laps">25</option>
<option value="50" data-tr="Show Every 50 Laps">50</option>
<option value="100" data-tr="Show Every 100 Laps">100</option>
</select>
<span id="idTotalElevationGain"> </span>
</p>
<span class="noprint" id="idShowOptions"></span><br/>
</div>
<div id="idResultsDiv"></div>
<div id="idLapChartDiv" class="noprint">
<strong><span id="idLapChartName" data-tr="Race Position"></span></strong><br/>
<canvas id="idLapChart" width="1000" height="800">
<a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a> Requires support for the HTML5 Canvas.<br/>
Please upgrade to a more recent browser version.<br/>
For Internet Explorer (IE), you need version 9.0 or higher.<br/><br/>
Current versions of Chrome, FireFox and Opera work fine.
</canvas>
</div><!-- idLapChartDiv -->
<div id="idRaceChartDiv" class="noprint">
<p>
<strong><span id="idRaceChartName" data-tr="Race Chart"></span></strong>&nbsp;&nbsp;&nbsp;&nbsp;
<span id="idShowStartOffsetOption">
<input type="checkbox" id="idShowStartOffsets" checked onClick="RefreshRaceChart()">
<label for="idShowStartOffsets" data-tr="Show Start Offsets"></label>
</span>
<span id="idShowDetailsOption">
&nbsp;&nbsp;&nbsp;&nbsp;
<input type="checkbox" id="idShowDetails" onClick="RefreshRaceChart()">
<label for="idShowDetails" data-tr="Show Details"></label>
</span>
</p>
<canvas id="idRaceChart" width="1000" height="800">
<a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a> Requires support for the HTML5 Canvas.<br/>
Please upgrade to a more recent browser version.<br/>
For Internet Explorer (IE), you need version 9.0 or higher.<br/><br/>
Current versions of Chrome, FireFox and Opera work fine.
</canvas>
</div> <!-- idRaceChartDiv -->
<div id="idSituationDiv" class="noprint">
<hr>
<p>
<strong><span id="idSituationName" data-tr="Situation"></span></strong>
</p>
<table><tr>
<td style="vertical-align:top; text-align:center;">
<br/><br/><br/><br/>
<span data-tr="Zoom"></span><br/>
+<br/>
<input type="radio" name="zoom" value="5.0" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="4.5" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="4.0" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="3.5" checked onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="3.0" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="2.5" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="2.0" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="1.5" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="1.0" checked onclick="SetSituationZoom(this)"><br/>
-<br/>
</td>
<td style="vertical-align: top;">
<span data-tr="TimeSlider"></span>&nbsp;&nbsp;&nbsp;<input id="idTimeRange" type="range" min="0" max="10000" value="10000" style="width:670px;" oninput="SetSituationTime(this.value)" onchange="SetSituationTime(this.value)"><br/>
<canvas id="idSituation" width="800" height="600">
<a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a> Requires support for the HTML5 Canvas.<br/>
Please upgrade to a more recent browser version.<br/>
For Internet Explorer (IE), you need version 9.0 or higher.<br/><br/>
Current versions of Chrome, FireFox and Opera work fine.
</canvas>
</td>
<td style="vertical-align: top;">
<div id="idSituationDetailDiv"></div>
</td>
</tr></table>
</div> <!-- idSituationDiv -->
</body>
</html>
